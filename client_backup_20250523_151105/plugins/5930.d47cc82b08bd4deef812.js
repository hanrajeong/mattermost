"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[5930],{58628:(e,t,n)=>{n.d(t,{Ht:()=>d,uN:()=>c,Fu:()=>u,ng:()=>h,_M:()=>m}),n(43813);var a=n(23877),s=n(40693),r=n(92159),i=n(1418),o=n(87988),l=n(21413);function c(e,t){return(n,i)=>{const o=i(),c=(0,l.K7)(o);return n(function(e,t,n){return async(i,o)=>{const l=o(),c=(0,r.K)(l,e,t);try{await s.mT.deleteChannelBookmark(e,t,n),i({type:a.Fi.BOOKMARK_DELETED,data:c})}catch(e){return{data:!1,error:e}}return{data:!0}}}(e,t,c))}}function d(e,t){return(n,r)=>{const i=r(),o=(0,l.K7)(i);return n(function(e,t,n){return async r=>{try{const i=await s.mT.createChannelBookmark(e,t,n);r({type:a.Fi.RECEIVED_BOOKMARK,data:i})}catch(e){return{data:!1,error:e}}return{data:!0}}}(e,t,o))}}function u(e,t,n){return async(r,i)=>{const o=i(),c=(0,l.K7)(o);return r(function(e,t,n,r){return async i=>{try{const{updated:o,deleted:l}=await s.mT.updateChannelBookmark(e,t,n,r);o&&i({type:a.Fi.RECEIVED_BOOKMARK,data:o}),l&&i({type:a.Fi.BOOKMARK_DELETED,data:l})}catch(e){return{data:!1,error:e}}return{data:!0}}}(e,t,n,c))}}function m(e,t,n){return(r,i)=>{const o=i(),c=(0,l.K7)(o);return r(function(e,t,n,r){return async i=>{try{const o=await s.mT.updateChannelBookmarkSortOrder(e,t,n,r);i({type:a.Fi.RECEIVED_BOOKMARKS,data:{channelId:e,bookmarks:o}})}catch(e){return{data:!1,error:e}}return{data:!0}}}(e,t,n,c))}}function h(e){return function(e){return async(t,n)=>{let r;try{r=await s.mT.getChannelBookmarks(e),t({type:a.Fi.RECEIVED_BOOKMARKS,data:{channelId:e,bookmarks:r}})}catch(e){return(0,o.UP)(e,t,n),t((0,i.vV)(e)),{error:e}}return{data:r}}}(e)}},52073:(e,t,n)=>{n.d(t,{Go:()=>v,Jb:()=>m,Lt:()=>g,U5:()=>h,lE:()=>b,nh:()=>f,wf:()=>E,zZ:()=>p,zk:()=>u}),n(43813),n(74883);var a=n(4629),s=n(40057),r=n(8907),i=n(57676),o=n(65952),l=n(24380),c=n(9916),d=n(78451);function u(e){return{type:d.Q3.SET_UNREAD_FILTER_ENABLED,enabled:e}}function m(e){return{type:d.Q3.SIDEBAR_DRAGGING_SET_STATE,data:e}}function h(){return{type:d.Q3.SIDEBAR_DRAGGING_STOP}}function p(e,t,n){return async(s,r)=>{if(n){const e=r().views.channelSidebar.multiSelectedChannelIds;n.forEach((t=>{e.indexOf(t)>=0&&s(E(t))}))}const i=await s((0,a.zZ)(e,t,n));return s({type:d.Q3.ADD_NEW_CATEGORY_ID,data:i.data.id})}}function g(e,t){return f(e,0,t,!1)}function f(e,t,n){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(d,u)=>{const m=u(),h=m.views.channelSidebar.multiSelectedChannelIds;let p=[];if(h.length&&-1!==h.indexOf(n)){const t=(0,c.WJ)(m),a=(0,c.sC)(m);let i=[n];const o=t.find((t=>t.id===e));i=h.filter((e=>{const t=a.find((t=>e===t.id)),n=(null==t?void 0:t.type)===s.Bz.DM_CHANNEL||(null==t?void 0:t.type)===s.Bz.GM_CHANNEL;return(null==o?void 0:o.type)===r.e.CUSTOM||(null==o?void 0:o.type)===r.e.FAVORITES||n&&(null==o?void 0:o.type)===r.e.DIRECT_MESSAGES||!n&&(null==o?void 0:o.type)!==r.e.DIRECT_MESSAGES}));const l=a.map((e=>e.id));i.sort(((e,t)=>l.indexOf(e)-l.indexOf(t))),i.forEach((e=>d(E(e)))),p=i}else p=[n];const g=function(e,t,n,a,s){if(0===a)return 0;const r=(0,i.p7)(e,t),o=(0,i.n7)()(e,r),c=o.filter(((e,t)=>e!==s&&-1!==n.indexOf(e)&&t<=a)),d=a-c.length;if(r.channel_ids.length===o.length)return d;const u=(0,l.q3)(o,n,d),m=u[u.indexOf(n[0])-1];let h=r.channel_ids.indexOf(m)+1;const p=r.channel_ids.indexOf(n[0]);return-1!==p&&p<h&&(h-=1),Math.max(h-c.length,0)}(m,e,p,t,n);return d((0,a.jN)(e,p,g,o))}}function b(){return(e,t)=>0===t().views.channelSidebar.multiSelectedChannelIds.length?{data:!1}:(e({type:d.Q3.MULTISELECT_CHANNEL_CLEAR}),{data:!0})}function E(e){return(t,n)=>{const a=n();if(!a.views.channelSidebar.multiSelectedChannelIds.length){const e=(0,o.eH)(a);t({type:d.Q3.MULTISELECT_CHANNEL,data:e})}return t({type:d.Q3.MULTISELECT_CHANNEL_ADD,data:e})}}function v(e){return(t,n)=>{const a=n(),s=a.views.channelSidebar.multiSelectedChannelIds;let r=a.views.channelSidebar.lastSelectedChannel;if(!s.length){const e=(0,o.eH)(a);t({type:d.Q3.MULTISELECT_CHANNEL,data:e}),r=e}const i=(0,c.qY)(a).map((e=>e.id)),l=i.indexOf(e),u=i.indexOf(r);if(l===u)return{data:!1};const m=Math.min(u,l),h=Math.max(u,l),p=i.slice(m,h+1);return t({type:d.Q3.MULTISELECT_CHANNEL_TO,data:p})}}},52052:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ee});var a=n(23453),s=n(5908),r=n(30413),i=n(40057),o=n(8361),l=n(65952),c=n(26614),d=n(14776),u=n(7430),m=n(61185),h=n(79751),p=n(2386),g=n(75270),f=n(77212),b=n(78451),E=n(62688),v=n.n(E),C=(n(3188),n(30973),n(43813),n(10844),n(74883),n(17046),n(54823),n(29012),n(4290),n(71633)),_=n.n(C),y=n(97023),M=n.n(y),T=n(14778),S=n(14696),w=n(16983),I=n(1396),A=n(63234),N=n(26808),R=n(85406),P=n(16230),L=n(36057),O=n(70669),k=n(86255),D=n(59050),x=n(90617),F=n(55476),U=n(78064),B=n(19513),H=n(4715);function q(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class j extends M().PureComponent{static getDerivedStateFromProps(e,t){return{isSearch:e.isSearch,page:e.isSearch&&!t.isSearch?0:t.page}}constructor(e){super(e),q(this,"onKeyDown",(e=>{const t=e.target,n=(0,B.e)(e,b.Ay.KeyCodes.ENTER);n&&(e.shiftKey||e.ctrlKey||e.altKey)||n&&null!=t&&t.classList.contains("more-modal__row")&&t.click()})),q(this,"handleJoin",((e,t)=>{t.stopPropagation(),this.setState({joiningChannel:e.id}),this.props.handleJoin(e,(()=>{this.setState({joiningChannel:""})})),this.isMemberOfChannel(e.id)&&this.props.closeModal(b.IQ.MORE_CHANNELS)})),q(this,"createChannelRow",(e=>{var t;const n="".concat(e.display_name,", ").concat(e.purpose).toLowerCase();let a;a=(0,U.Oj)(e)?M().createElement(R.ArchiveOutlineIcon,{size:18}):(0,P.Zp)(e)?M().createElement(R.LockOutlineIcon,{size:18}):M().createElement(R.GlobeIcon,{size:18});let s=0;null!==(t=this.props.channelsMemberCount)&&void 0!==t&&t[e.id]&&(s=this.props.channelsMemberCount[e.id]);const r=this.isMemberOfChannel(e.id)?M().createElement("div",{id:"membershipIndicatorContainer","aria-label":this.props.intl.formatMessage({id:"more_channels.membership_indicator",defaultMessage:"Membership Indicator: Joined"})},M().createElement(R.CheckIcon,{size:14}),M().createElement(T.FormattedMessage,{id:"more_channels.joined",defaultMessage:"Joined"})):null,i=this.props.intl.formatMessage(V.channelPurpose,{memberCount:s,channelPurpose:e.purpose||""}),o=M().createElement("div",{id:"channelPurposeContainer","aria-label":i},r,r?M().createElement("span",{className:"dot"}):null,M().createElement(R.AccountOutlineIcon,{size:14}),M().createElement("span",{"data-testid":"channelMemberCount-".concat(e.name)},s),e.purpose.length>0?M().createElement("span",{className:"dot"}):null,M().createElement("span",{className:"more-modal__description"},e.purpose)),l=_()("btn btn-sm",{"btn-secondary outlineButton":this.isMemberOfChannel(e.id),"btn-primary primaryButton":!this.isMemberOfChannel(e.id)}),c=M().createElement("button",{id:"joinViewChannelButton",onClick:t=>this.handleJoin(e,t),className:l,disabled:Boolean(this.state.joiningChannel),tabIndex:-1,"aria-label":this.isMemberOfChannel(e.id)?this.props.intl.formatMessage({id:"more_channels.view",defaultMessage:"View"}):this.props.intl.formatMessage({id:"joinChannel.JoinButton",defaultMessage:"Join"})},M().createElement(F.A,{loading:this.state.joiningChannel===e.id,text:V.joiningButton},M().createElement(T.FormattedMessage,{id:this.isMemberOfChannel(e.id)?"more_channels.view":"joinChannel.JoinButton",defaultMessage:this.isMemberOfChannel(e.id)?"View":"Join"}))),d=e.shared?M().createElement(D.A,{className:"shared-channel-icon",withTooltip:!0}):null;return M().createElement("div",{className:"more-modal__row",key:e.id,id:"ChannelRow-".concat(e.name),"data-testid":"ChannelRow-".concat(e.name),"aria-label":n,onClick:t=>this.handleJoin(e,t),tabIndex:0},M().createElement("div",{className:"more-modal__details"},M().createElement("div",{className:"style--none more-modal__name"},a,M().createElement("span",{id:"channelName"},e.display_name),d),o),M().createElement("div",{className:"more-modal__actions"},c,this.state.joiningChannel===e.id&&!this.isMemberOfChannel(e.id)&&M().createElement("span",{className:"sr-only",role:"alert"},M().createElement(T.FormattedMessage,{id:"more_channels.joinedChannel",defaultMessage:"Joined channel {channelName}",values:{channelName:e.display_name}}))))})),q(this,"nextPage",(e=>{var t;e.preventDefault(),this.setState({page:this.state.page+1,nextDisabled:!0}),this.nextTimeoutId=setTimeout((()=>this.setState({nextDisabled:!1})),500),this.props.nextPage(this.state.page+1),null===(t=this.channelListScroll.current)||void 0===t||t.scrollTo({top:0})})),q(this,"previousPage",(e=>{var t;e.preventDefault(),this.setState({page:this.state.page-1}),null===(t=this.channelListScroll.current)||void 0===t||t.scrollTo({top:0})})),q(this,"doSearch",(()=>{this.props.search(this.state.channelSearchValue),""===this.state.channelSearchValue&&this.setState({page:0})})),q(this,"filterChange",(e=>{this.props.changeFilter(e),this.props.filter!==e&&this.setState({page:0})})),q(this,"handleChange",(e=>{null!=e&&e.currentTarget&&this.setState({channelSearchValue:null==e?void 0:e.currentTarget.value},(()=>this.doSearch()))})),q(this,"handleClear",(()=>{this.setState({channelSearchValue:""},(()=>this.doSearch()))})),q(this,"handleChecked",(()=>{this.props.rememberHideJoinedChannelsChecked?this.props.hideJoinedChannelsPreference(!1):this.props.hideJoinedChannelsPreference(!0)})),q(this,"getEmptyStateMessage",(()=>{if(this.state.channelSearchValue.length>0)return M().createElement(T.FormattedMessage,{id:"more_channels.noMore",tagName:"strong",defaultMessage:"No results for {text}",values:{text:this.state.channelSearchValue}});switch(this.props.filter){case J.Archived:return M().createElement(T.FormattedMessage,{id:"more_channels.noArchived",tagName:"strong",defaultMessage:"No archived channels"});case J.Private:return M().createElement(T.FormattedMessage,{id:"more_channels.noPrivate",tagName:"strong",defaultMessage:"No private channels"});case J.Public:return M().createElement(T.FormattedMessage,{id:"more_channels.noPublic",tagName:"strong",defaultMessage:"No public channels"});default:return M().createElement(T.FormattedMessage,{id:"more_channels.noChannels",tagName:"strong",defaultMessage:"No channels"})}})),q(this,"getFilterLabel",(()=>{switch(this.props.filter){case J.Archived:return M().createElement(T.FormattedMessage,{id:"more_channels.show_archived_channels",defaultMessage:"Channel Type: Archived"});case J.Public:return M().createElement(T.FormattedMessage,{id:"more_channels.show_public_channels",defaultMessage:"Channel Type: Public"});case J.Private:return M().createElement(T.FormattedMessage,{id:"more_channels.show_private_channels",defaultMessage:"Channel Type: Private"});default:return M().createElement(T.FormattedMessage,{id:"more_channels.show_all_channels",defaultMessage:"Channel Type: All"})}})),this.nextTimeoutId=0,this.state={joiningChannel:"",page:0,nextDisabled:!1,channelSearchValue:""},this.filter=M().createRef(),this.channelListScroll=M().createRef()}componentDidMount(){!H.Fr()&&this.filter.current&&this.filter.current.focus(),document.addEventListener("keydown",this.onKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown)}isMemberOfChannel(e){return this.props.myChannelMemberships[e]}render(){const e=this.props.channels;let t,n,a;if(this.props.loading&&0===e.length)t=M().createElement(I.A,null);else if(0===e.length)t=M().createElement("div",{className:"no-channel-message","aria-label":this.state.channelSearchValue.length>0?this.props.intl.formatMessage(V.noMore,{text:this.state.channelSearchValue}):this.props.intl.formatMessage({id:"widgets.channels_input.empty",defaultMessage:"No channels found"})},M().createElement(L.A,null),M().createElement("h3",{className:"primary-message"},this.getEmptyStateMessage()),this.props.noResultsText);else{const e=this.state.page*this.props.channelsPerPage,s=e+this.props.channelsPerPage,r=this.props.channels.slice(e,s);t=r.map(this.createChannelRow),r.length>=this.props.channelsPerPage&&s<this.props.channels.length&&(n=M().createElement("button",{className:"btn btn-sm btn-tertiary filter-control filter-control__next",onClick:this.nextPage,disabled:this.state.nextDisabled,"aria-label":this.props.intl.formatMessage({id:"more_channels.next",defaultMessage:"Next"})},M().createElement(T.FormattedMessage,{id:"more_channels.next",defaultMessage:"Next"}))),this.state.page>0&&(a=M().createElement("button",{className:"btn btn-sm btn-tertiary filter-control filter-control__prev",onClick:this.previousPage,"aria-label":this.props.intl.formatMessage({id:"more_channels.prev",defaultMessage:"Previous"})},M().createElement(T.FormattedMessage,{id:"more_channels.prev",defaultMessage:"Previous"})))}const s=M().createElement("div",{className:"filter-row filter-row--full"},M().createElement("span",{id:"searchIcon","aria-hidden":"true"},M().createElement("i",{className:"icon icon-magnify"})),M().createElement(k.A,{id:"searchChannelsTextbox",ref:this.filter,className:"form-control filter-textbox",placeholder:this.props.intl.formatMessage({id:"filtered_channels_list.search",defaultMessage:"Search channels"}),onInput:this.handleChange,clearable:!0,onClear:this.handleClear,value:this.state.channelSearchValue,"aria-label":this.props.intl.formatMessage({id:"filtered_channels_list.search",defaultMessage:"Search Channels"})})),r=M().createElement(R.CheckIcon,{size:18,color:"var(--button-bg)"}),i=[M().createElement(O.q7,{key:"channelsMoreDropdownAll",id:"channelsMoreDropdownAll",onClick:()=>this.filterChange(J.All),leadingElement:M().createElement(R.GlobeCheckedIcon,{size:16}),labels:M().createElement(T.FormattedMessage,{id:"suggestion.all",defaultMessage:"All channel types"}),trailingElements:this.props.filter===J.All?r:null,"aria-label":this.props.intl.formatMessage({id:"suggestion.all",defaultMessage:"All channel types"})}),M().createElement(O.q7,{key:"channelsMoreDropdownPublic",id:"channelsMoreDropdownPublic",onClick:()=>this.filterChange(J.Public),leadingElement:M().createElement(R.GlobeIcon,{size:16}),labels:M().createElement(T.FormattedMessage,{id:"suggestion.public",defaultMessage:"Public channels"}),trailingElements:this.props.filter===J.Public?r:null,"aria-label":this.props.intl.formatMessage({id:"suggestion.public",defaultMessage:"Public channels"})}),M().createElement(O.q7,{key:"channelsMoreDropdownPrivate",id:"channelsMoreDropdownPrivate",onClick:()=>this.filterChange(J.Private),leadingElement:M().createElement(R.LockOutlineIcon,{size:16}),labels:M().createElement(T.FormattedMessage,{id:"suggestion.private",defaultMessage:"Private channels"}),trailingElements:this.props.filter===J.Private?r:null,"aria-label":this.props.intl.formatMessage({id:"suggestion.private",defaultMessage:"Private channels"})})];this.props.canShowArchivedChannels&&i.push(M().createElement(O.wv,{key:"channelsMoreDropdownSeparator"}),M().createElement(O.q7,{key:"channelsMoreDropdownArchived",id:"channelsMoreDropdownArchived",onClick:()=>this.filterChange(J.Archived),leadingElement:M().createElement(R.ArchiveOutlineIcon,{size:16}),labels:M().createElement(T.FormattedMessage,{id:"suggestion.archive",defaultMessage:"Archived channels"}),trailingElements:this.props.filter===J.Archived?r:null,"aria-label":this.props.intl.formatMessage({id:"suggestion.archive",defaultMessage:"Archived channels"})}));const o=M().createElement(M().Fragment,null,this.getFilterLabel(),M().createElement(R.ChevronDownIcon,{color:"rgba(var(--center-channel-color-rgb), 0.64)",size:16})),l=M().createElement(O.mc,{menuButton:{id:"menuWrapper",children:o},menu:{id:"browseChannelsDropdown","aria-label":this.props.intl.formatMessage({id:"more_channels.title",defaultMessage:"Browse channels"})}},i.map((e=>e))),c=_()("get-app__checkbox",{checked:this.props.rememberHideJoinedChannelsChecked}),d=M().createElement("div",{id:"hideJoinedPreferenceCheckbox",onClick:this.handleChecked,onKeyDown:e=>{e.stopPropagation(),"Enter"!==e.key&&" "!==e.key||this.handleChecked()},role:"checkbox","aria-checked":this.props.rememberHideJoinedChannelsChecked,"aria-label":this.props.intl.formatMessage({id:"more_channels.hide_joined_channels",defaultMessage:"Hide joined channels"}),tabIndex:0},M().createElement("div",{className:c},this.props.rememberHideJoinedChannelsChecked?M().createElement(x.A,null):null),M().createElement(T.FormattedMessage,{id:"more_channels.hide_joined",defaultMessage:"Hide Joined"}));let u;u=0===e.length?this.props.intl.formatMessage({id:"more_channels.count_zero",defaultMessage:"0 Results"}):1===e.length?this.props.intl.formatMessage({id:"more_channels.count_one",defaultMessage:"1 Result"}):e.length>1?this.props.intl.formatMessage(V.channelCount,{count:e.length}):this.props.intl.formatMessage({id:"more_channels.count_zero",defaultMessage:"0 Results"});const m=M().createElement("div",{className:"more-modal__dropdown"},M().createElement("span",{id:"channelCountLabel"},u),this.props.isSearch&&M().createElement("span",{className:"sr-only",role:"status","aria-live":"polite"},u),M().createElement("div",{id:"modalPreferenceContainer"},l,d));return M().createElement("div",{className:"filtered-user-list"},s,m,M().createElement("div",{role:"search",className:"more-modal__list",tabIndex:-1},M().createElement("div",{id:"moreChannelsList",tabIndex:-1,ref:this.channelListScroll},t)),M().createElement("div",{className:"filter-controls"},a,n))}}q(j,"propTypes",{channels:v().array.isRequired,channelsPerPage:v().number.isRequired,nextPage:v().func.isRequired,isSearch:v().bool.isRequired,search:v().func.isRequired,handleJoin:v().func.isRequired,noResultsText:v().element.isRequired,changeFilter:v().func.isRequired,closeModal:v().func.isRequired,hideJoinedChannelsPreference:v().func.isRequired,rememberHideJoinedChannelsChecked:v().bool.isRequired,canShowArchivedChannels:v().bool,loading:v().bool,channelsMemberCount:v().objectOf(v().number)});const V=(0,T.defineMessages)({channelCount:{id:"more_channels.count",defaultMessage:"{count} Results"},channelPurpose:{id:"more_channels.channel_purpose",defaultMessage:"Channel Information: Membership Indicator: Joined, Member count {memberCount} , Purpose: {channelPurpose}"},joiningButton:{id:"joinChannel.joiningButton",defaultMessage:"Joining..."},noMore:{id:"more_channels.noMore",defaultMessage:"No results for {text}"}}),z=(0,T.injectIntl)(j);var G=n(83007),W=n(63155),K=n(85873);function Y(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let J=function(e){return e.All="All",e.Public="Public",e.Private="Private",e.Archived="Archived",e}({});class Q extends M().PureComponent{constructor(e){super(e),Y(this,"activeChannels",[]),Y(this,"loadComplete",(()=>{this.setState({loading:!1})})),Y(this,"handleNewChannel",(()=>{this.handleExit(),this.closeEditRHS(),this.props.actions.openModal({modalId:b.IQ.NEW_CHANNEL_MODAL,dialogType:A.default})})),Y(this,"handleExit",(()=>{this.props.actions.closeModal(b.IQ.MORE_CHANNELS)})),Y(this,"closeEditRHS",(()=>{this.props.rhsOpen&&this.props.rhsState===b._n.EDIT_HISTORY&&this.props.actions.closeRightHandSide()})),Y(this,"onChange",(e=>{this.state.search&&!e||this.setState({searchedChannels:[],serverError:null})})),Y(this,"nextPage",(e=>{this.props.actions.getChannels(this.props.teamId,e+1,50).then((e=>{e.data&&e.data.length>0&&this.props.actions.getChannelsMemberCount(e.data.map((e=>e.id)))}))})),Y(this,"handleJoin",(async(e,t)=>{var n;const{actions:a,currentUserId:s,teamId:r,teamName:i}=this.props;let o;this.isMemberOfChannel(e.id)||(o=await a.joinChannel(s,r,e.id)),null!==(n=o)&&void 0!==n&&n.error?this.setState({serverError:o.error.message}):(this.props.actions.getChannelsMemberCount([e.id]),(0,G.J)().push((0,W.d7)(i,e.name)),this.closeEditRHS()),t&&t()})),Y(this,"search",(e=>{if(clearTimeout(this.searchTimeoutId),""===e)return this.onChange(!0),this.setState({search:!1,searchedChannels:[],searching:!1,searchTerm:e}),void(this.searchTimeoutId=0);this.setState({search:!0,searching:!0,searchTerm:e});const t=window.setTimeout((async()=>{try{const{data:n}=await this.props.actions.searchAllChannels(e,{team_ids:[this.props.teamId],nonAdminSearch:!0,include_deleted:!0});if(t!==this.searchTimeoutId)return;if(n){const e=n.map((e=>e.id));e.length>0&&this.props.actions.getChannelsMemberCount(e),this.setSearchResults(n.filter((e=>e.team_id===this.props.teamId)))}else this.setState({searchedChannels:[],searching:!1})}catch(e){this.setState({searchedChannels:[],searching:!1})}}),100);this.searchTimeoutId=t})),Y(this,"setSearchResults",(e=>{let t=e.filter((e=>e.type!==b.Ay.PRIVATE_CHANNEL||this.isMemberOfChannel(e.id)));this.state.filter===J.Private&&(t=e.filter((e=>e.type===b.Ay.PRIVATE_CHANNEL&&this.isMemberOfChannel(e.id)))),this.state.filter===J.Public&&(t=e.filter((e=>e.type===b.Ay.OPEN_CHANNEL&&0===e.delete_at))),this.state.filter===J.Archived&&(t=e.filter((e=>0!==e.delete_at))),this.props.shouldHideJoinedChannels&&(t=this.getChannelsWithoutJoined(t)),this.setState({searchedChannels:t,searching:!1})})),Y(this,"changeFilter",(e=>{this.search(this.state.searchTerm),this.setState({filter:e})})),Y(this,"handleShowJoinedChannelsPreference",(e=>{this.search(this.state.searchTerm),this.props.actions.setGlobalItem(b.eN.HIDE_JOINED_CHANNELS,e.toString())})),Y(this,"getChannelsWithoutJoined",(e=>e.filter((e=>!this.isMemberOfChannel(e.id))))),Y(this,"getActiveChannels",(()=>{const{channels:e,archivedChannels:t,shouldHideJoinedChannels:n,privateChannels:a}=this.props,{search:s,searchedChannels:r,filter:i}=this.state,o=e.concat(a).sort(((e,t)=>e.display_name.localeCompare(t.display_name))),l=this.getChannelsWithoutJoined(o),c=this.getChannelsWithoutJoined(e),d=this.getChannelsWithoutJoined(t),u=this.getChannelsWithoutJoined(a),m={[J.All]:n?l:o,[J.Archived]:n?d:t,[J.Private]:n?u:a,[J.Public]:n?c:e};return s?r:m[i]||m[J.All]})),this.searchTimeoutId=0,this.state={loading:!0,filter:J.All,search:!1,searchedChannels:[],serverError:null,searching:!1,searchTerm:""}}componentDidMount(){if(!this.props.teamId)return void this.loadComplete();const e=[this.props.actions.getChannels(this.props.teamId,0,100)];this.props.canShowArchivedChannels&&e.push(this.props.actions.getArchivedChannels(this.props.teamId,0,100)),Promise.all(e).then((e=>{const t=e.flatMap((e=>e.data?e.data.map((e=>e.id)):[]));this.props.privateChannels.forEach((e=>t.push(e.id))),t.length>0&&this.props.actions.getChannelsMemberCount(t)})),this.loadComplete()}isMemberOfChannel(e){return this.props.myChannelMemberships[e]}render(){const{teamId:e,channelsRequestStarted:t,shouldHideJoinedChannels:n}=this.props,{search:a,serverError:s,searching:r}=this.state;let i;this.activeChannels=this.getActiveChannels(),s&&(i=M().createElement("div",{className:"form-group has-error"},M().createElement("label",{className:"control-label"},s)));const o=(t,n)=>{const a=_()("btn",t);return M().createElement(N.A,{teamId:e,permissions:[w.A.CREATE_PUBLIC_CHANNEL]},M().createElement("button",{type:"button",id:"createNewChannelButton",className:a,onClick:this.handleNewChannel,"aria-label":(0,K.Vw)({id:"more_channels.create",defaultMessage:"Create New Channel"})},n,M().createElement(T.FormattedMessage,{id:"more_channels.create",defaultMessage:"Create New Channel"})))},l=M().createElement(M().Fragment,null,M().createElement("p",{className:"secondary-message"},M().createElement(T.FormattedMessage,{id:"more_channels.searchError",defaultMessage:"Try searching different keywords, checking for typos or adjusting the filters."})),o("btn-primary",M().createElement("i",{className:"icon-plus"}))),c=this.state.loading?M().createElement(I.A,null):M().createElement(M().Fragment,null,M().createElement(z,{channels:this.activeChannels,channelsPerPage:50,nextPage:this.nextPage,isSearch:a,search:this.search,handleJoin:this.handleJoin,noResultsText:l,loading:a?r:t,changeFilter:this.changeFilter,filter:this.state.filter,canShowArchivedChannels:this.props.canShowArchivedChannels,myChannelMemberships:this.props.myChannelMemberships,closeModal:this.props.actions.closeModal,hideJoinedChannelsPreference:this.handleShowJoinedChannelsPreference,rememberHideJoinedChannelsChecked:n,channelsMemberCount:this.props.channelsMemberCount}),i),d=M().createElement(T.FormattedMessage,{id:"more_channels.title",defaultMessage:"Browse Channels"});return M().createElement(S.zW,{id:"browseChannelsModal",onExited:this.handleExit,compassDesign:!0,modalHeaderText:d,headerButton:o("btn-secondary btn-sm"),autoCloseOnConfirmButton:!1,"aria-modal":!0,enforceFocus:!1,bodyPadding:!1},c)}}Y(Q,"propTypes",{channels:v().array.isRequired,archivedChannels:v().array.isRequired,privateChannels:v().array.isRequired,currentUserId:v().string.isRequired,teamId:v().string.isRequired,teamName:v().string,channelsRequestStarted:v().bool,canShowArchivedChannels:v().bool,shouldHideJoinedChannels:v().bool.isRequired,rhsOpen:v().bool,channelsMemberCount:v().objectOf(v().number),actions:v().shape({getChannels:v().func.isRequired,getArchivedChannels:v().func.isRequired,joinChannel:v().func.isRequired,searchAllChannels:v().func.isRequired,openModal:v().func.isRequired,closeModal:v().func.isRequired,setGlobalItem:v().func.isRequired,closeRightHandSide:v().func.isRequired,getChannelsMemberCount:v().func.isRequired}).isRequired});const Z=(0,o.Mz)("getChannelsWithoutArchived",l.aW,(e=>e&&e.filter((e=>0===e.delete_at&&e.type!==b.Ay.PRIVATE_CHANNEL)))),X=(0,o.Mz)("getArchivedOtherChannels",l.aW,(e=>e&&e.filter((e=>0!==e.delete_at)))),$=(0,o.Mz)("getPrivateChannelsSelector",l.aW,(e=>e&&e.filter((e=>e.type===b.Ay.PRIVATE_CHANNEL)))),ee=(0,a.connect)((function(e){const t=(0,d.H7)(e),n=(0,f.zR)(b.eN.HIDE_JOINED_CHANNELS,"false");return{channels:Z(e)||[],archivedChannels:X(e)||[],privateChannels:$(e)||[],currentUserId:(0,u.WR)(e),teamId:(0,d.Sy)(e),teamName:null==t?void 0:t.name,channelsRequestStarted:e.requests.channels.getChannels.status===i.IZ.STARTED,canShowArchivedChannels:"true"===(0,c.zj)(e).ExperimentalViewArchivedChannels,myChannelMemberships:(0,l.vd)(e)||{},shouldHideJoinedChannels:"true"===n(e),rhsState:(0,g.bM)(e),rhsOpen:(0,g.A)(e),channelsMemberCount:(0,l.kV)(e)}}),(function(e){return{actions:(0,s.bindActionCreators)({getChannels:r.Jp,getArchivedChannels:r.xM,joinChannel:r.Cg,searchAllChannels:r.Q1,openModal:h.q,closeModal:h.O,setGlobalItem:m.X2,closeRightHandSide:p.bP,getChannelsMemberCount:r.kV},e)}}))(Q)},97026:(e,t,n)=>{n.d(t,{GX:()=>S,PM:()=>f,_4:()=>M,_E:()=>A,bY:()=>w,wR:()=>I}),n(74883),n(17046),n(76409),n(43813);var a=n(97023),s=n(23453),r=n(40057),i=n(92159),o=n(65952),l=n(26614),c=n(80635),d=n(24380),u=n(58628),m=n(33172),h=n(78451),p=n(78138),g=n(68124);const f=50,{OPEN_CHANNEL:b,PRIVATE_CHANNEL:E,GM_CHANNEL:v,DM_CHANNEL:C}=h.Ay,_=(e,t)=>"".concat(e).concat(t),y={[_("add",b)]:r.xB.ADD_BOOKMARK_PUBLIC_CHANNEL,[_("edit",b)]:r.xB.EDIT_BOOKMARK_PUBLIC_CHANNEL,[_("delete",b)]:r.xB.DELETE_BOOKMARK_PUBLIC_CHANNEL,[_("order",b)]:r.xB.ORDER_BOOKMARK_PUBLIC_CHANNEL,[_("add",E)]:r.xB.ADD_BOOKMARK_PRIVATE_CHANNEL,[_("edit",E)]:r.xB.EDIT_BOOKMARK_PRIVATE_CHANNEL,[_("delete",E)]:r.xB.DELETE_BOOKMARK_PRIVATE_CHANNEL,[_("order",E)]:r.xB.ORDER_BOOKMARK_PRIVATE_CHANNEL},M=(e,t)=>(0,s.useSelector)((n=>T(n,e,t))),T=(e,t,n)=>{const a=(0,o.c)(e,t);if(!a)return!1;if(0!==a.delete_at)return!1;const{type:s}=a;if("threads"===s)return!1;if(s===v||s===C){const n=(0,o.MQ)(e,t);return(null==n?void 0:n.channel_id)===t}const r=y[_(n,s)];return a&&r&&(0,c.Ec)(e,a.team_id,t,r)},S=()=>(0,s.useSelector)((e=>(0,g.DE)((0,l.zj)(e)))),w=()=>(0,s.useSelector)((e=>(0,g.kc)((0,l.zj)(e)))),I=e=>{if("true"!==(0,l.Y6)(e,"ChannelBookmarks"))return!1;const t=(0,l.Ay)(e);return"true"===(null==t?void 0:t.IsLicensed)},A=e=>{const t=(0,s.useDispatch)(),n=(0,s.useSelector)((t=>(0,i.H)(t,e))),r=(0,a.useMemo)((()=>Object.keys(n).sort(((e,t)=>n[e].sort_order-n[t].sort_order))),[n]),[o,l]=(0,a.useState)();return(0,a.useEffect)((()=>{o&&l(void 0)}),[r]),(0,a.useEffect)((()=>{e&&t((0,u.ng)(e))}),[e]),(0,a.useEffect)((()=>{const e=Object.values(n).reduce(((e,t)=>{let{emoji:n}=t;return n&&e.push((0,p.at)(n)),e}),[]);e.length&&t((0,m.fS)(e))}),[n]),{bookmarks:n,order:null!=o?o:r,reorder:async(n,a,s)=>{l((0,d.wq)(r,n,s));const{error:i}=await t((0,u._M)(e,n,s));i&&l(void 0)}}}},34086:(e,t,n)=>{n.d(t,{A:()=>C}),n(17046),n(57406),n(55448);var a=n(97023),s=n.n(a),r=n(14778),i=n(23453),o=n(85406),l=n(8907),c=n(57676),d=n(65952),u=n(14776),m=n(59671),h=n(52073),p=n(79751),g=n(9916),f=n(12555),b=n(70669),E=n(78451);const v=e=>{const{formatMessage:t}=(0,r.useIntl)(),n=(0,i.useDispatch)(),a=(0,i.useSelector)(d.ou),v=(0,i.useSelector)((e=>e.views.channelSidebar.multiSelectedChannelIds)),C=(0,i.useSelector)(u.H7),_=(0,i.useSelector)((e=>C?(0,g.WJ)(e):void 0)),y=(0,i.useSelector)((t=>C?(0,c.oT)(t,(null==C?void 0:C.id)||"",e.channel.id):void 0));function M(t,a){t.preventDefault(),(null==y?void 0:y.id)!==a&&(n((0,h.Lt)(a,e.channel.id)),(0,m.sx)("ui","ui_sidebar_channel_menu_moveToExistingCategory"))}function T(){n((0,p.q)({modalId:E.IQ.EDIT_CATEGORY,dialogType:f.default,dialogProps:{channelIdsToAdd:-1===v.indexOf(e.channel.id)?[e.channel.id]:v}})),(0,m.sx)("ui","ui_sidebar_channel_menu_createCategory")}function S(t,n){return[...t.map((t=>{let a=s().createElement("span",null,t.display_name);t.type===l.e.FAVORITES&&(a=s().createElement(r.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.favorites",defaultMessage:"Favorites"})),t.type===l.e.CHANNELS&&(a=s().createElement(r.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.channels",defaultMessage:"Channels"}));let i=null;return n&&n.display_name===t.display_name&&(i=s().createElement(o.CheckIcon,{color:"var(--button-bg)",size:18})),s().createElement(b.q7,{id:"moveToCategory-".concat(e.channel.id,"-").concat(t.id),key:"moveToCategory-".concat(e.channel.id,"-").concat(t.id),leadingElement:t.type===l.e.FAVORITES?s().createElement(o.StarOutlineIcon,{size:18}):s().createElement(o.FolderOutlineIcon,{size:18}),labels:a,trailingElements:i,onClick:e=>M(e,t.id)})})),s().createElement(b.wv,{key:"ChannelMenu-moveToDivider"}),s().createElement(b.q7,{id:"moveToNewCategory-".concat(e.channel.id),key:"moveToNewCategory-".concat(e.channel.id),"aria-haspopup":!0,leadingElement:s().createElement(o.FolderMoveOutlineIcon,{size:18}),labels:s().createElement(r.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.moveToNewCategory",defaultMessage:"New Category"}),onClick:T})]}function w(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.filter((e=>e.type!==l.e.CHANNELS)):e.filter((e=>e.type!==l.e.DIRECT_MESSAGES))}return _?s().createElement(b.g8,{id:"moveTo-".concat(e.channel.id),labels:s().createElement(r.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.moveTo",defaultMessage:"Move to..."}),leadingElement:e.inHeaderDropdown?null:s().createElement(o.FolderMoveOutlineIcon,{size:18}),trailingElements:s().createElement(o.ChevronRightIcon,{size:16}),menuId:"moveTo-".concat(e.channel.id,"-menu"),menuAriaLabel:t({id:"sidebar_left.sidebar_channel_menu.moveTo.dropdownAriaLabel",defaultMessage:"Move to submenu"})},function(t,n){const s=v.includes(e.channel.id);return e.inHeaderDropdown||!s?S(w(t,e.channel.type===E.Ay.DM_CHANNEL||e.channel.type===E.Ay.GM_CHANNEL),n):v.every((e=>a[e].type===E.Ay.DM_CHANNEL||a[e].type===E.Ay.GM_CHANNEL))?S(w(t,!0),n):v.every((e=>a[e].type!==E.Ay.DM_CHANNEL&&a[e].type!==E.Ay.GM_CHANNEL))?S(w(t,!1),n):S(t.filter((e=>e.type!==l.e.CHANNELS&&e.type!==l.e.DIRECT_MESSAGES)),n)}(_,y)):null},C=(0,a.memo)(v)},12555:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var a=n(23453),s=n(5908),r=n(4629),i=n(14776),o=n(52073),l=n(62688),c=n.n(l),d=(n(4290),n(97023)),u=n.n(d),m=n(14778),h=n(14696),p=n(59671),g=n(86255),f=n(85873);function b(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class E extends u().PureComponent{constructor(e){super(e),b(this,"timeoutId",null),b(this,"isProcessing",!1),b(this,"handleClear",(()=>{this.setState({categoryName:""})})),b(this,"handleChange",(e=>{this.setState({categoryName:e.target.value})})),b(this,"handleCancel",(()=>{this.handleClear()})),b(this,"handleConfirm",(()=>{this.isProcessing||(this.isProcessing=!0,this.timeoutId=setTimeout((()=>{this.isProcessing=!1}),1e3),this.props.categoryId?this.props.actions.renameCategory(this.props.categoryId,this.state.categoryName):(this.props.actions.createCategory(this.props.currentTeamId,this.state.categoryName,this.props.channelIdsToAdd),(0,p.sx)("ui","ui_sidebar_created_category")))})),b(this,"isConfirmDisabled",(()=>!this.state.categoryName||Boolean(this.props.initialCategoryName)&&this.props.initialCategoryName===this.state.categoryName||this.state.categoryName.length>22)),b(this,"getText",(()=>{let e,t,n;return this.props.categoryId?(e=u().createElement(m.FormattedMessage,{id:"rename_category_modal.renameCategory",defaultMessage:"Rename Category"}),t=u().createElement(m.FormattedMessage,{id:"rename_category_modal.rename",defaultMessage:"Rename"})):(e=u().createElement(m.FormattedMessage,{id:"create_category_modal.createCategory",defaultMessage:"Create New Category"}),t=u().createElement(m.FormattedMessage,{id:"create_category_modal.create",defaultMessage:"Create"}),n=u().createElement(m.FormattedMessage,{id:"edit_category_modal.helpText",defaultMessage:"Drag channels into this category to organize your sidebar."})),{modalHeaderText:e,editButtonText:t,helpText:n}})),this.state={categoryName:e.initialCategoryName||""}}componentWillUnmount(){this.timeoutId&&clearTimeout(this.timeoutId)}render(){const{modalHeaderText:e,editButtonText:t,helpText:n}=this.getText();return u().createElement(h.zW,{id:"editCategoryModal",modalHeaderText:e,confirmButtonText:t,compassDesign:!0,onExited:this.props.onExited,handleEnterKeyPress:this.handleConfirm,handleConfirm:this.handleConfirm,handleCancel:this.handleCancel,isConfirmDisabled:this.isConfirmDisabled()},u().createElement(g.A,{inputComponent:g.P,autoFocus:!0,className:"form-control filter-textbox",type:"text",value:this.state.categoryName,placeholder:(0,f.Vw)({id:"edit_category_modal.placeholder",defaultMessage:"Name your category"}),clearable:!0,onClear:this.handleClear,onChange:this.handleChange,maxLength:22}),Boolean(n)&&u().createElement("span",{className:"edit-category__helpText"},n))}}b(E,"propTypes",{onExited:c().func.isRequired,currentTeamId:c().string.isRequired,categoryId:c().string,initialCategoryName:c().string,channelIdsToAdd:c().arrayOf(c().string),actions:c().shape({createCategory:c().func.isRequired,renameCategory:c().func.isRequired}).isRequired});const v=(0,a.connect)((function(e){return{currentTeamId:(0,i.Sy)(e)}}),(function(e){return{actions:(0,s.bindActionCreators)({createCategory:o.zZ,renameCategory:r.D8},e)}}))(E)},31892:(e,t,n)=>{n.d(t,{A:()=>M});var a=n(23453),s=n(5908),r=n(23739),i=n(65952),o=n(14776),l=n(7430),c=n(91767),d=n(78451),u=n(62688),m=n.n(u),h=(n(4290),n(97023)),p=n.n(h),g=n(34529),f=n(14778),b=n(79342),E=n(19513);function v(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class C extends p().PureComponent{constructor(e){super(e),v(this,"handleHide",(()=>{this.setState({show:!1})})),v(this,"handleKeyPress",(e=>{(0,E.e)(e,d.Ay.KeyCodes.ENTER)&&this.handleSubmit()})),v(this,"handleSubmit",(()=>{this.handleHide(),this.props.actions.leaveTeam(this.props.currentTeamId,this.props.currentUserId),this.props.actions.toggleSideBarRightMenu()})),this.state={show:!0}}componentDidMount(){document.addEventListener("keypress",this.handleKeyPress)}componentWillUnmount(){document.removeEventListener("keypress",this.handleKeyPress)}render(){const{currentUser:e,numOfPrivateChannels:t,numOfPublicChannels:n}=this.props;let a;return a=b.P(e.roles)?0!==n&&0!==t?p().createElement(f.FormattedMessage,{id:"leave_team_modal_guest.description",defaultMessage:"<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} and {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> You won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_public_channels:n,num_of_private_channels:t,strong:e=>p().createElement("strong",null,e)}}):0===n?p().createElement(f.FormattedMessage,{id:"leave_team_modal_guest_only_private.description",defaultMessage:"<strong>You will be removed from {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> You won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_private_channels:t,strong:e=>p().createElement("strong",null,e)}}):p().createElement(f.FormattedMessage,{id:"leave_team_modal_guest_only_public.description",defaultMessage:"<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} on this team.</strong> You won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_public_channels:n,strong:e=>p().createElement("strong",null,e)}}):0!==n&&0!==t?p().createElement(f.FormattedMessage,{id:"leave_team_modal.description",defaultMessage:"<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} and {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> If the team is private you won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_public_channels:n,num_of_private_channels:t,strong:e=>p().createElement("strong",null,e)}}):0===n?p().createElement(f.FormattedMessage,{id:"leave_team_modal_private.description",defaultMessage:"<strong>You will be removed from {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> If the team is private you won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_private_channels:t,strong:e=>p().createElement("strong",null,e)}}):p().createElement(f.FormattedMessage,{id:"leave_team_modal_public.description",defaultMessage:"<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} on this team.</strong> Are you sure?",values:{num_of_public_channels:n,strong:e=>p().createElement("strong",null,e)}}),p().createElement(g.Modal,{dialogClassName:"a11y__modal",className:"modal-confirm",show:this.state.show,onExited:this.props.onExited,onHide:this.handleHide,id:"leaveTeamModal",role:"none","aria-labelledby":"leaveTeamModalLabel"},p().createElement(g.Modal.Header,{closeButton:!1},p().createElement(g.Modal.Title,{componentClass:"h1",id:"leaveTeamModalLabel"},p().createElement(f.FormattedMessage,{id:"leave_team_modal.title",defaultMessage:"Leave the team?"}))),p().createElement(g.Modal.Body,null,a),p().createElement(g.Modal.Footer,null,p().createElement("button",{type:"button",className:"btn btn-tertiary",onClick:this.handleHide,id:"leaveTeamNo"},p().createElement(f.FormattedMessage,{id:"leave_team_modal.no",defaultMessage:"No"})),p().createElement("button",{type:"button",className:"btn btn-danger",onClick:this.handleSubmit,id:"leaveTeamYes"},p().createElement(f.FormattedMessage,{id:"leave_team_modal.yes",defaultMessage:"Yes"}))))}}function _(e){return(0,i.$3)(e).filter((e=>e.type===d.YM.PRIVATE_CHANNEL)).length}function y(e){return(0,i.$3)(e).filter((e=>e.type===d.YM.OPEN_CHANNEL)).length}v(C,"propTypes",{currentUserId:m().string.isRequired,currentTeamId:m().string.isRequired,numOfPublicChannels:m().number.isRequired,numOfPrivateChannels:m().number.isRequired,onExited:m().func.isRequired,actions:m().shape({leaveTeam:m().func.isRequired,toggleSideBarRightMenu:m().func.isRequired}).isRequired});const M=(0,a.connect)((function(e){return{currentUserId:(0,l.WR)(e),currentTeamId:(0,o.Sy)(e),currentUser:(0,l.HW)(e),numOfPrivateChannels:_(e),numOfPublicChannels:y(e)}}),(function(e){return{actions:(0,s.bindActionCreators)({leaveTeam:r.fy,toggleSideBarRightMenu:c.u9},e)}}))(C)},1277:(e,t,n)=>{n.d(t,{$:()=>u,A:()=>m});var a=n(62688),s=n.n(a),r=(n(43813),n(4290),n(97023)),i=n.n(r),o=n(34529),l=n(14778),c=n(1396);function d(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u=50;class m extends i().PureComponent{constructor(e){super(e),d(this,"handleHide",(()=>{this.setState({show:!1})})),d(this,"handleExit",(()=>{this.props.onHide&&this.props.onHide()})),d(this,"onNext",(()=>{const e=this.state.page+1;this.onPageChange(e)})),d(this,"onPrev",(()=>{const e=this.state.page-1;this.onPageChange(e)})),d(this,"onPageChange",(async e=>{this.setState({loading:!0});const t=await this.props.loadItems(e,this.state.searchTerm);this.setState({page:e,items:t.items,loading:!1})})),d(this,"onSearchInput",(async e=>{const{target:t}=e,n=t.value;this.setState({loading:!0,searchTerm:n});const a=await this.props.loadItems(0,n),{items:s,totalCount:r}=a;this.setState({loading:!1,items:s,totalCount:r})})),this.numPerPage=e.numPerPage||u,this.state={show:!0,page:0,items:[],totalCount:0,loading:!0,searchTerm:""}}async componentDidMount(){const{totalCount:e,items:t}=await this.props.loadItems(0,"");this.setState({totalCount:e,items:t,loading:!1})}renderRows(){return this.state.loading?i().createElement("div",null,i().createElement(c.A,{position:"absolute",key:"loading"})):this.state.items.map((e=>this.props.renderRow(e,this)))}paginationRange(){let e=this.state.page*this.numPerPage+1;const t=e+this.state.items.length-1;return 0===t&&(e=0),{startCount:e,endCount:t}}render(){if(!this.props.show)return null;const{endCount:e,startCount:t}=this.paginationRange();return i().createElement("div",null,i().createElement(o.Modal,{dialogClassName:"a11y__modal more-modal more-modal--action",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},i().createElement(o.Modal.Header,{closeButton:!0},i().createElement(o.Modal.Title,{componentClass:"h1"},i().createElement("span",{className:"name"},this.props.titleText)),this.props.titleBarButtonText&&this.props.titleBarButtonOnClick&&i().createElement("a",{className:"btn btn-md btn-primary",href:"#",onClick:this.props.titleBarButtonOnClick},this.props.titleBarButtonText)),i().createElement(o.Modal.Body,null,i().createElement("div",{className:"filtered-user-list"},i().createElement("div",{className:"filter-row"},i().createElement("div",{className:"col-xs-12"},i().createElement("label",{className:"hidden-label",htmlFor:"searchUsersInput"},this.props.searchPlaceholderText),i().createElement("input",{id:"searchUsersInput",className:"form-control filter-textbox",placeholder:this.props.searchPlaceholderText,onChange:this.onSearchInput})),i().createElement("div",{className:"col-sm-12"},i().createElement("span",{className:"member-count pull-left"},i().createElement(l.FormattedMessage,{id:"list_modal.paginatorCount",defaultMessage:"{startCount, number} - {endCount, number} of {total, number} total",values:{startCount:t,endCount:e,total:this.state.totalCount}})))),i().createElement("div",{className:"more-modal__list"},i().createElement("div",null,this.renderRows())),i().createElement("div",{className:"filter-controls"},this.state.page>0&&i().createElement("button",{onClick:this.onPrev,className:"btn btn-sm btn-tertiary filter-control filter-control__prev"},i().createElement(l.FormattedMessage,{id:"filtered_user_list.prev",defaultMessage:"Previous"})),this.props.numPerPage&&this.state.items.length>=this.props.numPerPage&&e!==this.state.totalCount&&i().createElement("button",{onClick:this.onNext,className:"btn btn-sm btn-tertiary filter-control filter-control__next"},i().createElement(l.FormattedMessage,{id:"filtered_user_list.next",defaultMessage:"Next"})))))))}}d(m,"propTypes",{titleText:s().string,searchPlaceholderText:s().string,titleBarButtonText:s().string,numPerPage:s().number,show:s().bool,titleBarButtonOnClick:s().func,loadItems:s().func.isRequired,onHide:s().func,renderRow:s().func.isRequired}),d(m,"defaultProps",{show:!0})},83642:(e,t,n)=>{n.d(t,{t:()=>u});var a=n(62688),s=n.n(a),r=n(71633),i=n.n(r),o=n(97023),l=n.n(o),c=n(95025),d=n(4715);const u=e=>{let{className:t,variant:n}=e;const a=(0,d.cX)()?"âŒ˜":"Ctrl",s=n||c.l.Contrast;return l().createElement("span",{className:i()("search-shortcut",t)},l().createElement(c.e,{variant:s},a),!(0,d.y3)()&&l().createElement(c.e,{variant:s},"Shift"),l().createElement(c.e,{variant:s},"F"))};u.propTypes={className:s().string}},19174:(e,t,n)=>{n.d(t,{A:()=>b});var a=n(62688),s=n.n(a),r=(n(29206),n(57406),n(55448),n(97023)),i=n.n(r),o=n(14778),l=n(23453),c=n(85406),d=n(59671),u=n(79751),m=n(12555),h=n(70669),p=n(78451);const g=["id"],f=e=>{let{id:t}=e,n=function(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.includes(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}(e,g);const a=(0,l.useDispatch)(),s=(0,r.useCallback)((()=>{a((0,u.q)({modalId:p.IQ.EDIT_CATEGORY,dialogType:m.default})),(0,d.sx)("ui","ui_sidebar_category_menu_createCategory")}),[a]);return i().createElement(h.q7,Object.assign({id:"create-".concat(t),onClick:s,"aria-haspopup":!0,leadingElement:i().createElement(c.FolderPlusOutlineIcon,{size:18}),labels:i().createElement(o.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.createCategory",defaultMessage:"Create New Category"})},n))};f.propTypes={id:s().string.isRequired};const b=f},51877:(e,t,n)=>{n.d(t,{A:()=>v});var a=n(62688),s=n.n(a),r=(n(29206),n(57406),n(55448),n(97023)),i=n.n(r),o=n(14778),l=n(23453),c=n(85406),d=n(79751),u=n(70669),m=n(78451),h=n(14696);const p=()=>null,g=e=>{let{handleConfirm:t,numChannels:n,onExited:a}=e;const s=(0,o.useIntl)(),r=s.formatMessage({id:"mark_as_read_confirm_modal.header",defaultMessage:"Mark as read"}),l=s.formatMessage({id:"mark_as_read_confirm_modal.body",defaultMessage:"Are you sure you want to mark {numChannels} channels as read?"},{numChannels:n}),c=s.formatMessage({id:"mark_as_read_confirm_modal.confirm",defaultMessage:"Mark as read"});return i().createElement(h.zW,{ariaLabel:r,compassDesign:!0,modalHeaderText:r,handleConfirm:t,handleCancel:p,onExited:a,confirmButtonText:c},i().createElement("span",{className:"mark-as-read__helpText"},l))};g.propTypes={handleConfirm:s().func.isRequired,numChannels:s().number.isRequired,onExited:s().func.isRequired};const f=g,b=["id","handleViewCategory","numChannels"],E=e=>{let{id:t,handleViewCategory:n,numChannels:a}=e,s=function(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.includes(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}(e,b);const h=(0,l.useDispatch)(),p=(0,r.useCallback)((()=>{a<=0||(1!==a?h((0,d.q)({modalId:m.IQ.DELETE_CATEGORY,dialogType:f,dialogProps:{handleConfirm:n,numChannels:a}})):n())}),[h,n,a]);return i().createElement(u.q7,Object.assign({id:"view-".concat(t),onClick:p,"aria-haspopup":a>1,leadingElement:i().createElement(c.MarkAsUnreadIcon,{size:18}),labels:i().createElement(o.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.viewCategory",defaultMessage:"Mark category as read"})},s))};E.propTypes={id:s().string.isRequired,handleViewCategory:s().func.isRequired,numChannels:s().number.isRequired};const v=E},77813:(e,t,n)=>{n.d(t,{A:()=>h});var a=n(62688),s=n.n(a),r=(n(17046),n(71633)),i=n.n(r),o=n(97023),l=n.n(o),c=n(14778),d=n(85406),u=n(70669);const m=e=>{let{id:t,children:n,name:a}=e;const[s,r]=(0,o.useState)(!1),{formatMessage:m}=(0,c.useIntl)();return l().createElement("div",{className:i()("SidebarMenu","MenuWrapper",{"MenuWrapper--open":s,menuOpen:s})},l().createElement(u.mc,{menuButton:{id:"SidebarCategoryMenu-Button-".concat(t),"aria-label":m({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"},{name:a}),class:"SidebarMenu_menuButton",children:l().createElement(d.DotsVerticalIcon,{size:16})},menuButtonTooltip:{text:m({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"},{name:a}),class:"hidden-xs"},menu:{id:"SidebarChannelMenu-MenuList-".concat(t),"aria-label":m({id:"sidebar_left.sidebar_category_menu.dropdownAriaLabel",defaultMessage:"Edit category menu"}),onToggle:function(e){r(e)}}},n))};m.propTypes={id:s().string.isRequired,children:s().arrayOf(s().node).isRequired,name:s().string.isRequired};const h=(0,o.memo)(m)},66039:(e,t,n)=>{n.d(t,{U:()=>d,w:()=>u});var a=n(62688),s=n.n(a),r=(n(29206),n(71633)),i=n.n(r),o=n(97023),l=n.n(o),c=n(78138);const d=l().forwardRef(((e,t)=>l().createElement("div",{className:"SidebarChannelGroupHeader SidebarChannelGroupHeader--static"},l().createElement("div",{ref:t,className:"SidebarChannelGroupHeader_groupButton"},l().createElement("div",{className:"SidebarChannelGroupHeader_text"},(0,c.uN)(e.displayName)),e.children))));d.propTypes={children:s().node,displayName:s().string.isRequired},d.displayName="SidebarCategoryHeaderStatic";const u=l().forwardRef(((e,t)=>{const{dragHandleProps:n}=e;return n&&n.role&&Reflect.deleteProperty(n,"role"),l().createElement("div",{className:i()("SidebarChannelGroupHeader",{muted:e.muted,dragging:e.isDragging})},l().createElement("button",{ref:t,className:i()("SidebarChannelGroupHeader_groupButton"),"aria-label":e.displayName,onClick:e.onClick,"aria-expanded":!e.isCollapsed},l().createElement("i",{className:i()("icon icon-chevron-down",{"icon-rotate-minus-90":e.isCollapsed,"hide-arrow":!e.isCollapsible})}),l().createElement("div",Object.assign({className:"SidebarChannelGroupHeader_text"},n,{tabIndex:-1}),(0,c.uN)(e.displayName))),e.children)}));u.propTypes={children:s().node,displayName:s().string.isRequired,isCollapsed:s().bool.isRequired,isCollapsible:s().bool,isDragging:s().bool,isDraggingOver:s().bool,muted:s().bool.isRequired,onClick:s().func.isRequired},u.defaultProps={isCollapsible:!0,isDragging:!1,isDraggingOver:!1},u.displayName="SidebarCategoryHeader"},45697:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(62688),s=n.n(a),r=n(71633),i=n.n(r),o=n(97023),l=n.n(o);function c(e){let{unreadMentions:t,hasUrgent:n,icon:a,className:s}=e;return t>0?l().createElement("span",{id:"unreadMentions",className:i()({badge:!0,urgent:n},s)},a,l().createElement("span",{className:"unreadMentions"},t)):null}c.propTypes={unreadMentions:s().number.isRequired,hasUrgent:s().bool,icon:s().node,className:s().string}},49876:(e,t,n)=>{n.d(t,{A:()=>Ne});var a=n(23453),s=n(65952),r=n(14776),i=n(9916),o=(n(17046),n(29206),n(71633)),l=n.n(o),c=n(97023),d=n.n(c),u=n(22005),m=n(14778),h=n(78451),p=n(5908),g=n(25778),f=n(79751),b=n(62688),E=n.n(b),v=n(59671),C=n(69238),_=n(3569),y=n(26614),M=n(77440),T=n(16230),S=n(87778),w=n(52073),I=n(2386),A=n(51140),N=n(75270),R=n(53791),P=n(99243),L=(n(4290),n(81911)),O=n(67277),k=n(59050),D=n(64766),x=n(87131),F=n(694),U=n(78138),B=n(19513),H=n(3295),q=n(45697);function j(e){let{hasDraft:t}=e;return t?d().createElement("i",{"data-testid":"draftIcon",className:"icon icon-pencil-outline channel-pencil-icon"}):null}n(76685),j.propTypes={hasDraft:E().bool.isRequired};const V=(0,c.memo)(j);function z(e,t,n){return null!==e&&Boolean(e.message.trim()||e.fileInfos.length||e.uploadsInProgress.length)&&n!==t}const G=(0,a.connect)((function(e,t){const n=(0,s.eH)(e);return{hasDraft:z((0,N.UR)(e,h.eN.DRAFT,t.id),t.id,n)}}))(V);function W(e){let{isDeleted:t,icon:n}=e;return t?d().createElement("i",{className:"icon icon-archive-outline"}):n}W.propTypes={icon:E().oneOfType([E().element,E().oneOf([null])]),isDeleted:E().bool.isRequired};const K=W;var Y=n(30413),J=n(16983),Q=n(80635),Z=n(15755),X=n(63155),$=n(85406),ee=n(46),te=n(34086),ne=n(70669),ae=n(85873);const se=e=>{let{channel:t,channelLink:n,currentUserId:a,favoriteChannel:s,isFavorite:r,isMuted:i,isUnread:o,managePrivateChannelMembers:l,managePublicChannelMembers:u,readMultipleChannels:p,markMostRecentPostInChannelAsUnread:g,muteChannel:f,onMenuToggle:b,openModal:E,unfavoriteChannel:C,unmuteChannel:_,channelLeaveHandler:y}=e;const M=(0,c.useRef)(!1),{formatMessage:T}=(0,m.useIntl)();let S=null;if(o){function P(){p([t.id]),(0,v.sx)("ui","ui_sidebar_channel_menu_markAsRead")}S=d().createElement(ne.q7,{id:"markAsRead-".concat(t.id),onClick:P,leadingElement:d().createElement($.MarkAsUnreadIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.markAsRead",defaultMessage:"Mark as Read"})})}else{function L(){g(t.id),(0,v.sx)("ui","ui_sidebar_channel_menu_markAsUnread")}S=d().createElement(ne.q7,{id:"markAsUnread-".concat(t.id),onClick:L,leadingElement:d().createElement($.MarkAsUnreadIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.markAsUnread",defaultMessage:"Mark as Unread"})})}let w=null;if(r){function O(){C(t.id),(0,v.sx)("ui","ui_sidebar_channel_menu_unfavorite")}w=d().createElement(ne.q7,{id:"unfavorite-".concat(t.id),onClick:O,leadingElement:d().createElement($.StarIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.unfavoriteChannel",defaultMessage:"Unfavorite"})})}else{function k(){s(t.id),(0,v.sx)("ui","ui_sidebar_channel_menu_favorite")}w=d().createElement(ne.q7,{id:"favorite-".concat(t.id),onClick:k,leadingElement:d().createElement($.StarOutlineIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.favoriteChannel",defaultMessage:"Favorite"})})}let I=null;if(i){let D=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.unmuteChannel",defaultMessage:"Unmute Channel"});function x(){_(a,t.id)}t.type!==h.Ay.DM_CHANNEL&&t.type!==h.Ay.GM_CHANNEL||(D=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.unmute",defaultMessage:"Unmute"})),I=d().createElement(ne.q7,{id:"unmute-".concat(t.id),onClick:x,leadingElement:d().createElement($.BellOffOutlineIcon,{size:18}),labels:D})}else{let F=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.muteChannel",defaultMessage:"Mute Channel"});function U(){f(a,t.id)}t.type!==h.Ay.DM_CHANNEL&&t.type!==h.Ay.GM_CHANNEL||(F=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.mute",defaultMessage:"Mute"})),I=d().createElement(ne.q7,{id:"mute-".concat(t.id),onClick:U,leadingElement:d().createElement($.BellOutlineIcon,{size:18}),labels:F})}let A=null;if(t.type===h.Ay.OPEN_CHANNEL||t.type===h.Ay.PRIVATE_CHANNEL){function B(){(0,ae.lW)(n)}A=d().createElement(ne.q7,{id:"copyLink-".concat(t.id),onClick:B,leadingElement:d().createElement($.LinkVariantIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.copyLink",defaultMessage:"Copy Link"})})}let N=null;if(t.type===h.Ay.PRIVATE_CHANNEL&&l||t.type===h.Ay.OPEN_CHANNEL&&u){function H(){E({modalId:h.IQ.CHANNEL_INVITE,dialogType:ee.A,dialogProps:{channel:t}}),(0,v.sx)("ui","ui_sidebar_channel_menu_addMembers")}N=d().createElement(ne.q7,{id:"addMembers-".concat(t.id),onClick:H,"aria-haspopup":"true",leadingElement:d().createElement($.AccountPlusOutlineIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.addMembers",defaultMessage:"Add Members"})})}let R=null;if(t.name!==h.Ay.DEFAULT_CHANNEL){let q=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.leaveChannel",defaultMessage:"Leave Channel"});function j(){!M.current&&y&&(M.current=!0,y((()=>{M.current=!1})),(0,v.sx)("ui","ui_sidebar_channel_menu_leave"))}t.type!==h.Ay.DM_CHANNEL&&t.type!==h.Ay.GM_CHANNEL||(q=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.leaveConversation",defaultMessage:"Close Conversation"})),R=d().createElement(ne.q7,{id:"leave-".concat(t.id),onClick:j,leadingElement:d().createElement($.ExitToAppIcon,{size:18}),labels:q,isDestructive:!0})}return d().createElement(ne.mc,{menuButton:{id:"SidebarChannelMenu-Button-".concat(t.id),class:"SidebarMenu_menuButton","aria-label":T({id:"sidebar_left.sidebar_channel_menu.editChannel.ariaLabel",defaultMessage:"Channel options for {channelName}"},{channelName:t.name}),children:d().createElement($.DotsVerticalIcon,{size:16})},menuButtonTooltip:{class:"hidden-xs",text:T({id:"sidebar_left.sidebar_channel_menu.editChannel",defaultMessage:"Channel options"})},menu:{id:"SidebarChannelMenu-MenuList-".concat(t.id),"aria-label":T({id:"sidebar_left.sidebar_channel_menu.dropdownAriaLabel",defaultMessage:"Edit channel menu"}),onToggle:b}},S,w,I,d().createElement(ne.wv,null),d().createElement(te.A,{channel:t}),(A||N)&&d().createElement(ne.wv,null),A,N,R&&d().createElement(ne.wv,null),R)},re=(0,c.memo)(se),ie={readMultipleChannels:Y.Zi,markMostRecentPostInChannelAsUnread:S.pr,favoriteChannel:Y.yc,unfavoriteChannel:Y.XJ,muteChannel:Z.vW,unmuteChannel:Z.c2,openModal:f.q},oe=(0,a.connect)((function(e,t){const n=(0,_.vd)(e)[t.channel.id],a=(0,r.H7)(e);let i=!1,o=!1;return a&&(i=(0,Q.Ec)(e,a.id,t.channel.id,J.A.MANAGE_PUBLIC_CHANNEL_MEMBERS),o=(0,Q.Ec)(e,a.id,t.channel.id,J.A.MANAGE_PRIVATE_CHANNEL_MEMBERS)),{currentUserId:(0,_.WR)(e),isFavorite:(0,s.g1)(e,t.channel.id),isMuted:(0,T.X4)(n),channelLink:"".concat((0,X.vV)()).concat(t.channelLink),managePublicChannelMembers:i,managePrivateChannelMembers:o}}),ie)(re);function le(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ce extends d().PureComponent{constructor(e){super(e),le(this,"enableToolTipIfNeeded",(()=>{const e=this.labelRef.current,t=e&&e.offsetWidth<e.scrollWidth;this.setState({showTooltip:Boolean(t)})})),le(this,"getAriaLabel",(()=>{const{label:e,ariaLabelPrefix:t,unreadMentions:n,intl:a}=this.props;let s=e;return t&&(s+=" ".concat(t)),1===n?s+=" ".concat(n," ").concat(a.formatMessage({id:"accessibility.sidebar.types.mention",defaultMessage:"mention"})):n>1&&(s+=" ".concat(n," ").concat(a.formatMessage({id:"accessibility.sidebar.types.mentions",defaultMessage:"mentions"}))),this.props.isUnread&&0===n&&(s+=" ".concat(a.formatMessage({id:"accessibility.sidebar.types.unread",defaultMessage:"unread"}))),s.toLowerCase()})),le(this,"handleChannelClick",(e=>{(0,v.Gy)(H.CU.ChannelLinkClicked),this.handleSelectChannel(e),this.props.rhsOpen&&this.props.rhsState===h._n.EDIT_HISTORY&&this.props.actions.closeRightHandSide(),setTimeout((()=>{(0,v.sx)("ui","ui_channel_selected_v2")}),0)})),le(this,"handleSelectChannel",(e=>{e.defaultPrevented||0!==e.button||((0,B.r)(e)?(e.preventDefault(),this.props.actions.multiSelectChannelAdd(this.props.channel.id)):e.shiftKey?(e.preventDefault(),this.props.actions.multiSelectChannelTo(this.props.channel.id)):e.altKey&&!this.props.isUnread?(e.preventDefault(),this.props.actions.markMostRecentPostInChannelAsUnread(this.props.channel.id)):this.props.actions.clearChannelSelection())})),le(this,"handleMenuToggle",(e=>{this.setState({isMenuOpen:e})})),this.labelRef=d().createRef(),this.state={isMenuOpen:!1,showTooltip:!1}}componentDidMount(){this.enableToolTipIfNeeded()}componentDidUpdate(e){e.label!==this.props.label&&this.enableToolTipIfNeeded()}render(){const{channel:e,icon:t,isChannelSelected:n,isMuted:a,isUnread:s,label:r,link:i,unreadMentions:o,firstChannelName:c,showChannelsTutorialStep:u,hasUrgent:m}=this.props;let p=null;(c===e.name||!c&&u&&e.name===h.Ay.DEFAULT_CHANNEL)&&(p=c?d().createElement(D.Pr,{firstChannelName:e.display_name}):d().createElement(D.Pr,null));let g=d().createElement("span",{ref:this.labelRef,className:"SidebarChannelLinkLabel"},(0,U.uN)(r));this.state.showTooltip&&(g=d().createElement(x.A,{title:r},g));const f=this.props.teammateId?d().createElement(O.A,{userID:this.props.teammateId,showTooltip:!0,spanStyle:{height:18},emojiStyle:{marginTop:-4,marginBottom:0,opacity:.8}}):null,b=this.props.isSharedChannel?d().createElement(k.A,{className:"icon",withTooltip:!0}):null,E=d().createElement(d().Fragment,null,d().createElement(K,{isDeleted:0!==e.delete_at,icon:t}),d().createElement("div",{className:"SidebarChannelLinkLabel_wrapper"},g,f,d().createElement(F.default,{pluggableName:"SidebarChannelLinkLabel",channel:this.props.channel}),b),d().createElement(G,{id:e.id}),d().createElement(q.A,{unreadMentions:o,hasUrgent:m}),d().createElement("div",{className:l()("SidebarMenu","MenuWrapper",{menuOpen:this.state.isMenuOpen},{"MenuWrapper--open":this.state.isMenuOpen})},d().createElement(oe,{channel:e,channelLink:i,isUnread:s,channelLeaveHandler:this.props.channelLeaveHandler,onMenuToggle:this.handleMenuToggle}))),v=l()(["SidebarLink",{menuOpen:this.state.isMenuOpen,muted:a,"unread-title":this.props.isUnread,selected:n}]);return d().createElement(L.Link,{className:v,id:"sidebarItem_".concat(e.name),"aria-label":this.getAriaLabel(),to:i,onClick:this.handleChannelClick,tabIndex:0},E,p)}}le(ce,"propTypes",{link:E().string.isRequired,label:E().string.isRequired,ariaLabelPrefix:E().string,channelLeaveHandler:E().func,icon:E().oneOfType([E().element,E().oneOf([null])]),unreadMentions:E().number.isRequired,isUnread:E().bool.isRequired,isMuted:E().bool.isRequired,isChannelSelected:E().bool.isRequired,teammateId:E().string,firstChannelName:E().string,showChannelsTutorialStep:E().bool.isRequired,hasUrgent:E().bool.isRequired,rhsOpen:E().bool,isSharedChannel:E().bool,actions:E().shape({markMostRecentPostInChannelAsUnread:E().func.isRequired,clearChannelSelection:E().func.isRequired,multiSelectChannelTo:E().func.isRequired,multiSelectChannelAdd:E().func.isRequired,unsetEditingPost:E().func.isRequired,closeRightHandSide:E().func.isRequired}).isRequired});const de=(0,m.injectIntl)(ce),ue=(0,a.connect)((function(){const e=(0,s.KP)();return(t,n)=>{const a=(0,_.vd)(t)[n.channel.id],s=e(t,n.channel.id),r=(0,y.zj)(t),o="true"===r.EnableTutorial,l=(0,_.WR)(t),c=(0,M.yW)(t,P.AG.ONBOARDING_TUTORIAL_STEP,l,0),d=(0,M.yW)(t,R.XV,R.Z.CHANNELS_TOUR,P.BL)===R.gy.STARTED,u=r.EnableOnboardingFlow,m=o&&c===P.NI.CHANNELS_AND_DIRECT_MESSAGES&&d&&"true"===u;return{unreadMentions:s.mentions,unreadMsgs:s.messages,isUnread:s.showUnread,isMuted:(0,T.X4)(a),hasUrgent:s.hasUrgent,isChannelSelected:(0,i.T$)(t,n.channel.id),firstChannelName:m?(0,A.Hd)(t):"",showChannelsTutorialStep:m,rhsState:(0,N.bM)(t),rhsOpen:(0,N.A)(t)}}}),(function(e){return{actions:(0,p.bindActionCreators)({markMostRecentPostInChannelAsUnread:S.pr,unsetEditingPost:S.K4,clearChannelSelection:w.lE,multiSelectChannelTo:w.Go,multiSelectChannelAdd:w.wf,closeRightHandSide:I.bP},e)}}))(de),me=e=>{let{channelType:t}=e;return t===h.Ay.OPEN_CHANNEL?d().createElement("i",{className:"icon icon-globe"}):t===h.Ay.PRIVATE_CHANNEL?d().createElement("i",{className:"icon icon-lock-outline"}):null},he=e=>{let{channel:t,currentTeamName:n,actions:a}=e;const s=(0,m.useIntl)(),r=(0,c.useCallback)((e=>{a.leaveChannel(t.id),(0,v.sx)("ui","ui_public_channel_x_button_clicked"),e()}),[t.id,a.leaveChannel]),i=(0,c.useCallback)((e=>{a.openModal({modalId:h.IQ.LEAVE_PRIVATE_CHANNEL_MODAL,dialogType:C.A,dialogProps:{channel:t}}),(0,v.sx)("ui","ui_private_channel_x_button_clicked"),e()}),[t,a.openModal]);let o=null;t.type===h.Ay.OPEN_CHANNEL&&t.name!==h.Ay.DEFAULT_CHANNEL?o=r:t.type===h.Ay.PRIVATE_CHANNEL&&(o=i);const l=d().createElement(me,{channelType:t.type});let u;return t.type===h.Ay.OPEN_CHANNEL?u=s.formatMessage({id:"accessibility.sidebar.types.public",defaultMessage:"public channel"}):t.type===h.Ay.PRIVATE_CHANNEL&&(u=s.formatMessage({id:"accessibility.sidebar.types.private",defaultMessage:"private channel"})),d().createElement(ue,{channel:t,link:"/".concat(n,"/channels/").concat(t.name),label:t.display_name,ariaLabelPrefix:u,channelLeaveHandler:o,icon:l,isSharedChannel:t.shared})};he.propTypes={currentTeamName:E().string.isRequired};const pe=he,ge=(0,a.connect)(null,(function(e){return{actions:(0,p.bindActionCreators)({leaveChannel:g.nE,openModal:f.q},e)}}))(pe);var fe=n(35631),be=n(7430),Ee=n(40693),ve=n(61767),Ce=n(83007);function _e(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ye extends d().PureComponent{constructor(){super(...arguments),_e(this,"handleLeaveChannel",(e=>{const t=this.props.channel.teammate_id,n=h.YM.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,a=this.props.currentUserId;this.props.actions.savePreferences(a,[{user_id:a,category:n,name:t,value:"false"}]).then(e),this.props.actions.leaveDirectChannel(this.props.channel.name),(0,v.sx)("ui","ui_direct_channel_x_button_clicked"),this.props.active&&(0,Ce.J)().push("/".concat(this.props.currentTeamName,"/channels/").concat(this.props.redirectChannel))})),_e(this,"getIcon",(()=>{const{channel:e,teammate:t}=this.props;if(!t)return null;if(t.id&&t.delete_at)return d().createElement("i",{className:"icon icon-archive-outline"});let n="";return"online"===e.status?n="status-online":"away"===e.status?n="status-away":"dnd"===e.status&&(n="status-dnd"),d().createElement(ve.A,{src:Ee.mT.getProfilePictureUrl(t.id,t.last_picture_update),size:"xs",status:t.is_bot?"":e.status,wrapperClass:"DirectChannel__profile-picture",newStatusIcon:!0,statusClass:"DirectChannel__status-icon ".concat(n)})}))}render(){const{channel:e,teammate:t,currentTeamName:n}=this.props;if(!t)return null;let a=e.display_name;return this.props.currentUserId===t.id&&(a=this.props.intl.formatMessage({id:"sidebar.directchannel.you",defaultMessage:"{displayname} (you)"},{displayname:e.display_name})),d().createElement(ue,{teammateId:t.id,channel:e,link:"/".concat(n,"/messages/@").concat(t.username),label:a,channelLeaveHandler:this.handleLeaveChannel,icon:this.getIcon(),isSharedChannel:Boolean(t.remote_id)})}}_e(ye,"propTypes",{currentTeamName:E().string.isRequired,currentUserId:E().string.isRequired,redirectChannel:E().string.isRequired,active:E().bool.isRequired,actions:E().shape({savePreferences:E().func.isRequired,leaveDirectChannel:E().func.isRequired}).isRequired});const Me=(0,m.injectIntl)(ye),Te=(0,a.connect)((function(e,t){const n=(0,be.wz)(e,t.channel.teammate_id),a=(0,be.HW)(e),i=(0,r.H7)(e),o=i?(0,s.Dn)(e,i.id):"",l=(0,s.eH)(e),c=t.channel.id===l;return{teammate:n,currentUserId:a.id,redirectChannel:o,active:c}}),(function(e){return{actions:(0,p.bindActionCreators)({savePreferences:fe.SF,leaveDirectChannel:g.iq},e)}}))(Me),Se=e=>{let{channel:t,currentUserId:n,actions:a,active:s,currentTeamName:r,redirectChannel:i,membersCount:o}=e;const l=(0,c.useCallback)((e=>{const o=t.id,l=h.Ay.Preferences.CATEGORY_GROUP_CHANNEL_SHOW;a.savePreferences(n,[{user_id:n,category:l,name:o,value:"false"}]).then(e),(0,v.sx)("ui","ui_direct_channel_x_button_clicked"),s&&(0,Ce.J)().push("/".concat(r,"/channels/").concat(i))}),[t.id,a,s,r,i,n]);return d().createElement(ue,{channel:t,link:"/".concat(r,"/messages/").concat(t.name),label:t.display_name,channelLeaveHandler:l,icon:d().createElement("div",{className:"status status--group"},o)})};Se.propTypes={currentTeamName:E().string.isRequired,currentUserId:E().string.isRequired,redirectChannel:E().string.isRequired,active:E().bool.isRequired,membersCount:E().number.isRequired,actions:E().shape({savePreferences:E().func.isRequired}).isRequired};const we=(0,c.memo)(Se),Ie=(0,a.connect)((function(){const e=(0,s.fV)();return(t,n)=>{const a=(0,be.WR)(t),i=(0,r.H7)(t),o=i?(0,s.Dn)(t,i.id):"",l=(0,s.eH)(t),c=e(t,n.channel);return{currentUserId:a,redirectChannel:o,active:n.channel.id===l,membersCount:c}}}),(function(e){return{actions:(0,p.bindActionCreators)({savePreferences:fe.SF},e)}}))(we),Ae=(0,a.connect)((function(){const e=(0,s.s9)(),t=(0,s.KP)();return(n,a)=>{const o=e(n,a.channelId),l=(0,r.H7)(n),c=(0,s.eH)(n),d=t(n,(null==o?void 0:o.id)||"");return{channel:o,isCurrentChannel:(null==o?void 0:o.id)===c,currentTeamName:null==l?void 0:l.name,unreadMentions:d.mentions,isUnread:d.showUnread,draggingState:(0,i.NX)(n),isChannelSelected:(0,i.T$)(n,a.channelId),multiSelectedChannelIds:n.views.channelSidebar.multiSelectedChannelIds,autoSortedCategoryIds:(0,i.VM)(n)}}})),Ne=Ae((function(e){let{isCategoryCollapsed:t,isCategoryDragged:n,isUnread:a,isCurrentChannel:s,setChannelRef:r,channel:i,currentTeamName:o,isDraggable:p,isChannelSelected:g,draggingState:f,multiSelectedChannelIds:b,channelIndex:E,isAutoSortedCategory:v,autoSortedCategoryIds:C}=e;const[_,y]=(0,c.useState)(!0);if(!i)return null;if(!o)return null;function M(){return n||t&&!a&&!s}function T(e){return t=>{r((null==i?void 0:i.id)||"",t),null==e||e(t)}}function S(e){e&&"toOpaqueAnimation"===e.animationName&&!M()&&y(!0)}function w(e){e&&"toTransparentAnimation"===e.animationName&&M()&&y(!1)}let I;if(I=_?i.type===h.Ay.DM_CHANNEL?d().createElement(Te,{channel:i,currentTeamName:o}):i.type===h.Ay.GM_CHANNEL?d().createElement(Ie,{channel:i,currentTeamName:o}):d().createElement(ge,{channel:i,currentTeamName:o}):null,p){let e;return g&&f.state&&f.id===i.id&&b.length>1&&(e=_?d().createElement("div",{className:"SidebarChannel__selectedCount"},d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel.selectedCount",defaultMessage:"{count} selected",values:{count:b.length}})):null),d().createElement(u.Draggable,{draggableId:i.id,index:E},((t,n)=>d().createElement("li",Object.assign({draggable:"false",ref:T(t.innerRef),className:l()("SidebarChannel",{collapsed:M(),expanded:!M(),unread:a,active:s,dragging:n.isDragging,selectedDragging:g&&f.state&&f.id!==i.id,fadeOnDrop:n.isDropAnimating&&n.draggingOver&&C.has(n.draggingOver),noFloat:v&&!n.isDragging})},t.draggableProps,t.dragHandleProps,{onAnimationStart:S,onAnimationEnd:w,role:"listitem",tabIndex:-1}),I,e)))}return d().createElement("li",{ref:T(),className:l()("SidebarChannel",{collapsed:M(),expanded:!M(),unread:a,active:s}),onAnimationStart:S,onAnimationEnd:w,role:"listitem"},I)}))},68325:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ci}),n(3188),n(6552);var a=n(23453),s=n(30413),r=n(65952),i=n(26614),o=n(14776),l=n(7430),c=n(25778),d=n(75270),u=n(10189),m=(n(43813),n(4290),n(1418)),h=n(87373),p=n(87988),g=n(23739),f=n(3569),b=n(77440),E=n(59935),v=n(46859),C=n(30388),_=n(83949);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e){return async(t,n)=>{t((0,g.Uv)(e.id));const a=n(),s=(0,l.HW)(a);C.A.setPreviousTeamId(s.id,e.id),(0,f.F4)(a)&&t((0,E.I8)());const r=(0,i.Ay)(a),o=(0,b.h7)(a);if(r&&"true"===r.IsLicensed&&("true"===r.LDAPGroups||o)){const n={filter_allow_reference:!1,page:0,per_page:60,include_member_count:!0,include_member_ids:!0,include_archived:!1},a=M(M({},n),{},{filter_has_member:s.id});s&&t((0,h.N9)(a)),"true"===r.LDAPGroups&&t((0,h.jM)(e.id,!0)),e.group_constrained&&"true"===r.LDAPGroups?t((0,h.UT)(e.id,!0)):t((0,h.f)(n))}return{data:e}}}var w=n(20553),I=n(92387),A=n.n(I),N=(n(17046),n(74883),n(57406),n(55448),n(70727)),R=n.n(N),P=n(97023),L=n.n(P),O=n(81911),k=n(55171),D=n(15252),x=n(62688),F=n.n(x),U=n(71633),B=n.n(U),H=n(11925),q=n(7380),j=n(5908),V=n(17085),z=n(49176),G=n(35664),W=n(78451),K=(n(29206),n(97309),n(10844),n(59297),n(40693)),Y=n(79342),J=n(15755),Q=n(91767),Z=n(78064),X=n(85873);const $=new RegExp("^[a-zA-Z0-9]{".concat(26,"}__[a-zA-Z0-9]{").concat(26,"}$"));function ee(e){let{match:t,history:n}=e;return async(e,a)=>{const i=a(),{path:c,identifier:d,team:u}=t.params;if(!d)return{data:void 0};const m=(0,o.Uj)(i,u);if(!m)return{data:void 0};const h=await async function(e,t,n){if("channels"===t){const t=(0,r.Os)(e,n),a=(0,r.pd)(e).find((e=>e.name===n));if(26===n.length){if(!t&&!a)try{return await K.mT.getChannel(n),"channel_id"}catch(e){return 404===e.status_code?"channel_name":"error"}return"channel_name"}return!t&&!a&&40===n.length||t&&t.type===W.YM.GM_CHANNEL||a&&a.type===W.YM.GM_CHANNEL?"group_channel_group_id":function(e){return 54===e.length&&$.test(e)}(n)?"direct_channel_user_ids":"channel_name"}return"messages"===t?0===n.indexOf("@")?"direct_channel_username":n.indexOf("@")>0?"direct_channel_email":26===n.length?"direct_channel_user_id":40===n.length?"group_channel_group_id":"error":"error"}(i,c,d);switch(h){case"channel_name":e(function(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=d.toLowerCase(),m=(0,o.Uj)(i,c);if(!m)return{data:void 0};let h,p=(0,r.wX)(i,m.id)[u];if(!p){const e=await n((0,s.lB)(c,u,!0));"data"in e&&(p=e.data)}if(p&&(h=i.entities.channels.myMembers[p.id],!h)){const e=await n((0,s.UB)(p.id,(0,l.WR)(i)));"data"in e&&(h=e.data)}if(!p||!h){var g,f;if((null===(g=p)||void 0===g?void 0:g.type)===W.YM.PRIVATE_CHANNEL){const e=(0,l.HW)(a());let t=!1;if(Y.FV(null==e?void 0:e.roles))t=!0;else{const e=(0,o.AG)(i,m.id);t=Boolean(e&&e.scheme_admin)}if(t){const e=await n((0,Z.DT)(m,p.display_name));if("data"in e&&!e.data.join)return{data:void 0}}}const d=await n((0,s.Cg)((0,l.WR)(i),m.id,(null===(f=p)||void 0===f?void 0:f.id)||"",u));if("error"in d){if(!p){const a=await n((0,s.lB)(c,u,!0));if("error"in a||0===a.data.delete_at)return await n((0,s.DC)(m.id)),re(e,t,(0,r.Dn)(i,m.id)),{data:void 0};p=a.data}}else p=d.data.channel}return p.type===W.YM.DM_CHANNEL?n(ne(e,t)):p.type===W.YM.GM_CHANNEL?t.replace("/".concat(c,"/messages/").concat(p.name)):ae(p),{data:void 0}}}(t,n));break;case"channel_id":e(function(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=d.toLowerCase();let m=(0,r.c)(i,u);const h=i.entities.channels.myMembers[u],p=(0,o.Uj)(i,c);if(!m||!h){const a=await n((0,s.Cg)((0,l.WR)(i),p.id,u,""));if("error"in a)return await n((0,s.DC)(p.id)),re(e,t,(0,r.Dn)(i,p.id)),{data:void 0};m=a.data.channel}return m.type===W.YM.DM_CHANNEL?n(te(e,t,X.zj(m.name,(0,l.WR)(i)))):m.type===W.YM.GM_CHANNEL?t.replace("/".concat(c,"/messages/").concat(m.name)):t.replace("/".concat(c,"/channels/").concat(m.name)),{data:void 0}}}(t,n));break;case"group_channel_group_id":e(function(e,t){return async(n,a)=>{const i=a(),{identifier:c,team:d}=e.params,u=c.toLowerCase();t.replace(e.url.replace("/channels/","/messages/"));let m=(0,r.Os)(i,u);const h=(0,o.Uj)(i,d);if(!m){const a=await n((0,s.Cg)((0,l.WR)(i),h.id,"",u));if("error"in a)return await n((0,s.DC)(h.id)),se(e,t,(0,r.Dn)(i,h.id)),{data:void 0};m=a.data.channel}return n((0,s.wO)(m.id)),ae(m),{data:void 0}}}(t,n));break;case"direct_channel_username":e(function(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=d.slice(1,d.length).toLowerCase(),m=(0,o.Uj)(i,c);let h=(0,l.JE)(i,u);if(!h){const a=await n((0,V.JE)(u));if("error"in a)return await n((0,s.DC)(m.id)),se(e,t,(0,r.Dn)(i,m.id)),{data:void 0};h=a.data}const p=await n((0,J.q6)(h.id));return"error"in p?(await n((0,s.DC)(m.id)),se(e,t,(0,r.Dn)(i,m.id)),{data:void 0}):(ae(p.data),{data:void 0})}}(t,n));break;case"direct_channel_email":e(function(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=d.toLowerCase(),m=(0,o.Uj)(i,c);let h=(0,l.ht)(i,u);if(!h){const a=await n((0,V.ht)(u));if("error"in a)return await n((0,s.DC)(m.id)),se(e,t,(0,r.Dn)(i,m.id)),{data:void 0};h=a.data}return t.replace("/".concat(c,"/messages/@").concat(h.username)),{data:void 0}}}(t,n));break;case"direct_channel_user_ids":e(ne(t,n));break;case"direct_channel_user_id":e(te(t,n,d));break;case"error":await e((0,s.DC)(m.id)),se(t,n,(0,r.Dn)(i,m.id))}return{data:void 0}}}function te(e,t,n){return async(a,i)=>{const c=i(),{team:d}=e.params,u=(0,o.Uj)(c,d);let m=(0,l.wz)(c,n);if(!m){const i=await a((0,V.wz)(n));if("error"in i)return await a((0,s.DC)(u.id)),se(e,t,(0,r.Dn)(c,u.id)),{data:void 0};m=i.data}return t.replace("/".concat(d,"/messages/@").concat(m.username)),{data:void 0}}}function ne(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=X.zj(d.toLowerCase(),(0,l.WR)(a())),m=(0,o.Uj)(i,c);let h=(0,l.wz)(i,u);if(!h){const a=await n((0,V.wz)(u));if("error"in a)return await n((0,s.DC)(m.id)),se(e,t,(0,r.Dn)(i,m.id)),{data:void 0};h=a.data}return t.replace("/".concat(c,"/messages/@").concat(h.username)),{data:void 0}}}function ae(e){Q.tk(e)}function se(e,t,n){const{team:a}=e.params;t.push(a?"/".concat(a,"/channels/").concat(n):"/")}async function re(e,t,n){const{team:a}=e.params;t.push(a?"/error?type=channel_not_found&returnTo=/".concat(a,"/channels/").concat(n):"/")}var ie=n(35073),oe=n(97026),le=n(14778),ce=n(87818),de=n(78417),ue=n(1396),me=n(40057),he=n(52729),pe=n(78546),ge=n(30112),fe=n(92008),be=n(59671),Ee=n(70713),ve=n(72870),Ce=n(10711),_e=n(51565),ye=n(4715);function Me(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Te={display:"inline",width:"0px",height:"0px",zIndex:"-1",overflow:"hidden",margin:"0px",padding:"0px"},Se={position:"absolute",flex:"0 0 auto",overflow:"hidden",visibility:"hidden",zIndex:"-1",width:"100%",height:"100%",left:"0px",top:"0px"},we={flex:"0 0 auto",overflow:"hidden",zIndex:"-1",visibility:"hidden",left:"-".concat(9,"px"),bottom:"-".concat(8,"px"),right:"-".concat(8,"px"),top:"-".concat(9,"px")},Ie={position:"absolute",flex:"0 0 auto",visibility:"hidden",overflow:"scroll",zIndex:"-1",width:"100%",height:"100%"},Ae={position:"absolute",height:"200%",width:"200%"};class Ne extends P.PureComponent{constructor(){var e;super(...arguments),e=this,Me(this,"_node",null),Me(this,"_resizeSensorExpand",L().createRef()),Me(this,"_resizeSensorShrink",L().createRef()),Me(this,"_positionScrollbarsRef",null),Me(this,"_measureItemAnimFrame",null),Me(this,"_measureItem",(e=>{const{handleNewMeasurements:t,size:n,itemId:a}=this.props,s=this._node;if(s&&s.ownerDocument&&s.ownerDocument.defaultView&&s instanceof s.ownerDocument.defaultView.HTMLElement){const r=Math.ceil(s.offsetHeight);n!==r&&t(a,r,e)}})),Me(this,"positionScrollBars",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.size;e._positionScrollbarsRef&&window.cancelAnimationFrame(e._positionScrollbarsRef),e._positionScrollbarsRef=window.requestAnimationFrame((()=>{e._resizeSensorExpand.current.scrollTop=t+27,e._resizeSensorShrink.current.scrollTop=2*t+17}))})),Me(this,"scrollingDiv",(e=>{e.target.offsetHeight!==this.props.size&&this._measureItem(e.target.offsetWidth!==this.props.width)})),Me(this,"renderItems",(()=>{const e=this.props.item,t={position:"absolute",left:"0",top:"0",height:"".concat(this.props.size+27,"px"),width:"100%"};return L().createElement("div",{role:"listitem",style:{position:"relative"}},e,L().createElement("div",{style:Te},L().createElement("div",{dir:"ltr",style:Se},L().createElement("div",{style:we},L().createElement("div",{style:Ie,ref:this._resizeSensorExpand,onScroll:this.scrollingDiv},L().createElement("div",{style:t})),L().createElement("div",{style:Ie,ref:this._resizeSensorShrink,onScroll:this.scrollingDiv},L().createElement("div",{style:Ae}))))))}))}componentDidMount(){this._node=(0,_e.findDOMNode)(this),(0,ye.nr)()&&this.props.size?this._measureItemAnimFrame=requestAnimationFrame((()=>{this._measureItem(!1)})):this._measureItem(!1),this.props.size&&this.positionScrollBars()}componentDidUpdate(e){(0===e.size&&0!==this.props.size||e.size!==this.props.size)&&this.positionScrollBars()}componentWillUnmount(){this._positionScrollbarsRef&&window.cancelAnimationFrame(this._positionScrollbarsRef),this._measureItemAnimFrame&&window.cancelAnimationFrame(this._measureItemAnimFrame);const{onUnmount:e,itemId:t,index:n}=this.props;e&&e(t,n)}render(){return this.renderItems()}}function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){Le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Oe extends P.PureComponent{constructor(e){super(e),Le(this,"_listMetaData",{itemOffsetMap:{},itemSizeMap:{},totalMeasuredSize:0,atBottom:!0}),Le(this,"_itemStyleCache",{}),Le(this,"_scrollCorrectionInProgress",!1),Le(this,"_scrollByCorrection",null),Le(this,"_keepScrollPosition",!1),Le(this,"_keepScrollToBottom",!1),Le(this,"_mountingCorrections",0),Le(this,"_correctedInstances",0),Le(this,"state",{scrollDirection:"backward",scrollOffset:"number"==typeof this.props.initialScrollOffset?this.props.initialScrollOffset:0,scrollUpdateWasRequested:!1,scrollDelta:0,scrollHeight:0,localOlderPostsToRender:[]}),Le(this,"scrollBy",((e,t)=>()=>{const n=this._outerRef;"function"==typeof n.scrollBy&&t?n.scrollBy(0,t):e&&(n.scrollTop=e),this._scrollCorrectionInProgress=!1})),Le(this,"_callOnItemsRendered",(0,Ce.A)(((e,t,n,a)=>this.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:n,visibleStopIndex:a})))),Le(this,"_callOnScroll",(0,Ce.A)(((e,t,n,a,s)=>this.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:n,scrollHeight:a,clientHeight:s})))),Le(this,"_commitHook",(()=>{if(!this.state.scrolledToInitIndex&&Object.keys(this._listMetaData.itemOffsetMap).length){const{index:e,position:t,offset:n}=this.props.initScrollToIndex();this.scrollToItem(e,t,n),this.setState({scrolledToInitIndex:!0}),0===e?this._keepScrollToBottom=!0:this._keepScrollPosition=!0}})),Le(this,"_dataChange",(()=>{this._listMetaData.totalMeasuredSize<this.props.height&&this.props.canLoadMorePosts()})),Le(this,"_heightChange",((e,t)=>{t+e>=this._listMetaData.totalMeasuredSize-10&&this.scrollToItem(0,"end")})),Le(this,"_widthChange",((e,t)=>{t+e>=this._listMetaData.totalMeasuredSize-10&&this.scrollToItem(0,"end")})),Le(this,"_getItemStyle",(e=>{const{itemData:t}=this.props,n=this._itemStyleCache;let a;return Object.prototype.hasOwnProperty.call(n,t[e])?a=n[t[e]]:(a={left:0,top:De(this.props,e,this._listMetaData),height:Be(this.props,e,this._listMetaData),width:"100%"},n[t[e]]=a),a})),Le(this,"_correctScroll",(()=>{const{scrollOffset:e}=this.state,t=this._outerRef;t&&(t.scrollTop=e,this._scrollCorrectionInProgress=!1,this._correctedInstances=0,this._mountingCorrections=0)})),Le(this,"_generateOffsetMeasurements",(()=>{const{itemOffsetMap:e,itemSizeMap:t}=this._listMetaData,{itemData:n}=this.props;this._listMetaData.totalMeasuredSize=0;for(let a=n.length-1;a>=0;a--){const s=e[n[a+1]]||0,r=t[n[a+1]]||0;e[n[a]]=s+r,this._listMetaData.totalMeasuredSize+=t[n[a]]||0,delete this._itemStyleCache[n[a]]}})),Le(this,"_handleNewMeasurements",((e,t,n)=>{const{itemSizeMap:a}=this._listMetaData,{itemData:s}=this.props,r=s.findIndex((t=>t===e)),i=a[e]||0;if(i===t)return;if(a[e]=t,!this.state.scrolledToInitIndex)return void this._generateOffsetMeasurements();const o=this._outerRef;if((this.props.height+o.scrollTop>=this._listMetaData.totalMeasuredSize-10||this._keepScrollToBottom)&&this.props.correctScrollToBottom)return this._generateOffsetMeasurements(),this.scrollToItem(0,"end"),void this.forceUpdate();if(n||this._keepScrollPosition){const e=t-i,[,,n]=this._getRangeToRender(this.state.scrollOffset);if(this._generateOffsetMeasurements(),r<n+1)return;return this._scrollCorrectionInProgress=!0,void this.setState((t=>{let n;return n=0===this._mountingCorrections?e:t.scrollDelta+e,this._mountingCorrections++,{scrollOffset:t.scrollOffset+e,scrollDelta:n}}),(()=>{this._correctedInstances++,this._mountingCorrections===this._correctedInstances&&this._correctScroll()}))}this._generateOffsetMeasurements()})),Le(this,"_onItemRowUnmount",((e,t)=>{const{props:n}=this;if(n.itemData[t]!==e&&!n.itemData.includes(e)){delete this._listMetaData.itemSizeMap[e],delete this._listMetaData.itemOffsetMap[e];const t=this._outerRef,n=t.offsetHeight+t.scrollTop>=this._listMetaData.totalMeasuredSize-10;this._generateOffsetMeasurements(),n&&this.scrollToItem(0,"end"),this.forceUpdate()}})),Le(this,"_onScrollVertical",(e=>{if(!this.state.scrolledToInitIndex)return;const{scrollTop:t,scrollHeight:n}=e.currentTarget;this._scrollCorrectionInProgress?this.state.scrollUpdateWasRequested&&this.setState((()=>({scrollUpdateWasRequested:!1}))):(n!==this.state.scrollHeight&&this.setState({scrollHeight:n}),this.setState((e=>e.scrollOffset===t?null:{scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1,scrollHeight:n,scrollTop:t,scrollDelta:0})))})),Le(this,"_outerRefSetter",(e=>{const{outerRef:t}=this.props;this.innerRefWidth=this.props.innerRef.current.clientWidth,this._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"current")&&(t.current=e)})),Le(this,"_renderItems",(()=>{const{children:e,direction:t,itemData:n,loaderId:a,visibleId:s}=this.props,r=this.innerRefWidth,[i,o]=this._getRangeToRender(),l=n.length,c=[];if(l>0)for(let d=l-1;d>=0;d--){const{size:u}=ke(this.props,d,this._listMetaData),[m,h]=this.state.localOlderPostsToRender,p=d>=m&&d<h+1&&m===o+1,g=n[d]===a,f=n[d]===s,b=n[d],E=this._getItemStyle(d);if(d>=i&&d<o+1||p||g||f){const a=(0,P.createElement)(e,{data:n,itemId:b});c.push((0,P.createElement)(Ne,{direction:t,handleNewMeasurements:this._handleNewMeasurements,index:d,item:a,key:b,size:u,itemId:b,width:r,onUnmount:this._onItemRowUnmount,itemCount:l}))}else c.push((0,P.createElement)("div",{key:b,style:E}))}return c}))}scrollTo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._scrollCorrectionInProgress=!0,this.setState((n=>({scrollDirection:n.scrollOffset>=e?"backward":"forward",scrollOffset:e,scrollUpdateWasRequested:!0,scrollByValue:t})),(()=>{n?this._scrollByCorrection=window.requestAnimationFrame(this.scrollBy(this.state.scrollOffset,this.state.scrollByValue)):this.scrollBy(this.state.scrollOffset,this.state.scrollByValue)()})),this.forceUpdate()}scrollToItem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const{scrollOffset:a}=this.state,s=this._outerRef;if(0===e&&"end"===t)return void this.scrollTo(s.scrollHeight-this.props.height);const r=xe(this.props,e,t,a,this._listMetaData);r||!Be(this.props,e,this._listMetaData)&&this.props.scrollToFailed&&this.state.scrolledToInitIndex&&this.props.scrollToFailed(e),this.scrollTo(r+n)}componentDidMount(){const{initialScrollOffset:e}=this.props;"number"==typeof e&&null!==this._outerRef&&(this._outerRef.scrollTop=e),this._commitHook()}getSnapshotBeforeUpdate(e,t){if(t.localOlderPostsToRender[0]!==this.state.localOlderPostsToRender[0]||t.localOlderPostsToRender[1]!==this.state.localOlderPostsToRender[1]){const e=this._outerRef;return{previousScrollTop:e.scrollTop,previousScrollHeight:e.scrollHeight}}return null}componentDidUpdate(e,t,n){if(this.state.scrolledToInitIndex){const{scrollDirection:e,scrollOffset:n,scrollUpdateWasRequested:a,scrollHeight:s}=this.state,{scrollDirection:r,scrollOffset:i,scrollUpdateWasRequested:o,scrollHeight:l}=t;e===r&&n===i&&a===o&&s===l||this._callPropsCallbacks(),t.scrolledToInitIndex||(this._keepScrollPosition=!1,this._keepScrollToBottom=!1)}if(this._commitHook(),e.itemData!==this.props.itemData&&this._dataChange(),e.height!==this.props.height&&this._heightChange(e.height,t.scrollOffset),t.scrolledToInitIndex!==this.state.scrolledToInitIndex&&this._dataChange(),e.width!==this.props.width&&(this.innerRefWidth=this.props.innerRef.current.clientWidth,this._widthChange(e.height,t.scrollOffset)),t.localOlderPostsToRender[0]!==this.state.localOlderPostsToRender[0]||t.localOlderPostsToRender[1]!==this.state.localOlderPostsToRender[1]){const e=this._outerRef.scrollHeight,t=n.previousScrollTop+(e-n.previousScrollHeight);this.scrollTo(t,t-n.previousScrollTop,!0)}}componentWillUnmount(){this._scrollByCorrection&&window.cancelAnimationFrame(this._scrollByCorrection)}_callPropsCallbacks(){const{itemData:e,height:t}=this.props,{scrollDirection:n,scrollOffset:a,scrollUpdateWasRequested:s,scrollHeight:r}=this.state,i=e.length;if("function"==typeof this.props.onItemsRendered&&i>0){const[e,t,s,r]=this._getRangeToRender();this._callOnItemsRendered(e,t,s,r),"backward"===n&&a<1e3&&t!==i-1&&!Be(this.props,t+1,this._listMetaData).size&&this.state.scrolledToInitIndex&&this.setState((e=>e.localOlderPostsToRender[0]!==t+1?{localOlderPostsToRender:[t+1,t+50]}:null))}"function"==typeof this.props.onScroll&&this._callOnScroll(n,a,s,r,t)}_getRangeToRender(e){const{itemData:t,overscanCountForward:n,overscanCountBackward:a}=this.props,{scrollDirection:s,scrollOffset:r}=this.state,i=t.length;if(0===i)return[0,0,0,0];const o=e>=0?e:r,l=Fe(this.props,o,this._listMetaData),c=Ue(this.props,l,o,this._listMetaData),d="backward"===s?a:Math.max(1,n),u="forward"===s?a:Math.max(1,n),m=Math.max(0,c-d);let h=Math.max(0,Math.min(i-1,l+u));for(;!Be(this.props,h,this._listMetaData)&&h>0&&this._listMetaData.totalMeasuredSize>this.props.height;)h--;return!this.state.scrolledToInitIndex&&this.props.initRangeToRender.length?this.props.initRangeToRender:[m,h,l,c]}render(){const{className:e,id:t,innerRef:n,innerTagName:a,outerTagName:s,style:r,innerListStyle:i}=this.props,o=this._onScrollVertical,l=this._renderItems();return(0,P.createElement)(s,{className:e,id:t,onScroll:o,ref:this._outerRefSetter,style:Pe({WebkitOverflowScrolling:"touch",overflowY:"auto",overflowAnchor:"none",willChange:"transform",width:"100%"},r)},(0,P.createElement)(a,{ref:n,role:"list",style:i},l))}}Le(Oe,"defaultProps",{innerTagName:"div",itemData:void 0,outerTagName:"div",overscanCountForward:30,overscanCountBackward:10});const ke=(e,t,n)=>{const{itemOffsetMap:a,itemSizeMap:s}=n,{itemData:r}=e;return s[r[t]]?{offset:a[r[t]]||0,size:s[r[t]]||0}:{offset:0,size:0}},De=(e,t,n)=>ke(e,t,n).offset,xe=(e,t,n,a,s)=>{const{height:r}=e,i=ke(e,t,s),o=s.totalMeasuredSize,l=Math.max(0,i.offset+i.size-r),c=Math.max(0,i.offset);switch(n){case"start":return c;case"end":return l;case"center":return Math.round(c-r/2+i.size/2);default:return a>=c&&a<=l?o-(a+r):a-c<l-a?c:l}},Fe=(e,t,n)=>{const{totalMeasuredSize:a}=n,{itemData:s}=e;return t<=a?((e,t,n,a,s)=>{let r=a;for(;a<=n;)s-ke(e,a,t).offset<=0&&(r=a),a++;return r})(e,n,s.length,0,t):0},Ue=(e,t,n,a)=>{const{itemData:s}=e;let r=t;const i=n+e.height,o=ke(e,r,a);let l=o.offset+(o.size||0);for(;r>0&&l<=i;){const t=ke(e,r,a);l=t.offset+t.size,r--}return r>=s.length?0:r},Be=(e,t,n)=>ke(e,t,n).size;var He=n(99255),qe=n(45955),je=n(92269),Ve=n(87778),ze=n(69410),Ge=n(85406),We=n(11039),Ke=n(27191),Ye=n(19408),Je=n(61436);function Qe(e){var t;const n=(0,le.useIntl)(),s=(0,Ye.A)(),r=(0,Y.qc)((0,a.useSelector)(l.HW).roles),[i,c]=(0,We.A)(),d=(0,a.useSelector)(o.H7),u=(0,a.useSelector)((t=>(0,he.Bz)(t,e.channelId||"")))||function(e){return void 0===e?0:e+864e5}(e.firstInaccessiblePostTime),[m,h,p]=(0,Je.o)({ctaText:n.formatMessage({id:"workspace_limits.message_history.locked.cta.end_user",defaultMessage:"Notify Admin"})},{required_feature:W.W0.UNLIMITED_MESSAGES,required_plan:W.gS.Professional,trial_notification:!1});if(!c)return null;const g={month:"long",day:"numeric"};Date.now()-u>=31536e6&&(g.year="numeric");const f={date:n.formatDate(u,g),team:null==d?void 0:d.display_name},b=n.formatNumber((null==i||null===(t=i.messages)||void 0===t?void 0:t.history)||0);let E=n.formatMessage({id:"workspace_limits.message_history.locked.title.end_user",defaultMessage:"Notify your admin to unlock messages prior to {date} in {team}"},f),v=n.formatMessage({id:"workspace_limits.message_history.locked.description.end_user",defaultMessage:"Some older messages may not be shown because your workspace has over {limit} messages. Select Notify Admin to send an automatic request to your System Admins to upgrade."},{limit:b}),C=L().createElement("button",{className:"btn btn-primary",onClick:e=>h(e,"center_channel_posts_over_limit_banner"),disabled:p===Ke.Q.AlreadyComplete},m);return r&&(E=n.formatMessage({id:"workspace_limits.message_history.locked.title.admin",defaultMessage:"Unlock messages prior to {date} in {team}"},f),v=n.formatMessage({id:"workspace_limits.message_history.locked.description.admin",defaultMessage:"To view and search all of the messages in your workspaceâ€™s history, rather than just the most recent {limit} messages, upgrade to one of our paid plans. <a>Review our plan options and pricing.</a>"},{limit:b,a:e=>L().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),s({trackingLocation:"center_channel_posts_over_limit_banner"})}},e)}),C=L().createElement("button",{className:"btn is-admin",onClick:()=>s({trackingLocation:"center_channel_posts_over_limit_banner"})},n.formatMessage({id:"workspace_limits.message_history.locked.cta.admin",defaultMessage:"Upgrade now"}))),L().createElement("div",{className:"CenterMessageLock"},L().createElement("div",{className:"CenterMessageLock__left"},L().createElement(Ge.EyeOffOutlineIcon,{color:"rgba(var(--center-channel-color-rgb), 0.75)"})),L().createElement("div",{className:"CenterMessageLock__right"},L().createElement("div",{className:"CenterMessageLock__title"},E),L().createElement("div",{className:"CenterMessageLock__description"},v),L().createElement("div",{className:"CenterMessageLock__cta"},C)))}Qe.propTypes={channelId:F().string,firstInaccessiblePostTime:F().number};var Ze=n(55092),Xe=n(69657),$e=n(62351),et=n(16230),tt=n(69669),nt=n(64109);const at=e=>{var t,n;return P.createElement("svg",Object.assign({width:null!==(t=e.width)&&void 0!==t?t:"130",height:null!==(n=e.height)&&void 0!==n?n:"102",viewBox:"0 0 130 102",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e),P.createElement("g",{clipPath:"url(#clip0_4212_90419)"},P.createElement("path",{d:"M2.50001 16L2.5 31L127.5 31L127.5 75L66 75",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),P.createElement("path",{d:"M2.5 69L2.5 42L29 42",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),P.createElement("path",{d:"M18.5 70.5L18.5 56.5L106 56.5",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 16)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 74)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 16 74)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"71",cy:"59",r:"43",fill:"var(--center-channel-color)",fillOpacity:"0.12"}),P.createElement("path",{d:"M110.748 91.5258L119 100V56C119 54.8954 118.105 54 117 54H76.0005C74.8959 54 74.0005 54.8954 74.0005 56V88.9211C74.0005 90.0256 74.8959 90.9211 76.0005 90.9211H109.316C109.855 90.9211 110.372 91.1391 110.748 91.5258Z",fill:"#28427B"}),P.createElement("circle",{opacity:"0.48",cx:"86.831",cy:"65.831",r:"5.83099",fill:"var(--button-color)"}),P.createElement("path",{opacity:"0.4",d:"M96 64H112",stroke:"var(--button-color-rgb)",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M82 79H103.38",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M82 83H96.2535",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M96 68H110",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M82 75H93.0141",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M95.6064 75H107.268",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{d:"M28.605 67.5638L15 81V12C15 10.8954 15.8954 10 17 10H83C84.1046 10 85 10.8954 85 12V64.9868C85 66.0914 84.1046 66.9868 83 66.9868H30.0103C29.4842 66.9868 28.9793 67.1941 28.605 67.5638Z",fill:"var(--center-channel-bg)"}),P.createElement("path",{d:"M28.2536 67.2081L15.5 79.8035V12C15.5 11.1716 16.1716 10.5 17 10.5H83C83.8284 10.5 84.5 11.1716 84.5 12V64.9868C84.5 65.8153 83.8284 66.4868 83 66.4868H30.0103C29.3527 66.4868 28.7215 66.746 28.2536 67.2081Z",stroke:"var(--center-channel-color)",strokeOpacity:"0.8"}),P.createElement("circle",{cx:"33",cy:"29",r:"9",fill:"var(--center-channel-color)",fillOpacity:"0.4"}),P.createElement("path",{d:"M48 25H64",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 49H62",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 55H47",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M48 31H73",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 43H42",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M46 43H64",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("circle",{cx:"78",cy:"19",r:"19",fill:"#32539A"}),P.createElement("path",{d:"M98 49L80 49",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("path",{d:"M76 49L70 49",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("path",{d:"M67 49L65 49",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("circle",{cx:"44",cy:"75",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"52",cy:"75",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"60",cy:"75",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("rect",{x:"70.5",y:"15.5",width:"15",height:"12",rx:"1.5",stroke:"var(--button-color)"}),P.createElement("path",{d:"M73 16V13C73 10.2386 75.2386 8 78 8V8C80.7614 8 83 10.2386 83 13V16",stroke:"var(--button-color)"})),P.createElement("defs",null,P.createElement("clipPath",{id:"clip0_4212_90419"},P.createElement("rect",{width:"130",height:"102",fill:"white"}))))};at.propTypes={width:F().number,height:F().number};const st=at,rt=e=>{var t,n;return L().createElement("svg",{width:null!==(t=e.width)&&void 0!==t?t:"130",height:null!==(n=e.height)&&void 0!==n?n:"102",viewBox:"0 0 130 102",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},L().createElement("g",{clipPath:"url(#clip0_4212_90121)"},L().createElement("path",{d:"M2.50001 16L2.5 31L127.5 31L127.5 75L66 75",stroke:"rgba(var(--center-channel-color-rgb), 0.32)",strokeLinecap:"round"}),L().createElement("path",{d:"M2.5 69L2.5 42L29 42",stroke:"rgba(var(--center-channel-color-rgb), 0.32)",strokeLinecap:"round"}),L().createElement("path",{d:"M18.5 70.5L18.5 56.5L106 56.5",stroke:"rgba(var(--center-channel-color-rgb), 0.32)",strokeLinecap:"round"}),L().createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 16)",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),L().createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 74)",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),L().createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 16 74)",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),L().createElement("circle",{cx:"71",cy:"59",r:"43",fill:"rgba(var(--center-channel-color-rgb), 0.12)"}),L().createElement("path",{d:"M110.748 91.5258L119 100V56C119 54.8954 118.105 54 117 54H76.0005C74.8959 54 74.0005 54.8954 74.0005 56V88.9211C74.0005 90.0256 74.8959 90.9211 76.0005 90.9211H109.316C109.855 90.9211 110.372 91.1391 110.748 91.5258Z",fill:"#28427B"}),L().createElement("circle",{opacity:"0.48",cx:"86.831",cy:"65.831",r:"5.83099",fill:"var(--button-color)"}),L().createElement("path",{opacity:"0.4",d:"M96 64H112",stroke:"var(--button-color-rgb)",strokeLinecap:"round"}),L().createElement("path",{opacity:"0.4",d:"M82 79H103.38",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),L().createElement("path",{opacity:"0.4",d:"M82 83H96.2535",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),L().createElement("path",{opacity:"0.4",d:"M96 68H110",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),L().createElement("path",{opacity:"0.4",d:"M82 75H93.0141",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),L().createElement("path",{opacity:"0.4",d:"M95.6064 75H107.268",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),L().createElement("path",{d:"M28.605 67.5638L15 81V12C15 10.8954 15.8954 10 17 10H83C84.1046 10 85 10.8954 85 12V64.9868C85 66.0914 84.1046 66.9868 83 66.9868H30.0103C29.4842 66.9868 28.9793 67.1941 28.605 67.5638Z",fill:"rgba(var(--center-channel-bg-rgb))"}),L().createElement("path",{d:"M28.2536 67.2081L15.5 79.8035V12C15.5 11.1716 16.1716 10.5 17 10.5H83C83.8284 10.5 84.5 11.1716 84.5 12V64.9868C84.5 65.8153 83.8284 66.4868 83 66.4868H30.0103C29.3527 66.4868 28.7215 66.746 28.2536 67.2081Z",stroke:"rgba(var(--center-channel-color-rgb), 0.8)"}),L().createElement("circle",{cx:"33",cy:"29",r:"9",fill:"rgba(var(--center-channel-color-rgb), 0.4)"}),L().createElement("path",{d:"M48 25H64",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),L().createElement("path",{d:"M25 49H62",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),L().createElement("path",{d:"M25 55H47",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),L().createElement("path",{d:"M48 31H73",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),L().createElement("path",{d:"M25 43H42",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),L().createElement("path",{d:"M46 43H64",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),L().createElement("circle",{cx:"78",cy:"19",r:"19",fill:"#32539A"}),L().createElement("path",{d:"M98 49L80 49",stroke:"rgba(var(--center-channel-color-rgb), 0.8)",strokeLinecap:"round",strokeLinejoin:"round"}),L().createElement("path",{d:"M76 49L70 49",stroke:"rgba(var(--center-channel-color-rgb), 0.8)",strokeLinecap:"round",strokeLinejoin:"round"}),L().createElement("path",{d:"M67 49L65 49",stroke:"rgba(var(--center-channel-color-rgb), 0.8)",strokeLinecap:"round",strokeLinejoin:"round"}),L().createElement("circle",{cx:"44",cy:"75",r:"2",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),L().createElement("circle",{cx:"52",cy:"75",r:"2",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),L().createElement("circle",{cx:"60",cy:"75",r:"2",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),L().createElement("circle",{cx:"78",cy:"19",r:"9.5",stroke:"rgba(var(--button-color-rgb))"}),L().createElement("path",{d:"M87.5 20.2525C86.1859 21.8482 82.4292 23 78 23C73.5708 23 69.8141 21.8482 68.5 20.2525",stroke:"rgba(var(--button-color-rgb))"}),L().createElement("path",{d:"M86.6622 15C84.9331 16.1956 81.7014 17 78 17C74.2986 17 71.0669 16.1956 69.3378 15",stroke:"rgba(var(--button-color-rgb))"}),L().createElement("path",{d:"M81.5 19C81.5 21.7141 81.059 24.1482 80.3642 25.8854C80.0162 26.7553 79.6144 27.4258 79.1937 27.8706C78.7741 28.3143 78.3705 28.5 78 28.5C77.6295 28.5 77.2259 28.3143 76.8063 27.8706C76.3856 27.4258 75.9838 26.7553 75.6358 25.8854C74.941 24.1482 74.5 21.7141 74.5 19C74.5 16.2859 74.941 13.8518 75.6358 12.1146C75.9838 11.2447 76.3856 10.5742 76.8063 10.1294C77.2259 9.6857 77.6295 9.5 78 9.5C78.3705 9.5 78.7741 9.6857 79.1937 10.1294C79.6144 10.5742 80.0162 11.2447 80.3642 12.1146C81.059 13.8518 81.5 16.2859 81.5 19Z",stroke:"rgba(var(--button-color-rgb))"})),L().createElement("defs",null,L().createElement("clipPath",{id:"clip0_4212_90121"},L().createElement("rect",{width:"130",height:"102",fill:"rgba(var(--center-channel-bg-rgb))"}))))};rt.propTypes={width:F().number,height:F().number};const it=rt,ot=e=>{var t,n;return P.createElement("svg",Object.assign({width:null!==(t=e.width)&&void 0!==t?t:"130",height:null!==(n=e.height)&&void 0!==n?n:"92",viewBox:"0 0 130 92",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e),P.createElement("g",{clipPath:"url(#clip0_4210_88396)"},P.createElement("path",{d:"M2.50001 6.00001L2.5 21L127.5 21L127.5 65L66 65",stroke:"var(--center-channel-color)",strokeOpacity:"0.24",strokeLinecap:"round"}),P.createElement("path",{d:"M2.49999 59L2.49999 32L29 32",stroke:"var(--center-channel-color)",strokeOpacity:"0.24",strokeLinecap:"round"}),P.createElement("path",{d:"M18.5 60.5L18.5 46.5L106 46.5",stroke:"var(--center-channel-color)",strokeOpacity:"0.24",strokeLinecap:"round"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 6)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 64)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 16 64)",fill:"var(--center-channel-color)",fillOpacity:"0.4"}),P.createElement("circle",{cx:"71",cy:"49",r:"43",fill:"var(--center-channel-color)",fillOpacity:"0.12"}),P.createElement("path",{d:"M109.748 82.5258L117.999 91V47C117.999 45.8954 117.104 45 115.999 45H74.9998C73.8952 45 72.9998 45.8954 72.9998 47V79.9211C72.9998 81.0256 73.8952 81.9211 74.9998 81.9211H108.315C108.855 81.9211 109.371 82.1391 109.748 82.5258Z",fill:"#28427B"}),P.createElement("circle",{opacity:"0.48",cx:"85.8309",cy:"56.831",r:"5.83099",fill:"#FFFFFF"}),P.createElement("path",{opacity:"0.4",d:"M94.9999 55H111",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M80.9999 70H102.38",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M80.9999 74H95.2535",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M94.9999 59H109",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M80.9999 66H92.014",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M94.6064 66H106.268",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{d:"M28.605 57.5638L15 71V2C15 0.895431 15.8954 0 17 0H83C84.1046 0 85 0.89543 85 2V54.9868C85 56.0914 84.1046 56.9868 83 56.9868H30.0103C29.4842 56.9868 28.9793 57.1941 28.605 57.5638Z",fill:"var(--center-channel-bg)"}),P.createElement("path",{d:"M28.2536 57.2081L15.5 69.8035V2C15.5 1.17157 16.1716 0.5 17 0.5H83C83.8284 0.5 84.5 1.17157 84.5 2V54.9868C84.5 55.8153 83.8284 56.4868 83 56.4868H30.0103C29.3527 56.4868 28.7215 56.746 28.2536 57.2081Z",stroke:"var(--center-channel-color)",strokeOpacity:"0.8"}),P.createElement("circle",{cx:"33",cy:"19",r:"9",fill:"var(--center-channel-color)",fillOpacity:"0.4"}),P.createElement("path",{d:"M48 15H64",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 39H69",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 45H47",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M48 21H73",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 33H42",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M46 33H64",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("circle",{cx:"44",cy:"65",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"52",cy:"65",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"60",cy:"65",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("path",{d:"M101 33L83 33",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("path",{d:"M79 33L73 33",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("path",{d:"M70 33L68 33",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"})),P.createElement("defs",null,P.createElement("clipPath",{id:"clip0_4210_88396"},P.createElement("rect",{width:"130",height:"92",fill:"white"}))))};ot.propTypes={width:F().number,height:F().number};const lt=ot;var ct=n(64182),dt=n(57486),ut=n(26808),mt=n(61767),ht=n(12762),pt=n(72180),gt=n(45036),ft=n(40142),bt=n(46),Et=n(49888),vt=n(53654);const Ct=e=>{let{totalUsers:t,usersLimit:n,channel:s,pluginButtons:r}=e;const i=(0,a.useSelector)(o.Sy);if(!t)return L().createElement(vt.A,null);const l=t<n;return L().createElement(ut.A,{teamId:i,permissions:[me.xB.ADD_USER_TO_TEAM,me.xB.INVITE_GUEST]},l?L().createElement(_t,{pluginButtons:r}):L().createElement(yt,{channel:s,pluginButtons:r}))};Ct.propTypes={totalUsers:F().number,usersLimit:F().number.isRequired,pluginButtons:F().node};const _t=e=>{let{pluginButtons:t}=e;const{formatMessage:n}=(0,le.useIntl)();return L().createElement(L().Fragment,null,t,L().createElement("div",{className:"LessThanMaxFreeUsers"},L().createElement(ht.A,{id:"introTextInvite",className:"btn btn-sm btn-primary",modalId:W.IQ.INVITATION,dialogType:Et.default,onClick:()=>(0,be.sx)("channel_intro_message","click_invite_button"),dialogProps:{focusOriginElement:"browseOrAddChannelMenuButton"}},L().createElement("i",{className:"icon-email-plus-outline",title:n({id:"generic_icons.add",defaultMessage:"Add Icon"}),"aria-hidden":"true"}),L().createElement(le.FormattedMessage,{id:"intro_messages.inviteOthersToWorkspace.button",defaultMessage:"Invite others to the workspace"}))))},yt=e=>{let{channel:t,pluginButtons:n}=e;const{formatMessage:a}=(0,le.useIntl)(),s=t.group_constrained?W.IQ.ADD_GROUPS_TO_CHANNEL:W.IQ.CHANNEL_INVITE,r=t.group_constrained?ft.A:bt.A;if(0!==t.delete_at)return null;const i=t.type===W.YM.PRIVATE_CHANNEL;return L().createElement("div",{className:"MoreThanMaxFreeUsersWrapper"},L().createElement("div",{className:"MoreThanMaxFreeUsers"},L().createElement(dt.A,{channelId:t.id,teamId:t.team_id,permissions:[i?me.xB.MANAGE_PRIVATE_CHANNEL_MEMBERS:me.xB.MANAGE_PUBLIC_CHANNEL_MEMBERS]},L().createElement(ht.A,{className:"action-button",modalId:s,dialogType:r,dialogProps:{channel:t}},L().createElement("i",{className:"icon-account-plus-outline",title:a({id:"generic_icons.add",defaultMessage:"Add Icon"}),"aria-hidden":"true"}),t.group_constrained&&L().createElement(le.FormattedMessage,{id:"intro_messages.inviteGropusToChannel.button",defaultMessage:"Add groups"}),!t.group_constrained&&L().createElement(le.FormattedMessage,{id:"intro_messages.inviteMembersToChannel.button",defaultMessage:"Add people"})))),n)},Mt=L().memo(Ct);var Tt=n(21650);const St=L().memo((e=>{let{channel:t,pluginButtons:n,channelMember:a}=e;if(0!==t.delete_at||0===n.length||!a)return null;const s=n.map((e=>L().createElement("button",{key:e.id,className:"action-button",onClick:()=>{var n;return null===(n=e.action)||void 0===n?void 0:n.call(e,t,a)}},e.icon,e.text)));return L().createElement(L().Fragment,null,s)}));St.propTypes={pluginButtons:F().array.isRequired},St.displayName="PluggableIntroButtons";const wt=St,It=(0,a.connect)((function(e,t){return{channelMember:(0,r.M9)(e,t.channel.id),pluginButtons:(0,Tt.qm)(e)}}))(wt);function At(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Nt extends L().PureComponent{constructor(){super(...arguments),At(this,"toggleFavorite",(()=>{this.props.channel&&(this.props.isFavorite?this.props.actions.unfavoriteChannel(this.props.channel.id):this.props.actions.favoriteChannel(this.props.channel.id))}))}componentDidMount(){var e;null!==(e=this.props.stats)&&void 0!==e&&e.total_users_count||this.props.actions.getTotalUsersStats()}render(){const{currentUserId:e,channel:t,fullWidth:n,locale:a,channelProfiles:s,enableUserCreation:r,isReadOnly:i,isFavorite:o,teamIsGroupConstrained:l,creatorName:c,teammate:d,teammateName:u,currentUser:m,stats:h,usersLimit:p,channelMember:g,isMobileView:f}=this.props;let b="";return n||(b="channel-intro--centered"),t?t.type===W.YM.DM_CHANNEL?function(e,t,n,a,s,r,i,o){const l="channelIntro";if(i){const n=i?X.RG(i.id,i.last_picture_update):"";let s=null,c=null;null!=i&&i.is_bot||(s=L().createElement(It,{channel:e}),c=Lt(e));const d=L().createElement("div",{className:"channel-intro__actions"},Ot(a,r),c,s);return L().createElement("div",{id:l,className:"channel-intro "+t},L().createElement("div",{className:"post-profile-img__container channel-intro-img"},L().createElement(mt.A,{src:n,size:"xl-custom-DM",status:i.is_bot?"":e.status,userId:null==i?void 0:i.id,username:null==i?void 0:i.username})),L().createElement("h2",{className:"channel-intro__title"},L().createElement(pt.A,{userId:null==i?void 0:i.id})),L().createElement("p",{className:"channel-intro__text"},L().createElement(le.FormattedMessage,{id:"intro_messages.DM",defaultMessage:"This is the start of your direct message history with {teammate}. Messages and files shared here are not shown to anyone else.",values:{teammate:o}})),d)}return L().createElement("div",{id:l,className:"channel-intro "+t},L().createElement("p",{className:"channel-intro__text"},L().createElement(le.FormattedMessage,{id:"intro_messages.teammate",defaultMessage:"This is the start of your direct message history with this teammate. Messages and files shared here are not shown to anyone else."})))}(t,b,0,o,0,this.toggleFavorite,d,u):t.type===W.YM.GM_CHANNEL?function(e,t,n,a,s,r,i,o,l){const c="channelIntro";if(r.length>0){const d=r.find((e=>e.id===i)),u=r.filter((e=>e.id!==i)).map((e=>L().createElement(mt.A,{key:"introprofilepicture"+e.id,src:X.RG(e.id,e.last_picture_update),size:"xl-custom-GM",userId:e.id,username:e.username}))),m=L().createElement("div",{className:"channel-intro__actions"},Ot(n,s),Lt(e),!a&&kt(e,o),L().createElement(It,{channel:e}));return L().createElement("div",{id:c,className:"channel-intro "+t},L().createElement("div",{className:"post-profile-img__container channel-intro-img channel-intro-img__group"},u),L().createElement("h2",{className:"channel-intro__title"},e.display_name),L().createElement("p",{className:"channel-intro__text"},L().createElement(le.FormattedMessage,{id:"intro_messages.group_message",defaultMessage:"This is the start of your group message history with these teammates. "}),Pt(d,l)),m)}return L().createElement("div",{id:c,className:"channel-intro "+t},L().createElement("p",{className:"channel-intro__text"},L().createElement(le.FormattedMessage,{id:"intro_messages.group_message",defaultMessage:"This is the start of your group message history with these teammates. Messages and files shared here are not shown to people outside this area."})))}(t,b,o,f,this.toggleFavorite,s,e,m,g):t.name===W.YM.DEFAULT_CHANNEL?function(e,t,n,a,s,r,i,o,l,c,d){let u=null;const m=i.total_users_count,h=e.type===W.YM.PRIVATE_CHANNEL,p=m<o;let g=null,f=null,b=null;if(!c){f=L().createElement(It,{channel:e});const t=Lt(e);t&&(g=L().createElement(dt.A,{teamId:e.team_id,channelId:e.id,permissions:[h?me.xB.MANAGE_PRIVATE_CHANNEL_PROPERTIES:me.xB.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},t))}return!c&&l&&(u=L().createElement(ut.A,{teamId:e.team_id,permissions:[me.xB.INVITE_USER]},L().createElement(ut.A,{teamId:e.team_id,permissions:[me.xB.ADD_USER_TO_TEAM]},!d&&L().createElement(Mt,{totalUsers:m,usersLimit:o,channel:e,pluginButtons:f}),d&&L().createElement(ht.A,{className:"intro-links color--link",modalId:W.IQ.ADD_GROUPS_TO_TEAM,dialogType:tt.A,dialogProps:{channel:e}},L().createElement("i",{className:"fa fa-user-plus"}),L().createElement(le.FormattedMessage,{id:"intro_messages.addGroupsToTeam",defaultMessage:"Add other groups to this team"}))))),b=p?L().createElement("div",{className:"channel-intro__actions"},b=u):L().createElement("div",{className:"channel-intro__actions"},Ot(a,r),g,kt(e,n),d&&f),L().createElement("div",{id:"channelIntro",className:"channel-intro "+t},L().createElement(lt,null),L().createElement("h2",{className:"channel-intro__title"},e.display_name),L().createElement("p",{className:"channel-intro__text"},!c&&L().createElement(le.FormattedMessage,{id:"intro_messages.default",defaultMessage:"Welcome to {display_name}. Post messages here that you want everyone to see. Everyone automatically becomes a member of this channel when they join the team.",values:{display_name:e.display_name}}),c&&L().createElement(le.FormattedMessage,{id:"intro_messages.readonly.default",defaultMessage:"Welcome to {display_name}. Messages can only be posted by admins. Everyone automatically becomes a permanent member of this channel when they join the team.",values:{display_name:e.display_name}})),b)}(t,b,m,o,0,this.toggleFavorite,h,p,r,i,l):t.name===W.YM.OFFTOPIC_CHANNEL?function(e,t,n,a,s,r,i,o){const l=e.type===W.YM.PRIVATE_CHANNEL,c=Lt(e),d=i.total_users_count,u=d<o;let m=null,h=null;c&&(m=L().createElement(dt.A,{teamId:e.team_id,channelId:e.id,permissions:[l?me.xB.MANAGE_PRIVATE_CHANNEL_PROPERTIES:me.xB.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},c));const p=L().createElement(Mt,{totalUsers:d,usersLimit:o,channel:e,pluginButtons:L().createElement(It,{channel:e})});return h=u?L().createElement("div",{className:"channel-intro__actions"},h=p):L().createElement("div",{className:"channel-intro__actions"},Ot(n,r),m,kt(e,s)),L().createElement("div",{id:"channelIntro",className:"channel-intro "+t},L().createElement(it,null),L().createElement("h2",{className:"channel-intro__title"},e.display_name),L().createElement("p",{className:"channel-intro__text"},L().createElement(le.FormattedMessage,{id:"intro_messages.offTopic",defaultMessage:"This is the start of {display_name}, a channel for non-work-related conversations.",values:{display_name:e.display_name}})),h)}(t,b,o,0,m,this.toggleFavorite,h,p):t.type===W.YM.OPEN_CHANNEL||t.type===W.YM.PRIVATE_CHANNEL?function(e,t,n,a,s,r,i,o,l,c){const d=e.display_name;let u,m=null;const h=0!==e.delete_at,p=i.total_users_count,g=p<o;u=h?"":e.type===W.YM.PRIVATE_CHANNEL?L().createElement(le.FormattedMessage,{id:"intro_messages.onlyInvited",defaultMessage:"This is the start of {display_name}. Only invited members can see this private channel.",values:{display_name:e.display_name}}):L().createElement(le.FormattedMessage,{id:"intro_messages.anyMember",defaultMessage:"This is the start of {display_name}. Any team member can join and read this channel.",values:{display_name:e.display_name}});const f=L().createElement(le.FormattedDate,{value:e.create_at,month:(0,gt.FS)(l),day:"2-digit",year:"numeric"});let b,E;""===c?e.type===W.YM.PRIVATE_CHANNEL?b=L().createElement(le.FormattedMessage,{id:"intro_messages.noCreatorPrivate",defaultMessage:"Private channel created on {date}.",values:{name:d,date:f}}):e.type===W.YM.OPEN_CHANNEL&&(b=L().createElement(le.FormattedMessage,{id:"intro_messages.noCreator",defaultMessage:"Public channel created on {date}.",values:{name:d,date:f}})):e.type===W.YM.PRIVATE_CHANNEL?b=L().createElement("span",null,L().createElement(le.FormattedMessage,{id:"intro_messages.creatorPrivate",defaultMessage:"Private channel created by {creator} on {date}.",values:{name:d,creator:c,date:f}})):e.type===W.YM.OPEN_CHANNEL&&(b=L().createElement("span",null,L().createElement(le.FormattedMessage,{id:"intro_messages.creator",defaultMessage:"Public channel created by {creator} on {date}.",values:{name:d,creator:c,date:f}}))),e.purpose&&""!==e.purpose&&(E=L().createElement("span",null,L().createElement(le.FormattedMessage,{id:"intro_messages.purpose",defaultMessage:" This channel's purpose is: {purpose}",values:{purpose:e.purpose}})));const v=e.type===W.YM.PRIVATE_CHANNEL;let C=null,_=null;const y=Lt(e);return y&&(C=L().createElement(dt.A,{teamId:e.team_id,channelId:e.id,permissions:[v?me.xB.MANAGE_PRIVATE_CHANNEL_PROPERTIES:me.xB.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},y)),m=L().createElement(Mt,{totalUsers:p,usersLimit:o,channel:e,pluginButtons:L().createElement(It,{channel:e})}),_=g?L().createElement("div",{className:"channel-intro__actions"},_=m):L().createElement("div",{className:"channel-intro__actions"},Ot(a,r),m,C,!s&&kt(e,n),L().createElement(It,{channel:e})),L().createElement("div",{id:"channelIntro",className:"channel-intro "+t},v?L().createElement(st,null):L().createElement(it,null),L().createElement("h2",{className:"channel-intro__title"},e.display_name),L().createElement("div",{className:"channel-intro__created"},v?L().createElement(Ge.LockOutlineIcon,{size:14}):L().createElement(Ge.GlobeIcon,{size:14}),b),L().createElement("p",{className:"channel-intro__text"},u,E),_)}(t,b,m,o,f,this.toggleFavorite,h,p,a,c):null:null}}At(Nt,"propTypes",{currentUserId:F().string.isRequired,fullWidth:F().bool.isRequired,locale:F().string.isRequired,channelProfiles:F().array.isRequired,enableUserCreation:F().bool,isReadOnly:F().bool,isFavorite:F().bool.isRequired,teamIsGroupConstrained:F().bool,creatorName:F().string.isRequired,teammateName:F().string,stats:F().any.isRequired,usersLimit:F().number.isRequired,isMobileView:F().bool.isRequired,actions:F().shape({getTotalUsersStats:F().func.isRequired,favoriteChannel:F().func.isRequired,unfavoriteChannel:F().func.isRequired}).isRequired});const Rt=(0,le.defineMessages)({muted:{id:"intro_messages.GM.muted",defaultMessage:"This group message is currently <b>muted</b>, so you will not be notified."},[$e.S.ALL]:{id:"intro_messages.GM.all",defaultMessage:"You'll be notified <b>for all activity</b> in this group message."},[$e.S.DEFAULT]:{id:"intro_messages.GM.all",defaultMessage:"You'll be notified <b>for all activity</b> in this group message."},[$e.S.MENTION]:{id:"intro_messages.GM.mention",defaultMessage:"You have selected to be notified <b>only when mentioned</b> in this group message."},[$e.S.NONE]:{id:"intro_messages.GM.none",defaultMessage:"You have selected to <b>never</b> be notified in this group message."}}),Pt=(e,t)=>{var n,a;if((0,et.X4)(t))return L().createElement(le.FormattedMessage,Object.assign({},Rt.muted,{values:{b:e=>L().createElement("b",null,e)}}));const s=(null==t||null===(n=t.notify_props)||void 0===n?void 0:n.desktop)||$e.S.DEFAULT,r=(null==e||null===(a=e.notify_props)||void 0===a?void 0:a.desktop)||$e.S.MENTION;let i=s;return i===$e.S.DEFAULT&&(i=r),s===$e.S.DEFAULT&&r===$e.S.MENTION&&(i=$e.S.ALL),L().createElement(le.FormattedMessage,Object.assign({},Rt[i],{values:{b:e=>L().createElement("b",null,e)}}))};function Lt(e){return 0!==e.delete_at?null:L().createElement(ht.A,{modalId:W.IQ.EDIT_CHANNEL_HEADER,ariaLabel:X.Vw({id:"intro_messages.setHeader",defaultMessage:"Set header"}),className:"action-button",dialogType:ct.A,dialogProps:{channel:e}},L().createElement(Ge.PencilOutlineIcon,{size:24}),L().createElement(le.FormattedMessage,{id:"intro_messages.setHeader",defaultMessage:"Set header"}))}function Ot(e,t,n){let a;return a=e?L().createElement(le.FormattedMessage,{id:"channel_info_rhs.top_buttons.favorited",defaultMessage:"Favorited"}):L().createElement(le.FormattedMessage,{id:"channel_info_rhs.top_buttons.favorite",defaultMessage:"Favorite"}),L().createElement("button",{id:"toggleFavoriteIntroButton",className:"action-button ".concat(e?"active":"","  ").concat(n),onClick:t,"aria-label":"Favorite"},e?L().createElement(Ge.StarIcon,{size:24}):L().createElement(Ge.StarOutlineIcon,{size:24}),a)}function kt(e,t){return L().createElement(ht.A,{id:"channelIntroNotificationPreferencesButton",modalId:W.IQ.CHANNEL_NOTIFICATIONS,ariaLabel:X.Vw({id:"intro_messages.notificationPreferences",defaultMessage:"Notification Preferences"}),className:"action-button",dialogType:nt.A,dialogProps:{channel:e,currentUser:t,focusOriginElement:"channelIntroNotificationPreferencesButton"}},L().createElement(Ge.BellRingOutlineIcon,{size:24}),L().createElement(le.FormattedMessage,{id:"intro_messages.notificationPreferences",defaultMessage:"Notifications"}))}const Dt=(0,a.connect)((function(e){const t="true"===(0,i.zj)(e).EnableUserCreation,n=(0,o.H7)(e),a=(0,r.Lw)(e),s=(0,r.tW)(e),c=a?(0,r.yH)(e,a.id):void 0,d=(0,l.HW)(e),u=a?(0,l.wz)(e,a.creator_id):void 0,m=(0,l.ig)(e)||{total_users_count:0};return{currentUserId:(0,l.WR)(e),channel:a,fullWidth:(0,b.Jt)(e,W.pm.CATEGORY_DISPLAY_SETTINGS,W.pm.CHANNEL_DISPLAY_MODE,W.pm.CHANNEL_DISPLAY_MODE_DEFAULT)===W.pm.CHANNEL_DISPLAY_MODE_FULL_SCREEN,locale:(0,Xe.k)(e),channelProfiles:(0,l.Gv)(e),enableUserCreation:t,isReadOnly:!1,isFavorite:(0,r.TJ)(e),teamIsGroupConstrained:Boolean(null==n?void 0:n.group_constrained),creatorName:(0,X.GZ)(e,u),teammate:c,teammateName:(0,X.GZ)(e,c),currentUser:d,stats:m,usersLimit:10,channelMember:s,isMobileView:(0,q.w3)(e)}}),(function(e){return{actions:(0,j.bindActionCreators)({getTotalUsersStats:V.ig,favoriteChannel:s.yc,unfavoriteChannel:s.XJ},e)}}))(Nt);var xt,Ft,Ut,Bt=n(42599),Ht=n(50800),qt=n(76261);class jt extends L().PureComponent{blockShortcutReactToLastPostForNonMessages(e){const{actions:{emitShortcutReactToLastPostFrom:t}}=this.props;(0,fe.Bn)(e)&&t(W.Hc.NO_WHERE)}componentDidUpdate(e){const{listId:t,isLastPost:n,shortcutReactToLastPostEmittedFrom:a}=this.props,s=e.shortcutReactToLastPostEmittedFrom!==a&&a===W.Hc.CENTER;n&&s&&this.blockShortcutReactToLastPostForNonMessages(t)}render(){const{listId:e,previousListId:t,loadingOlderPosts:n,loadingNewerPosts:a}=this.props,{OLDER_MESSAGES_LOADER:s,NEWER_MESSAGES_LOADER:r,CHANNEL_INTRO_MESSAGE:i,LOAD_OLDER_MESSAGES_TRIGGER:o,LOAD_NEWER_MESSAGES_TRIGGER:l}=W.D3;if(ge.fE(e)){const t=ge.GG(e);return L().createElement(Ht.A,{key:t,date:t})}if(ge.OO(e))return L().createElement(qt.A,{separatorId:e,newMessagesSeparatorActions:this.props.newMessagesSeparatorActions,channelId:this.props.channelId});if(this.props.exceededLimitChannelId)return L().createElement(Qe,{channelId:this.props.exceededLimitChannelId,firstInaccessiblePostTime:this.props.firstInaccessiblePostTime});if(e===i)return L().createElement(Dt,null);if(e===o||e===l)return L().createElement("button",{className:"more-messages-text theme style--none color--link",onClick:e===o?this.props.loadOlderPosts:this.props.loadNewerPosts},L().createElement(le.FormattedMessage,{id:"posts_view.loadMore",defaultMessage:"Load More Messages"}));if(e===s||e===r){const e=!n&&!a;return L().createElement("div",{className:"loading-screen"},L().createElement("div",{className:B()("loading__content",{hideAnimation:e})},L().createElement("div",{className:"round round-1"}),L().createElement("div",{className:"round round-2"}),L().createElement("div",{className:"round round-3"})))}const c={previousPostId:t,shouldHighlight:Boolean(this.props.shouldHighlight),togglePostMenu:this.props.togglePostMenu,isLastPost:this.props.isLastPost};return ge.mD(e)?L().createElement(Bt.A,Object.assign({location:W.Hc.CENTER,combinedId:e},c)):L().createElement(Ze.A,Object.assign({post:this.props.post,location:W.Hc.CENTER},c))}}xt=jt,Ft="propTypes",Ut={listId:F().string.isRequired,previousListId:F().string,fullWidth:F().bool,shouldHighlight:F().bool,loadOlderPosts:F().func.isRequired,loadNewerPosts:F().func.isRequired,togglePostMenu:F().func.isRequired,isLastPost:F().bool.isRequired,shortcutReactToLastPostEmittedFrom:F().string.isRequired,loadingNewerPosts:F().bool.isRequired,loadingOlderPosts:F().bool.isRequired,limitsLoaded:F().bool.isRequired,exceededLimitChannelId:F().string,firstInaccessiblePostTime:F().number,channelId:F().string.isRequired,newMessagesSeparatorActions:F().array.isRequired,actions:F().shape({emitShortcutReactToLastPostFrom:F().any.isRequired}).isRequired},(Ft=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(Ft))in xt?Object.defineProperty(xt,Ft,{value:Ut,enumerable:!0,configurable:!0,writable:!0}):xt[Ft]=Ut;const Vt=(0,a.connect)((function(e,t){const n=(0,ze.l6)(e),a=(0,je.y)(e),s=(0,qe.Os)(e),r=(0,qe.rd)(e),i={shortcutReactToLastPostEmittedFrom:n,usage:a,limits:s,limitsLoaded:r,post:(0,he.f5)(e,t.listId),currentUserId:(0,f.WR)(e),newMessagesSeparatorActions:e.plugins.components.NewMessagesSeparatorAction};if((t.listId===W.D3.OLDER_MESSAGES_LOADER||t.listId===W.D3.CHANNEL_INTRO_MESSAGE)&&r){const t=(0,f.eH)(e),n=(0,he.VT)(e).channels[t];(Boolean(n)||0===n)&&(i.exceededLimitChannelId=t,i.firstInaccessiblePostTime=n)}return i}),(function(e){return{actions:(0,j.bindActionCreators)({emitShortcutReactToLastPostFrom:Ve.Sq},e)}}))(jt);function zt(e){const{formatMessage:t}=(0,le.useIntl)();return L().createElement("span",e,L().createElement("svg",{x:"0px",y:"0px",viewBox:"-239 239 21 23",enableBackground:"new -239 239 21 23",role:"img","aria-label":t({id:"generic_icons.arrow.down",defaultMessage:"Down Arrow Icon"})},L().createElement("path",{d:"M-239,241.4l2.4-2.4l8.1,8.2l8.1-8.2l2.4,2.4l-10.5,10.6L-239,241.4z M-228.5,257.2l8.1-8.2l2.4,2.4l-10.5,10.6l-10.5-10.6 l2.4-2.4L-228.5,257.2z"})))}const Gt=e=>{let{isScrolling:t,atBottom:n,onClick:a}=e;return window.innerWidth>768?null:L().createElement("div",{className:B()("post-list__arrows",{scrolling:t&&!1===n}),onClick:a},L().createElement(zt,null))};Gt.propTypes={isScrolling:F().bool.isRequired,atBottom:F().bool,onClick:F().func.isRequired};const Wt=Gt;n(76409);var Kt=n(8361),Yt=n(99044);const Jt=e=>{let{children:t,onDismiss:n}=e;return L().createElement("div",{"data-testid":"hint-toast",className:"hint-toast"},L().createElement("div",{className:"hint-toast__message"},t),L().createElement("div",{className:"hint-toast__dismiss",onClick:()=>{"function"==typeof n&&n()},"data-testid":"dismissHintToast"},L().createElement(Yt.A,{className:"close-btn",id:"dismissHintToast"})))};Jt.propTypes={children:F().node.isRequired,onDismiss:F().func.isRequired};var Qt=n(87383);const Zt=e=>{let{onDismiss:t,onClick:n}=e;const{formatMessage:a}=(0,le.useIntl)(),s=a({id:"postlist.toast.scrollToBottom",defaultMessage:"Jump to recents"});return L().createElement("div",{"data-testid":"scroll-to-bottom-toast",className:"scroll-to-bottom-toast btn btn-primary",onClick:e=>{e.preventDefault(),n()}},L().createElement(Qt.A,null),s,L().createElement("div",{className:"scroll-to-bottom-toast__dismiss",onClick:e=>{e.preventDefault(),e.stopPropagation(),t()},"data-testid":"scroll-to-bottom-toast--dismiss-button"},L().createElement(Yt.A,{className:"close-btn",id:"dismissScrollToBottomToast"})))};Zt.propTypes={onDismiss:F().func.isRequired,onClick:F().func.isRequired};const Xt=Zt;var $t=n(83642),en=n(77828),tn=n(89227),nn=n(83007),an=n(36397),sn=n(19513);function rn(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const on=[en.hp.t8];class ln extends L().PureComponent{constructor(e){var t;super(e),t=this,rn(this,"handleShortcut",(e=>{(0,sn.e)(e,W.Ay.KeyCodes.ESCAPE)&&(this.state.showUnreadToast?this.hideUnreadToast():this.state.showNewMessagesToast?this.hideNewMessagesToast():this.state.showUnreadWithBottomStartToast?this.hideUnreadWithBottomStartToast():this.hideArchiveToast())})),rn(this,"hideUnreadToast",(()=>{this.state.showUnreadToast&&this.setState({showUnreadToast:!1})})),rn(this,"hideArchiveToast",(()=>{this.state.showMessageHistoryToast&&this.setState({showMessageHistoryToast:!1})})),rn(this,"hideNewMessagesToast",(function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.state.showNewMessagesToast&&(t.setState({showNewMessagesToast:!1}),e&&t.props.updateLastViewedBottomAt())})),rn(this,"hideSearchHintToast",(()=>{this.props.onSearchHintDismiss&&this.props.onSearchHintDismiss()})),rn(this,"hideUnreadWithBottomStartToast",(()=>{this.state.showUnreadWithBottomStartToast&&this.setState({showUnreadWithBottomStartToast:!1})})),rn(this,"newMessagesToastText",((e,t)=>this.props.width>500&&void 0!==t?L().createElement(le.FormattedMessage,{id:"postlist.toast.newMessagesSince",defaultMessage:"{count, number} new {count, plural, one {message} other {messages}} {isToday, select, true {} other {since}} {date}",values:{count:e,isToday:(0,an.cK)(new Date(t)).toString(),date:L().createElement(en.Ay,{value:t,useTime:!1,ranges:on})}}):L().createElement(le.FormattedMessage,{id:"postlist.toast.newMessages",defaultMessage:"{count, number} new {count, plural, one {message} other {messages}}",values:{count:e}}))),rn(this,"archiveToastText",(()=>L().createElement(le.FormattedMessage,{id:"postlist.toast.history",defaultMessage:"Viewing message history"}))),rn(this,"getSearchHintToastText",(()=>L().createElement(le.FormattedMessage,{id:"postlist.toast.searchHint",defaultMessage:"Tip: Try {searchShortcut} to search this channel",values:{searchShortcut:L().createElement($t.t,null)}}))),rn(this,"changeUrlToRemountChannelView",(()=>{const{match:e}=this.props;(0,nn.J)().replace("/".concat(e.params.team))})),rn(this,"scrollToNewMessage",(()=>{const{focusedPostId:e,atLatestPost:t,scrollToNewMessage:n,updateLastViewedBottomAt:a}=this.props;!e||t?(n(),a(),this.hideNewMessagesToast()):this.changeUrlToRemountChannelView()})),rn(this,"scrollToLatestMessages",(()=>{var e,t;const{focusedPostId:n,atLatestPost:a,scrollToLatestMessages:s}=this.props;if(n){if(!a)return void this.changeUrlToRemountChannelView();this.hideArchiveToast()}s(),this.hideUnreadToast(),null===(e=(t=this.props).hideScrollToBottomToast)||void 0===e||e.call(t)})),rn(this,"scrollToUnreadMessages",(()=>{this.props.scrollToUnreadMessages(),this.hideUnreadWithBottomStartToast()})),this.state={unreadCountInChannel:e.unreadCountInChannel,unreadCount:0}}static getDerivedStateFromProps(e,t){let n,{showUnreadToast:a,showNewMessagesToast:s,showMessageHistoryToast:r,showUnreadWithBottomStartToast:i}=t;return n=e.atLatestPost?e.unreadScrollPosition===me.pm.UNREAD_SCROLL_POSITION_START_FROM_NEWEST&&t.unreadCountInChannel?t.unreadCountInChannel+e.newRecentMessagesCount:ln.countNewMessages(e.rootPosts,e.isCollapsedThreadsEnabled,e.postListIds):e.channelMarkedAsUnread?e.unreadScrollPosition===me.pm.UNREAD_SCROLL_POSITION_START_FROM_NEWEST?e.unreadCountInChannel+e.newRecentMessagesCount:t.unreadCountInChannel:t.unreadCountInChannel+e.newRecentMessagesCount,void 0===a&&null!==e.atBottom&&(a=n>0&&!e.atBottom),void 0===r&&""!==e.focusedPostId&&null!==e.atBottom&&(r=e.initScrollOffsetFromBottom>1e3||!e.atLatestPost),!e.channelMarkedAsUnread||!1!==e.atBottom||t.channelMarkedAsUnread||t.showUnreadToast||(a=!0),e.channelMarkedAsUnread&&e.lastViewedAt!==t.lastViewedAt&&!1===e.atBottom&&(a=!0),!a&&n>0&&!1===e.atBottom&&e.latestPostTimeStamp&&e.lastViewedBottom<e.latestPostTimeStamp&&(s=!0),e.unreadScrollPosition!==me.pm.UNREAD_SCROLL_POSITION_START_FROM_NEWEST||e.channelMarkedAsUnread||(a=!1),n||(a=!1,s=!1),e.isNewMessageLineReached&&(i=!1),void 0===i&&e.lastViewedAt&&e.lastViewedAt!==t.lastViewedAt&&e.shouldStartFromBottomWhenUnread&&n>0&&!e.isNewMessageLineReached&&(i=!0),{unreadCount:n,showUnreadToast:a,showNewMessagesToast:s,showUnreadWithBottomStartToast:i,lastViewedAt:e.lastViewedAt,atBottom:e.atBottom,channelMarkedAsUnread:e.channelMarkedAsUnread,showMessageHistoryToast:r}}componentDidMount(){this.mounted=!0;const{showUnreadToast:e,showNewMessagesToast:t,showMessageHistoryToast:n,showUnreadWithBottomStartToast:a}=this.state,s=Boolean(e||t||n||a);document.addEventListener("keydown",this.handleShortcut),this.props.actions.updateToastStatus(s)}componentDidUpdate(e,t){const{showUnreadToast:n,showNewMessagesToast:a,showMessageHistoryToast:s,showUnreadWithBottomStartToast:r}=this.state,{atBottom:i,atLatestPost:o,postListIds:l,lastViewedBottom:c,updateNewMessagesAtInChannel:d,actions:u}=this.props;!e.atBottom&&i&&o&&(this.hideNewMessagesToast(!1),this.hideUnreadToast(),this.hideArchiveToast());const m=e.postListIds.length,h=l.length;if(h!==m&&l[0]!==e.postListIds[0]&&!1===i&&o&&h>0&&!n&&d(c),t.showUnreadToast!==n||t.showNewMessagesToast!==a||t.showMessageHistoryToast!==s||t.showUnreadWithBottomStartToast!==r){const e=Boolean(n||a||s||r);u.updateToastStatus(e)}}componentWillUnmount(){document.removeEventListener("keydown",this.handleShortcut)}getToastToRender(){const{atLatestPost:e,atBottom:t,width:n,lastViewedAt:a,showSearchHintToast:s,showScrollToBottomToast:r}=this.props,{showUnreadToast:i,showNewMessagesToast:o,showMessageHistoryToast:l,showUnreadWithBottomStartToast:c,unreadCount:d}=this.state,u={show:!0,width:n,onDismiss:this.hideUnreadToast,onClick:this.scrollToLatestMessages,onClickMessage:L().createElement(le.FormattedMessage,{id:"postlist.toast.scrollToBottom",defaultMessage:"Jump to recents"}),showActions:!e||e&&!1===t};if(i&&d>0)return L().createElement(tn.A,u,this.newMessagesToastText(d,a));const m={show:!0,width:n,onDismiss:this.hideUnreadWithBottomStartToast,onClick:this.scrollToUnreadMessages,onClickMessage:L().createElement(le.FormattedMessage,{id:"postlist.toast.scrollToUnread",defaultMessage:"Jump to unreads"}),showActions:!0,jumpDirection:"up"};if(c&&d>0)return L().createElement(tn.A,m,this.newMessagesToastText(d,a));if(o){const e={onDismiss:this.hideNewMessagesToast,onClick:this.scrollToNewMessage,onClickMessage:L().createElement(le.FormattedMessage,{id:"postlist.toast.scrollToLatest",defaultMessage:"Jump to new messages"})};return L().createElement(tn.A,Object.assign({},u,e),this.newMessagesToastText(d,a))}if(l){const e={show:!0,width:n,onDismiss:this.hideArchiveToast,onClick:this.scrollToLatestMessages,onClickMessage:L().createElement(le.FormattedMessage,{id:"postlist.toast.scrollToBottom",defaultMessage:"Jump to recents"}),showActions:!0,extraClasses:"toast__history"};return L().createElement(tn.A,e,this.archiveToastText())}const h=[];return r&&h.push(L().createElement(Xt,{key:"scroll-to-bottom-toast",onClick:this.scrollToLatestMessages,onDismiss:this.props.onScrollToBottomToastDismiss})),s&&h.push(L().createElement(Jt,{key:"search-hint-toast",onDismiss:this.hideSearchHintToast},this.getSearchHintToastText())),h.length>0?L().createElement("div",{className:"toasts-wrapper"},h):null}render(){const e=this.getToastToRender();return L().createElement(L().Fragment,null,e)}}rn(ln,"propTypes",{channelMarkedAsUnread:F().bool,postListIds:F().arrayOf(F().string).isRequired,latestPostTimeStamp:F().number,atBottom:F().oneOfType([F().bool,F().oneOf([null])]),lastViewedBottom:F().number.isRequired,width:F().number.isRequired,focusedPostId:F().string,initScrollOffsetFromBottom:F().number.isRequired,updateNewMessagesAtInChannel:F().func.isRequired,scrollToNewMessage:F().func.isRequired,scrollToLatestMessages:F().func.isRequired,scrollToUnreadMessages:F().func.isRequired,updateLastViewedBottomAt:F().func.isRequired,showSearchHintToast:F().bool.isRequired,onSearchHintDismiss:F().func.isRequired,showScrollToBottomToast:F().bool.isRequired,onScrollToBottomToastDismiss:F().func.isRequired,hideScrollToBottomToast:F().func.isRequired,shouldStartFromBottomWhenUnread:F().bool.isRequired,isNewMessageLineReached:F().bool.isRequired,rootPosts:F().objectOf(F().bool).isRequired,lastViewedAt:F().number.isRequired,newRecentMessagesCount:F().number.isRequired,unreadScrollPosition:F().string.isRequired,isCollapsedThreadsEnabled:F().bool.isRequired}),rn(ln,"defaultProps",{focusedPostId:""}),rn(ln,"countNewMessages",(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a=(0,ge.V)(n);if(a<=0)return 0;let s=n.slice(0,a).filter((e=>!(0,fe.Bn)(e)));return t&&(s=s.filter((t=>e[t]))),s.length}));const cn=(0,le.injectIntl)(ln),dn=(0,O.withRouter)((0,a.connect)((function(){const e=(0,Kt.Mz)("makeCountUnreadsBelow",he.zX,l.WR,((e,t)=>t),((e,t,n)=>n),b.WW,((e,t,n,a,s)=>n?n.map((t=>e[t])).filter((e=>e&&e.user_id!==t&&e.state!==me.AF.POST_DELETED&&e.create_at>a&&(!s||""===e.root_id))).length:0)),t=(0,Kt.Mz)("makeGetRootPosts",he.zX,l.WR,r.Lw,((e,t,n)=>Object.values(e).filter((e=>""===e.root_id&&e.channel_id===(null==n?void 0:n.id)&&e.state!==me.AF.POST_DELETED)).reduce(((e,t)=>(e[t.id]=!0,e)),{}))),n=(0,ge.fG)();return function(a,s){let i=0;const o=(0,r.PW)(a,s.channelId),l=a.views.channel.lastChannelViewTime[s.channelId],c=(0,b.z0)(a);if(!s.atLatestPost){let t=(0,he.Lf)(a,s.channelId)||[];t&&(t=n(a,{postIds:t,lastViewedAt:l})),i=e(a,t,l)}return{rootPosts:t(a),lastViewedAt:l,newRecentMessagesCount:i,unreadScrollPosition:c,isCollapsedThreadsEnabled:(0,b.WW)(a),unreadCountInChannel:(0,r.zk)(a),channelMarkedAsUnread:o}}}),(function(e){return{actions:(0,j.bindActionCreators)({updateToastStatus:c.p4},e)}}))(cn));var un=n(694),mn=n(89092);const hn=e=>{const{postIds:t}=e,n=(0,P.useMemo)((()=>(0,fe.h7)(t||[])),[t]),s=(0,a.useSelector)((e=>(0,he.f5)(e,n))),r=(0,fe.VD)(s);return L().createElement("span",{className:"sr-only","aria-live":"polite"},r)};hn.propTypes={postIds:F().arrayOf(F().string)};const pn=hn;function gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gn(Object(n),!0).forEach((function(t){bn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bn(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const En={padding:"14px 0px 7px"},vn={position:"absolute",bottom:"0",maxHeight:"100%"};class Cn extends L().PureComponent{constructor(e){var t;super(e),t=this,bn(this,"scrollStopAction",null),bn(this,"handleWindowResize",(()=>{this.showSearchHintThreshold=this.getShowSearchHintThreshold()})),bn(this,"togglePostMenu",(e=>{let t=this.state.dynamicListStyle;this.props.isMobileView&&(t=fn(fn({},t),{},{willChange:e?"unset":"transform"})),this.setState({postMenuOpened:e,dynamicListStyle:t})})),bn(this,"onNewMessageLineReached",(()=>{this.setState({isNewMessageLineReached:!0})})),bn(this,"renderRow",(e=>{let{data:t,itemId:n,style:a}=e;const s=t.indexOf(n);let r="";const i="post-row__padding",o=-1!==s&&s<t.length-1?t[s+1]:"",l=s>0&&s<t.length?t[s-1]:"";((0,ge.fE)(l)||(0,ge.OO)(l))&&(r+=i+" bottom"),((0,ge.fE)(o)||(0,ge.OO)(o))&&(r.includes(i)?r+=" top":r+=i+" top");const c=n===this.state.postListIds[0];return L().createElement("div",{style:a,className:r},L().createElement(Vt,{listId:n,previousListId:(0,fe.fn)(t,s),shouldHighlight:n===this.props.focusedPostId,loadOlderPosts:this.props.actions.loadOlderPosts,loadNewerPosts:this.props.actions.loadNewerPosts,togglePostMenu:this.togglePostMenu,isLastPost:c,loadingNewerPosts:this.props.loadingNewerPosts,loadingOlderPosts:this.props.loadingOlderPosts,channelId:this.props.channelId}))})),bn(this,"scrollToFailed",(e=>{0===e?this.props.actions.changeUnreadChunkTimeStamp(0):this.props.actions.changeUnreadChunkTimeStamp(this.props.lastViewedAt)})),bn(this,"onScroll",(e=>{let{scrollDirection:t,scrollOffset:n,scrollUpdateWasRequested:a,clientHeight:s,scrollHeight:r}=e;if(r<=0)return;const i="backward"===t&&!a,o="forward"===t&&!a,l=n<1e3,c=this.getOffsetFromBottom(n,r,s),d=c<1e3;if(i&&l&&!this.props.atOldestPost?this.props.actions.loadOlderPosts():o&&d&&!this.props.atLatestPost&&this.props.actions.loadNewerPosts(),this.props.isMobileView&&(this.state.isScrolling||this.setState({isScrolling:!0}),this.scrollStopAction&&this.scrollStopAction.fireAfter(W.Ay.SCROLL_DELAY)),this.checkBottom(n,r,s),a){var u;const e=null===(u=this.listRef.current)||void 0===u?void 0:u._getRangeToRender();e&&e[3]<=1&&!this.props.atLatestPost&&this.props.actions.canLoadMorePosts(W.DL.AFTER_ID),!this.state.atBottom&&r&&this.setState({initScrollOffsetFromBottom:c})}this.props.isMobileView&&this.state.showSearchHint&&this.setState({showSearchHint:!1}),this.props.isMobileView||this.state.isSearchHintDismissed||this.setState({showSearchHint:c>this.showSearchHintThreshold}),this.updateScrollToBottomToastVisibility(n,r,s)})),bn(this,"getShowSearchHintThreshold",(()=>3*window.screen.height)),bn(this,"checkBottom",((e,t,n)=>{this.updateAtBottom(this.isAtBottom(e,t,n))})),bn(this,"getOffsetFromBottom",((e,t,n)=>t-n-e)),bn(this,"isAtBottom",((e,t,n)=>this.getOffsetFromBottom(e,t,n)<=10&&t>0)),bn(this,"updateAtBottom",(e=>{if(e!==this.state.atBottom){let t=Date.now();this.props.latestPostTimeStamp&&this.props.latestPostTimeStamp>t&&(t=this.props.latestPostTimeStamp),this.setState({atBottom:e,lastViewedBottom:t})}})),bn(this,"updateLastViewedBottomAt",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();t.setState({lastViewedBottom:e})})),bn(this,"handleScrollStop",(()=>{this.mounted&&this.setState({isScrolling:!1})})),bn(this,"handleSearchHintDismiss",(()=>{this.setState({showSearchHint:!1,isSearchHintDismissed:!0})})),bn(this,"handleScrollToBottomToastDismiss",(()=>{this.setState({showScrollToBottomToast:!1,isScrollToBottomDismissed:!0})})),bn(this,"hideScrollToBottomToast",(()=>{this.setState({showScrollToBottomToast:!1})})),bn(this,"updateScrollToBottomToastVisibility",((e,t,n)=>{if(this.state.showScrollToBottomToast&&this.state.atBottom)this.setState({showScrollToBottomToast:!1});else if(!this.state.isScrollToBottomDismissed){const a=this.getOffsetFromBottom(e,t,n);this.setState({showScrollToBottomToast:a>this.showSearchHintThreshold})}})),bn(this,"updateFloatingTimestamp",(e=>{this.props.isMobileView&&this.props.postListIds&&this.setState({topPostId:(0,fe.h7)(this.props.postListIds.slice(e))})})),bn(this,"onItemsRendered",(e=>{let{visibleStartIndex:t,visibleStopIndex:n}=e;this.updateFloatingTimestamp(t),this.newMessageLineIndex>0&&!this.state.isNewMessageLineReached&&this.newMessageLineIndex<=t&&this.newMessageLineIndex>=n&&this.onNewMessageLineReached()})),bn(this,"initScrollToIndex",(()=>{if(this.props.focusedPostId)return{index:this.state.postListIds.findIndex((e=>e===this.props.focusedPostId)),position:"center"};if(this.props.shouldStartFromBottomWhenUnread)return{index:0,position:"end"};const e=(0,ge.V)(this.state.postListIds);return e>0?(0,ge.fE)(this.state.postListIds[e+1])?{index:e+1,position:"start",offset:-50}:{index:e,position:"start",offset:-50}:{index:0,position:"end"}})),bn(this,"scrollToLatestMessages",(()=>{this.props.atLatestPost?this.scrollToBottom():(this.updateNewMessagesAtInChannel(),this.props.actions.changeUnreadChunkTimeStamp(0))})),bn(this,"scrollToUnreadMessages",(()=>{this.props.actions.toggleShouldStartFromBottomWhenUnread()})),bn(this,"scrollToBottom",(()=>{var e;null===(e=this.listRef.current)||void 0===e||e.scrollToItem(0,"end")})),bn(this,"scrollToNewMessage",(()=>{var e;null===(e=this.listRef.current)||void 0===e||e.scrollToItem((0,ge.V)(this.state.postListIds),"start",-50)})),bn(this,"updateNewMessagesAtInChannel",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();t.props.actions.updateNewMessagesAtInChannel(t.props.channelId,e)})),bn(this,"renderToasts",(e=>L().createElement(dn,{atLatestPost:this.props.atLatestPost,postListIds:this.state.postListIds,atBottom:this.state.atBottom,width:e,lastViewedBottom:this.state.lastViewedBottom,latestPostTimeStamp:this.props.latestPostTimeStamp,scrollToUnreadMessages:this.scrollToUnreadMessages,scrollToNewMessage:this.scrollToNewMessage,scrollToLatestMessages:this.scrollToLatestMessages,updateNewMessagesAtInChannel:this.updateNewMessagesAtInChannel,updateLastViewedBottomAt:this.updateLastViewedBottomAt,shouldStartFromBottomWhenUnread:this.props.shouldStartFromBottomWhenUnread,isNewMessageLineReached:this.state.isNewMessageLineReached,channelId:this.props.channelId,focusedPostId:this.props.focusedPostId,initScrollOffsetFromBottom:this.state.initScrollOffsetFromBottom,onSearchHintDismiss:this.handleSearchHintDismiss,showSearchHintToast:this.state.showSearchHint,showScrollToBottomToast:this.state.showScrollToBottomToast,onScrollToBottomToastDismiss:this.handleScrollToBottomToastDismiss,hideScrollToBottomToast:this.hideScrollToBottomToast})));const n=W.D3.CHANNEL_INTRO_MESSAGE;this.mounted=!0,this.state={isScrolling:!1,atBottom:null,lastViewedBottom:Date.now(),postListIds:[n],topPostId:"",postMenuOpened:!1,dynamicListStyle:{willChange:"transform"},initScrollCompleted:!1,initScrollOffsetFromBottom:0,showSearchHint:!1,isSearchHintDismissed:!1,isNewMessageLineReached:!1,showScrollToBottomToast:!1,isScrollToBottomDismissed:!1},this.listRef=L().createRef(),this.postListRef=L().createRef(),this.props.isMobileView&&(this.scrollStopAction=new mn.A(this.handleScrollStop)),this.initRangeToRender=this.props.focusedPostId?[0,100]:[0,50];let a=0;a=e.focusedPostId?(this.props.postListIds||[]).findIndex((e=>e===this.props.focusedPostId)):(0,ge.V)(e.postListIds||[]),this.newMessageLineIndex=(0,ge.V)(e.postListIds||[]);const s=e.focusedPostId?100:50;this.initRangeToRender=[Math.max(a-30,0),Math.max(a+30,Math.min((e.postListIds||[]).length-1,s))],this.showSearchHintThreshold=this.getShowSearchHintThreshold()}componentDidMount(){this.mounted=!0,window.addEventListener("resize",this.handleWindowResize),ve.A.addListener(W.wf.POST_LIST_SCROLL_TO_BOTTOM,this.scrollToLatestMessages)}getSnapshotBeforeUpdate(e){if(this.postListRef&&this.postListRef.current){const n=this.props.postListIds&&this.props.postListIds.length!==(e.postListIds||[]).length&&this.props.postListIds[0]===(e.postListIds||[])[0],a=this.props.atOldestPost!==e.atOldestPost;if((n||a)&&!1===this.state.atBottom){var t;const e=this.postListRef.current;return{previousScrollTop:null===(t=e.parentElement)||void 0===t?void 0:t.scrollTop,previousScrollHeight:e.scrollHeight}}}return null}componentDidUpdate(e,t,n){if(this.props.isMobileView&&!e.isMobileView&&(this.scrollStopAction=new mn.A(this.handleScrollStop)),!this.postListRef.current)return;const a=(e.postListIds||[]).length,s=(this.props.postListIds||[]).length;if(this.newMessageLineIndex=(0,ge.V)(this.props.postListIds||[]),n){const t=this.postListRef.current.scrollHeight,i=s!==a&&(this.props.postListIds||[])[0]===(e.postListIds||[])[0],o=this.props.atOldestPost!==e.atOldestPost;if((i||o)&&!this.state.atBottom&&n){const e=n.previousScrollTop+(t-n.previousScrollHeight);var r;0!==e&&e-n.previousScrollTop!=0&&(null===(r=this.listRef.current)||void 0===r||r.scrollTo(e,e-n.previousScrollTop,!0))}}}componentWillUnmount(){this.mounted=!1,window.removeEventListener("resize",this.handleWindowResize),ve.A.removeListener(W.wf.POST_LIST_SCROLL_TO_BOTTOM,this.scrollToLatestMessages)}static getDerivedStateFromProps(e,t){const n=e.postListIds||[];let a;a=e.atOldestPost?[...n,W.D3.CHANNEL_INTRO_MESSAGE]:e.autoRetryEnable?[...n,W.D3.OLDER_MESSAGES_LOADER]:[...n,W.D3.LOAD_OLDER_MESSAGES_TRIGGER],e.atLatestPost||(a=e.autoRetryEnable?[W.D3.NEWER_MESSAGES_LOADER,...a]:[W.D3.LOAD_NEWER_MESSAGES_TRIGGER,...a]);const s={postListIds:a};if(e.isMobileView!==t.isMobileView){s.isMobileView=e.isMobileView;const n=t.dynamicListStyle;t.postMenuOpened&&(e.isMobileView||"unset"!==n.willChange?e.isMobileView&&"transform"===n.willChange&&(s.dynamicListStyle=fn(fn({},n),{},{willChange:"unset"})):s.dynamicListStyle=fn(fn({},n),{},{willChange:"transform"}))}return s}render(){const{channelId:e}=this.props,{dynamicListStyle:t}=this.state;return L().createElement("div",{className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0,"data-a11y-loop-navigation":!1,"aria-label":X.Vw({id:"accessibility.sections.centerContent",defaultMessage:"message list main region"})},this.props.isMobileView&&L().createElement(L().Fragment,null,L().createElement(He.A,{isScrolling:this.state.isScrolling,postId:this.state.topPostId}),L().createElement(Wt,{isScrolling:this.state.isScrolling,atBottom:Boolean(this.state.atBottom),onClick:this.scrollToBottom})),L().createElement("div",{className:"post-list-holder-by-time",key:"postlist-"+e},L().createElement("div",{className:"post-list__table"},L().createElement("div",{id:"postListContent",className:"post-list__content"},L().createElement(pn,{postIds:this.props.postListIds}),L().createElement(Ee.Ay,null,(e=>{let{height:n,width:a}=e;return L().createElement(L().Fragment,null,L().createElement("div",null,L().createElement(un.default,{pluggableName:"ChannelToast"}),this.renderToasts(a)),L().createElement(Oe,{ref:this.listRef,id:"postListScrollContainer",className:"post-list__dynamic",height:n,width:a,itemData:this.state.postListIds,overscanCountForward:80,overscanCountBackward:80,onScroll:this.onScroll,initScrollToIndex:this.initScrollToIndex,canLoadMorePosts:this.props.actions.canLoadMorePosts,innerRef:this.postListRef,style:fn(fn({},vn),t),innerListStyle:En,initRangeToRender:this.initRangeToRender,loaderId:W.D3.OLDER_MESSAGES_LOADER,correctScrollToBottom:this.props.atLatestPost,onItemsRendered:this.onItemsRendered,scrollToFailed:this.scrollToFailed},this.renderRow))}))))))}}bn(Cn,"propTypes",{postListIds:F().arrayOf(F().string),channelId:F().string.isRequired,autoRetryEnable:F().bool.isRequired,loadingNewerPosts:F().bool.isRequired,loadingOlderPosts:F().bool.isRequired,isMobileView:F().bool.isRequired,atOldestPost:F().bool,atLatestPost:F().bool,latestPostTimeStamp:F().number,lastViewedAt:F().number.isRequired,focusedPostId:F().string,shouldStartFromBottomWhenUnread:F().bool.isRequired,actions:F().shape({loadOlderPosts:F().func.isRequired,loadNewerPosts:F().func.isRequired,canLoadMorePosts:F().func.isRequired,changeUnreadChunkTimeStamp:F().func.isRequired,updateNewMessagesAtInChannel:F().any.isRequired,toggleShouldStartFromBottomWhenUnread:F().func.isRequired}).isRequired});var _n=n(3295);function yn(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mn(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,be.Gy)(_n.CU.PostListLoaded);const t=(0,_n.uB)({name:_n.t$.ChannelSwitch,startMark:_n.CU.ChannelLinkClicked,endMark:_n.CU.PostListLoaded,labels:{fresh:e.toString()},canFail:!0}),n=(0,_n.uB)({name:_n.t$.TeamSwitch,startMark:_n.CU.TeamLinkClicked,endMark:_n.CU.PostListLoaded,labels:{fresh:e.toString()},canFail:!0});if((0,be.dW)()){if(t){const n=(0,be.kA)(_n.CU.ChannelLinkClicked,_n.CU.PostListLoaded);(0,be.sx)("performance",_n.t$.ChannelSwitch,{duration:Math.round(t.duration),fresh:e,requestCount:n})}if(n){const t=(0,be.kA)(_n.CU.TeamLinkClicked,_n.CU.PostListLoaded);(0,be.sx)("performance",_n.t$.TeamSwitch,{duration:Math.round(n.duration),fresh:e,requestCount:t})}}(0,be.MR)([_n.CU.ChannelLinkClicked,_n.CU.TeamLinkClicked,_n.CU.PostListLoaded])}class Tn extends L().PureComponent{constructor(e){var t;super(e),t=this,yn(this,"postsOnLoad",(async e=>{const{focusedPostId:t,isFirstLoad:n,latestPostTimeStamp:a,isPrefetchingInProcess:s,actions:r}=this.props;t?await r.loadPostsAround(e,t):n?s||await r.loadUnreads(e):a?await r.syncPostsInChannel(e,a,!1):await r.loadLatestPosts(e),t||this.props.actions.markChannelAsRead(e),this.mounted&&this.setState({loadingOlderPosts:!1,loadingNewerPosts:!1})})),yn(this,"callLoadPosts",(async(e,t,n)=>{const{error:a}=await this.props.actions.loadPosts({channelId:e,postId:t,type:n});return n===W.DL.BEFORE_ID?this.setState({loadingOlderPosts:!1}):this.setState({loadingNewerPosts:!1}),a?this.autoRetriesCount<3?(this.autoRetriesCount++,await this.callLoadPosts(e,t,n)):this.mounted&&this.setState({autoRetryEnable:!1}):(this.mounted&&this.setState({autoRetryEnable:!0}),this.state.autoRetryEnable||(this.autoRetriesCount=0)),{error:a}})),yn(this,"getOldestVisiblePostId",(()=>(0,fe.J3)(this.props.postListIds||[]))),yn(this,"getLatestVisiblePostId",(()=>(0,fe.h7)(this.props.postListIds||[]))),yn(this,"canLoadMorePosts",(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W.DL.BEFORE_ID;t.props.hasInaccessiblePosts||t.props.postListIds&&(t.state.loadingOlderPosts||t.state.loadingNewerPosts||(t.extraPagesLoaded>10?t.state.autoRetryEnable&&t.setState({autoRetryEnable:!1}):(t.props.atOldestPost||e!==W.DL.BEFORE_ID?t.props.atLatestPost||await t.getPostsAfter():await t.getPostsBefore(),t.extraPagesLoaded+=1)))})),yn(this,"getPostsBefore",(async()=>{if(this.state.loadingOlderPosts)return;this.state.autoRetryEnable||(this.extraPagesLoaded=0);const e=this.getOldestVisiblePostId();this.setState({loadingOlderPosts:!0}),await this.callLoadPosts(this.props.channelId,e,W.DL.BEFORE_ID)})),yn(this,"getPostsAfter",(async()=>{if(this.state.loadingNewerPosts)return;this.state.autoRetryEnable||(this.extraPagesLoaded=0);const e=this.getLatestVisiblePostId();this.setState({loadingNewerPosts:!0}),await this.callLoadPosts(this.props.channelId,e,W.DL.AFTER_ID)})),this.state={loadingNewerPosts:!1,loadingOlderPosts:!1,autoRetryEnable:!0},this.extraPagesLoaded=0,this.autoRetriesCount=0,this.actionsForPostList={loadOlderPosts:this.getPostsBefore,loadNewerPosts:this.getPostsAfter,canLoadMorePosts:this.canLoadMorePosts,changeUnreadChunkTimeStamp:e.changeUnreadChunkTimeStamp,toggleShouldStartFromBottomWhenUnread:e.toggleShouldStartFromBottomWhenUnread,updateNewMessagesAtInChannel:this.props.actions.updateNewMessagesAtInChannel}}componentDidMount(){this.mounted=!0,this.props.channelId&&(this.postsOnLoad(this.props.channelId),this.props.postListIds&&Mn())}componentDidUpdate(e){this.props.channelId!==e.channelId&&this.postsOnLoad(this.props.channelId),null!=this.props.postListIds&&null==e.postListIds&&Mn(!0)}componentWillUnmount(){this.mounted=!1}render(){return this.props.postListIds?L().createElement("div",{className:"post-list-holder-by-time",key:"postlist-"+this.props.channelId},L().createElement("div",{className:"post-list__table"},L().createElement("div",{id:"virtualizedPostListContent",className:"post-list__content"},L().createElement(Cn,{loadingNewerPosts:this.state.loadingNewerPosts,loadingOlderPosts:this.state.loadingOlderPosts,atOldestPost:this.props.atOldestPost,atLatestPost:this.props.atLatestPost,focusedPostId:this.props.focusedPostId,channelId:this.props.channelId,autoRetryEnable:this.state.autoRetryEnable,shouldStartFromBottomWhenUnread:this.props.shouldStartFromBottomWhenUnread,actions:this.actionsForPostList,postListIds:this.props.formattedPostIds,latestPostTimeStamp:this.props.latestPostTimeStamp,isMobileView:this.props.isMobileView,lastViewedAt:this.props.lastViewedAt})))):L().createElement(ue.A,{centered:!0})}}yn(Tn,"propTypes",{formattedPostIds:F().arrayOf(F().string),postListIds:F().arrayOf(F().string),channelId:F().string.isRequired,focusedPostId:F().string,atLatestPost:F().bool.isRequired,atOldestPost:F().bool,isFirstLoad:F().bool.isRequired,latestPostTimeStamp:F().number,changeUnreadChunkTimeStamp:F().func.isRequired,isPrefetchingInProcess:F().bool.isRequired,isMobileView:F().bool.isRequired,lastViewedAt:F().number.isRequired,toggleShouldStartFromBottomWhenUnread:F().func.isRequired,shouldStartFromBottomWhenUnread:F().bool.isRequired,hasInaccessiblePosts:F().bool.isRequired,actions:F().shape({loadPostsAround:F().func.isRequired,loadUnreads:F().func.isRequired,loadPosts:F().func.isRequired,syncPostsInChannel:F().func.isRequired,loadLatestPosts:F().func.isRequired,markChannelAsRead:F().func.isRequired,updateNewMessagesAtInChannel:F().any.isRequired}).isRequired});const Sn=(e,t)=>!e.entities.posts.postsInChannel[t],wn=(0,pe.el)((e=>(0,fe.h7)(e))),In=(0,a.connect)((function(){const e=(0,he.A8)(),t=(0,ge.fG)();return function(n,a){let s,r,i,o=0,l=!1,c=!1;const{focusedPostId:d,unreadChunkTimeStamp:u,channelId:m,shouldStartFromBottomWhenUnread:h}=a,p=n.views.channel,g=p.lastChannelViewTime[m],f=p.channelPrefetchStatus[m]===me.IZ.STARTED,b=(0,he.VT)(n),E=Boolean(b.channels[m])||0===b.channels[m],v=(0,he.f5)(n,d||"");r=d&&void 0!==v?e(n,d,m):u&&!h?(0,he.AB)(n,m,u):(0,he.Gn)(n,m),r&&(s=r.order,l=Boolean(r.recent),c=Boolean(r.oldest));let C=!1;if(null!=u&&(C=h&&!(0,he.dH)(n,r,u)),s&&(i=t(n,{postIds:s,lastViewedAt:g,indicateNewMessages:!C}),s.length)){const e=wn(s);o=(0,he.f5)(n,e).create_at}return{lastViewedAt:g,isFirstLoad:Sn(n,m),formattedPostIds:i,atLatestPost:l,atOldestPost:c,latestPostTimeStamp:o,postListIds:s,isPrefetchingInProcess:f,shouldStartFromBottomWhenUnread:h,isMobileView:(0,q.w3)(n),hasInaccessiblePosts:E}}}),(function(e){return{actions:(0,j.bindActionCreators)({loadUnreads:c.jw,loadPosts:c.i,loadLatestPosts:c.F8,loadPostsAround:c.zp,syncPostsInChannel:c.LD,markChannelAsRead:s.Zn,updateNewMessagesAtInChannel:Q.Lg},e)}}))(Tn);function An(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Nn extends L().PureComponent{constructor(e){super(e),An(this,"changeUnreadChunkTimeStamp",(e=>{this.setState({unreadChunkTimeStamp:e,loaderForChangeOfPostsChunk:!0},(()=>{window.requestAnimationFrame((()=>{this.setState({loaderForChangeOfPostsChunk:!1})}))}))})),An(this,"toggleShouldStartFromBottomWhenUnread",(()=>{this.setState((e=>({loaderForChangeOfPostsChunk:!0,shouldStartFromBottomWhenUnread:!e.shouldStartFromBottomWhenUnread})),(()=>{window.requestAnimationFrame((()=>{this.setState({loaderForChangeOfPostsChunk:!1})}))}))}));const t=this.props.unreadScrollPosition===W.pm.UNREAD_SCROLL_POSITION_START_FROM_NEWEST;this.state={unreadChunkTimeStamp:e.lastViewedAt,shouldStartFromBottomWhenUnread:t,loaderForChangeOfPostsChunk:!1,channelLoading:e.channelLoading}}static getDerivedStateFromProps(e,t){return null===t.unreadChunkTimeStamp&&e.lastViewedAt?{unreadChunkTimeStamp:e.lastViewedAt}:e.channelLoading!==t.channelLoading?{unreadChunkTimeStamp:e.lastViewedAt,channelLoading:e.channelLoading}:null}render(){return this.props.channelLoading||this.state.loaderForChangeOfPostsChunk?L().createElement("div",{id:"post-list"},L().createElement(ue.A,{centered:!0})):L().createElement("div",{id:"post-list",role:"main"},L().createElement(In,{unreadChunkTimeStamp:this.state.unreadChunkTimeStamp,channelId:this.props.channelId,changeUnreadChunkTimeStamp:this.changeUnreadChunkTimeStamp,shouldStartFromBottomWhenUnread:this.state.shouldStartFromBottomWhenUnread,toggleShouldStartFromBottomWhenUnread:this.toggleShouldStartFromBottomWhenUnread,focusedPostId:this.props.focusedPostId}))}}An(Nn,"propTypes",{lastViewedAt:F().number,channelLoading:F().bool.isRequired,channelId:F().string.isRequired,focusedPostId:F().string,unreadScrollPosition:F().string.isRequired});const Rn=(0,O.withRouter)((0,a.connect)((function(){return function(e,t){var n;const a=null===(n=t.match)||void 0===n?void 0:n.params,s=(0,o.Uj)(e,(null==a?void 0:a.team)||"");let i;const c=(0,r.c)(e,t.channelId);let d=e.views.channel.lastChannelViewTime[t.channelId];c&&(c.type===W.YM.DM_CHANNEL&&c.teammate_id&&(i=(0,l.wz)(e,c.teammate_id)),d=c.last_post_at?d:c.last_post_at);const u=((e,t,n,a,s)=>{var r;if(e.postid)return!1;const i=null===(r=e.identifier)||void 0===r?void 0:r.toLowerCase();if(t&&n){if(t.type!==W.YM.DM_CHANNEL&&t.name!==i)return!0;if(t.type===W.YM.DM_CHANNEL&&a&&i!=="@".concat(a.username))return!0;const e=n.id;return!!(t.team_id&&t.team_id!==e||s&&!s[e])}return!0})(a,c,s,i,(0,o.bO)(e));return{unreadScrollPosition:(0,b.z0)(e),lastViewedAt:d,channelLoading:u}}}))(Nn));var Pn=n(7344);const Ln=()=>{location.reload()},On=e=>{let{updateWaitForLoader:t}=e;const[n,a]=(0,P.useState)(!1);return(0,P.useEffect)((()=>{let e=setTimeout((()=>{a(!0),t(!0),e=setTimeout((()=>{t(!1)}),2e3)}),5e3);return()=>{clearTimeout(e),t(!1)}}),[]),L().createElement("div",{className:"AdvancedTextEditor__skeleton"},n&&L().createElement(L().Fragment,null,L().createElement(le.FormattedMessage,{id:"center_panel.input.cannot_load_component",defaultMessage:"Something went wrong while loading the component. Please wait a moment, or try reloading the app."}),L().createElement("button",{className:"btn btn-tertiary channel-archived__close-btn",onClick:Ln},L().createElement(le.FormattedMessage,{id:"center_panel.reloadPage",defaultMessage:"Reload"}))))};On.propTypes={updateWaitForLoader:F().func.isRequired};const kn=On;function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function xn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dn(Object(n),!0).forEach((function(t){Fn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fn(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Un=(0,D.S)("ChannelHeader",(0,P.lazy)((()=>Promise.all([n.e(8105),n.e(1852),n.e(4446),n.e(285),n.e(5073)]).then(n.bind(n,86222))))),Bn=(0,D.S)("FileUploadOverlay",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,77143))))),Hn=(0,D.S)("ChannelBookmarks",(0,P.lazy)((()=>Promise.all([n.e(4446),n.e(1119)]).then(n.bind(n,39403))))),qn=(0,D.S)("AdvancedCreatePost",(0,P.lazy)((()=>n.e(3797).then(n.bind(n,73797))))),jn=(0,D.S)("ChannelBanner",(0,P.lazy)((()=>n.e(388).then(n.bind(n,10388)))));class Vn extends L().PureComponent{static getDerivedStateFromProps(e,t){let n={};const a=e.match.params.postid;return e.match.url!==t.url&&e.channelId!==t.channelId&&(n={deferredPostView:Vn.createDeferredPostView(),url:e.match.url,focusedPostId:a}),e.channelId!==t.channelId&&(n=xn(xn({},n),{},{channelId:e.channelId,focusedPostId:a})),a&&a!==t.focusedPostId&&(n=xn(xn({},n),{},{focusedPostId:a})),Object.keys(n).length?n:null}constructor(e){super(e),Fn(this,"onClickCloseChannel",(()=>{this.props.goToLastViewedChannel()})),Fn(this,"onUpdateInputShowLoader",(e=>{this.setState({waitForLoader:e})})),this.state={url:e.match.url,channelId:e.channelId,focusedPostId:e.match.params.postid,deferredPostView:Vn.createDeferredPostView(),waitForLoader:!1},this.channelViewRef=L().createRef()}componentDidUpdate(e){e.channelId!==this.props.channelId&&this.props.enableWebSocketEventScope&&Pn.A.updateActiveChannel(this.props.channelId),e.channelId===this.props.channelId&&e.channelIsArchived===this.props.channelIsArchived||this.props.channelIsArchived&&!this.props.viewArchivedChannels&&this.props.goToLastViewedChannel()}render(){let e;e=this.props.deactivatedChannel?L().createElement("div",{className:"post-create__container AdvancedTextEditor__ctr",id:"post-create"},L().createElement("div",{className:"channel-archived__message"},L().createElement(le.FormattedMessage,{id:"channelView.archivedChannelWithDeactivatedUser",defaultMessage:"You are viewing an archived channel with a <b>deactivated user</b>. New messages cannot be posted.",values:{b:e=>L().createElement("b",null,e)}}),L().createElement("button",{className:"btn btn-primary channel-archived__close-btn",onClick:this.onClickCloseChannel},L().createElement(le.FormattedMessage,{id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"})))):this.props.channelIsArchived?L().createElement("div",{className:"post-create__container",id:"post-create"},L().createElement("div",{id:"channelArchivedMessage",className:"channel-archived__message"},L().createElement(le.FormattedMessage,{id:"channelView.archivedChannel",defaultMessage:"You are viewing an <b>archived channel</b>. New messages cannot be posted.",values:{b:e=>L().createElement("b",null,e)}}),L().createElement("button",{className:"btn btn-primary channel-archived__close-btn",onClick:this.onClickCloseChannel},L().createElement(le.FormattedMessage,{id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"})))):this.props.missingChannelRole||this.state.waitForLoader?L().createElement(kn,{updateWaitForLoader:this.onUpdateInputShowLoader}):L().createElement("div",{id:"post-create","data-testid":"post-create",className:"post-create__container AdvancedTextEditor__ctr"},L().createElement(qn,null));const t=this.state.deferredPostView;return L().createElement("div",{ref:this.channelViewRef,id:"app-content",className:"app__content"},L().createElement(Bn,{overlayType:"center",id:de.nY}),L().createElement(Un,this.props),this.props.isChannelBookmarksEnabled&&L().createElement(Hn,{channelId:this.props.channelId}),L().createElement(jn,{channelId:this.props.channelId}),L().createElement(t,{channelId:this.props.channelId,focusedPostId:this.state.focusedPostId}),e)}}Fn(Vn,"createDeferredPostView",(()=>(0,ce.A)(Rn,L().createElement("div",{id:"post-list",className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0}))));const zn={goToLastViewedChannel:c.TJ},Gn=(0,a.connect)((function(e){const t=(0,r.Lw)(e),n=(0,i.zj)(e),a="true"===n.ExperimentalViewArchivedChannels,s="true"===n.EnableOnboardingFlow,c="true"===n.FeatureFlagWebSocketEventScope,d=function(e,t){var n;return!(t&&(null===(n=(0,r.M9)(e,t.id))||void 0===n?void 0:n.roles)||"").split(" ").some((t=>Boolean((0,ie.O0)(e)[t])))}(e,t);return{channelId:t?t.id:"",deactivatedChannel:!!t&&(0,r.nO)(e,t.id),enableOnboardingFlow:s,channelIsArchived:!!t&&0!==t.delete_at,viewArchivedChannels:a,isCloud:"true"===(0,i.Ay)(e).Cloud,teamUrl:(0,o._p)(e),isFirstAdmin:(0,l.OK)(e),enableWebSocketEventScope:c,isChannelBookmarksEnabled:(0,oe.wR)(e),missingChannelRole:d}}),zn),Wn=(0,O.withRouter)(Gn(Vn));function Kn(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Yn extends L().PureComponent{constructor(e){super(e),Kn(this,"replaceUrlIfPermalink",(()=>{this.props.match.params.postid&&(this.replaceUrlTimeout=setTimeout((()=>{const e=this.props.match.url.split("/").slice(0,-1).join("/");(0,nn.J)().replace(e)}),W.Ay.PERMALINK_FADEOUT))})),this.state={prevProps:e}}componentDidUpdate(e){this.props.match.params.team===e.match.params.team&&this.props.match.params.identifier===e.match.params.identifier||(clearTimeout(this.replaceUrlTimeout),this.props.actions.onChannelByIdentifierEnter(this.props),this.replaceUrlIfPermalink())}componentDidMount(){this.props.actions.onChannelByIdentifierEnter(this.props),this.replaceUrlIfPermalink()}componentWillUnmount(){clearTimeout(this.replaceUrlTimeout)}render(){return L().createElement(Wn,null)}}Kn(Yn,"propTypes",{match:F().shape({params:F().shape({identifier:F().string.isRequired,team:F().string.isRequired,postid:F().string,path:F().string.isRequired}).isRequired,url:F().string.isRequired}).isRequired,actions:F().shape({onChannelByIdentifierEnter:F().func.isRequired}).isRequired,history:F().any.isRequired});const Jn=(0,O.withRouter)((0,a.connect)(null,(function(e){return{actions:(0,j.bindActionCreators)({onChannelByIdentifierEnter:ee},e)}}))(Yn));var Qn=n(82739);const Zn=(0,D.S)("MobileChannelHeader",(0,P.lazy)((()=>Promise.all([n.e(8105),n.e(4446),n.e(285),n.e(8671)]).then(n.bind(n,88844))))),Xn=(0,D.S)("GlobalThreads",(0,P.lazy)((()=>n.e(7173).then(n.bind(n,77173)))),L().createElement("div",{className:"app__content"},L().createElement(ue.A,null))),$n=(0,D.S)("Drafts",(0,P.lazy)((()=>n.e(2794).then(n.bind(n,22794)))),L().createElement("div",{className:"app__content"},L().createElement(ue.A,null))),ea=(0,D.S)("PermalinkView",(0,P.lazy)((()=>n.e(1300).then(n.bind(n,21300))))),ta=(0,D.S)("PlaybookRunner",(0,P.lazy)((()=>n.e(7422).then(n.bind(n,87422)))));class na extends L().PureComponent{constructor(e){super(e),this.state={returnTo:"",lastReturnTo:""}}static getDerivedStateFromProps(e,t){return t.lastReturnTo!==e.location.pathname&&e.location.pathname.includes("/pl/")?{lastReturnTo:e.location.pathname,returnTo:t.lastReturnTo}:{lastReturnTo:e.location.pathname}}async componentDidMount(){const{actions:e}=this.props;await e.getProfiles()}render(){const{lastChannelPath:e,isCollapsedThreadsEnabled:t,isMobileView:n}=this.props,a=this.props.match.url;return L().createElement("div",{key:"inner-wrap",className:B()("inner-wrap","channel__wrap",{"move--right":this.props.lhsOpen,"move--left":this.props.rhsOpen,"move--left-small":this.props.rhsMenuOpen})},n&&L().createElement(Zn,null),L().createElement("div",{className:"row main"},L().createElement(O.Switch,null,L().createElement(O.Route,{path:"".concat(a,"/pl/:postid(").concat(Qn.Zv,")"),render:e=>L().createElement(ea,Object.assign({},e,{returnTo:this.state.returnTo}))}),L().createElement(O.Route,{path:"/:team(".concat(Qn.LD,")/:path(channels|messages)/:identifier(").concat(Qn.x,")/:postid(").concat(Qn.Zv,")?"),component:Jn}),L().createElement(O.Route,{path:"/:team(".concat(Qn.LD,")/_playbooks/:playbookId(").concat(Qn.Zv,")/run")},L().createElement(ta,null)),t?L().createElement(O.Route,{path:"/:team(".concat(Qn.LD,")/threads/:threadIdentifier(").concat(Qn.Zv,")?"),component:Xn}):null,L().createElement(O.Route,{path:"/:team(".concat(Qn.LD,")/drafts"),component:$n}),L().createElement(O.Route,{path:"/:team(".concat(Qn.LD,")/").concat(W.pj),component:$n}),L().createElement(O.Redirect,{to:e}))))}}const aa=(0,a.connect)(((e,t)=>{const n=(0,G.Gw)(e,t.match.params.team);let a=(0,G.y1)(e,t.match.params.team);const s=(0,G.Kf)(e),i=(0,o.Uj)(e,t.match.params.team);let c,u;return s!==(null==i?void 0:i.id)&&(c=(0,G.Jl)(e)),a||(a=(0,r.Dn)(e,i.id)),u=!(0,b.WW)(e)||c!==W.po.THREADS&&n!==W.po.THREADS?"".concat(t.match.url,"/channels/").concat(a):"".concat(t.match.url,"/threads"),{lastChannelPath:u,lhsOpen:(0,z.Cu)(e),rhsOpen:(0,d.A)(e),rhsMenuOpen:(0,d.ZE)(e),isCollapsedThreadsEnabled:(0,b.WW)(e),currentUserId:(0,l.WR)(e),isMobileView:(0,q.w3)(e)}}),(function(e){return{actions:(0,j.bindActionCreators)({getProfiles:V.r7},e)}})),sa=(0,O.withRouter)(aa(na));n(36169),n(30973);var ra=n(79751);const ia=function(){const e=(0,O.useLocation)(),t=(0,a.useDispatch)(),n=(0,O.useHistory)(),s={open_invitation_modal:{modalId:W.IQ.INVITATION,dialogType:Et.default}};return(0,P.useEffect)((()=>{const a=new URLSearchParams(e.search),r=a.get("action");r&&s[r]&&(t((0,ra.q)(s[r])),a.delete("action"),n.replace({search:a.toString()}))}),[e,s]),null};var oa=n(4629),la=n(16983),ca=n(80635),da=n(52073),ua=n(2386),ma=n(9916),ha=n(98496);function pa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ga(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pa(Object(n),!0).forEach((function(t){fa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fa(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let ba=!0;function Ea(e){return(t,n)=>{var a,s,i;const o=n(),l=(0,r.L9)(o);(0,be.sx)("performance","preloaded_channels",{numHigh:(null===(a=e[1])||void 0===a?void 0:a.length)||0,numMedium:(null===(s=e[2])||void 0===s?void 0:s.length)||0,numLow:(null===(i=e[3])||void 0===i?void 0:i.length)||0,numTotal:l.length,isFirstPreload:ba}),ba=!1}}var va=function(e){return e[e.high=1]="high",e[e.medium=2]="medium",e[e.low=3]="low",e}(va||{}),Ca=function(e){return e[e.mentionMax=10]="mentionMax",e[e.unreadMax=20]="unreadMax",e}(Ca||{});const _a=(0,pe.el)(((e,t,n)=>{const a=e.length;let s={[va.high]:[],[va.medium]:[],[va.low]:[]};if(!a||a>Ca.unreadMax)return s;for(const r of e){const e=r.id,i=t[e];if(a>=Ca.mentionMax&&s[va.high].length>=Ca.mentionMax)break;i&&!(0,et.X4)(i)&&((n?i.mention_count_root:i.mention_count)?s=ga(ga({},s),{},{[va.high]:[...s[va.high],e]}):i.notify_props&&"mention"!==i.notify_props.mark_unread&&a<Ca.mentionMax&&(s=ga(ga({},s),{},{[va.medium]:[...s[va.medium],e]})))}return s}));var ya=n(79030),Ma=n(65357);function Ta(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Sa=new ya.A({concurrency:2});class wa extends L().PureComponent{constructor(){super(...arguments),Ta(this,"prefetchPosts",(e=>{let t;const n=this.props.unreadChannels.find((t=>e===t.id));return!n||n.type!==W.YM.PRIVATE_CHANNEL&&n.type!==W.YM.OPEN_CHANNEL||Date.now()-n.last_post_at<=1e3&&(t=1e3*Math.random()),this.props.actions.prefetchChannelPosts(e,t)})),Ta(this,"prefetchData",(()=>{const{prefetchRequestStatus:e,prefetchQueueObj:t}=this.props;for(const n in t){if(!Object.hasOwn(t,n))continue;const a=t[n];for(const t of a)Object.hasOwn(e,t)||Sa.add((async()=>this.prefetchPosts(t)))}}))}async componentDidUpdate(e){const{currentChannelId:t,prefetchQueueObj:n,sidebarLoaded:a}=this.props;a&&!e.sidebarLoaded&&(0,Ma.mp)(),!t||!a||e.currentChannelId&&e.sidebarLoaded?e.prefetchQueueObj!==n&&(clearTimeout(this.prefetchTimeout),await Sa.clear(),this.prefetchData()):(Sa.add((async()=>this.prefetchPosts(t))),this.prefetchData()),!t||!a||e.currentChannelId&&e.sidebarLoaded||this.props.actions.trackPreloadedChannels(n)}render(){return null}}function Ia(e){return(0,ma.WJ)(e).length>0}Ta(wa,"propTypes",{currentChannelId:F().string.isRequired,prefetchQueueObj:F().objectOf(F().arrayOf(F().string)).isRequired,prefetchRequestStatus:F().objectOf(F().string).isRequired,sidebarLoaded:F().bool.isRequired,unreadChannels:F().array.isRequired,actions:F().shape({prefetchChannelPosts:F().func.isRequired,trackPreloadedChannels:F().func.isRequired}).isRequired});const Aa=(0,a.connect)((function(e){const t=e.views.channel.lastUnreadChannel,n=(0,f.vd)(e),a=(0,r.OM)(e,t),s=_a(a,n,(0,b.WW)(e)),i=e.views.channel.channelPrefetchStatus;return{currentChannelId:(0,r.eH)(e),prefetchQueueObj:s,prefetchRequestStatus:i,sidebarLoaded:Ia(e),unreadChannels:a}}),(function(e){return{actions:(0,j.bindActionCreators)({prefetchChannelPosts:c.At,trackPreloadedChannels:Ea},e)}}))(wa);var Na=n(71769),Ra=n(7021);function Pa(e){let{children:t,id:n,className:a}=e;const s=(0,P.useRef)(null);return L().createElement("div",{id:n,className:a,ref:s},t,L().createElement(Ra.A,{name:"lhsResizeHandle",globalCssVar:Na.Oq.LHS,defaultWidth:Na.LA,dir:Na.Cr.LEFT,containerRef:s}))}Pa.propTypes={children:F().node.isRequired};const La=Pa;var Oa=n(74754),ka=n(30135),Da=n(31892),xa=n(70669),Fa=n(8283),Ua=n(87364),Ba=n(8610),Ha=n(3289),qa=n(86145),ja=n(52231);function Va(e){var t;const n=(0,a.useSelector)(i.Ay),s=(0,a.useSelector)(i.zj),r=(0,a.useSelector)((e=>(0,ie.y4)(e,{permission:me.xB.CREATE_TEAM}))),l=(0,a.useSelector)((e=>(0,ca.pU)(e,me.xB.MANAGE_TEAM))),c=(0,a.useSelector)((e=>(0,ca.pU)(e,me.xB.ADD_USER_TO_TEAM))),d=(0,a.useSelector)((e=>(0,ca.pU)(e,me.xB.INVITE_GUEST))),u=(0,ja.P3)(n),m="true"===(null==s?void 0:s.EnableGuestAccounts),h=Boolean(null===(t=e.currentTeam)||void 0===t?void 0:t.group_constrained),p="true"===(null==n?void 0:n.LDAPGroups),g=s.ExperimentalPrimaryTeam,f=(0,a.useSelector)(o.sZ),b=(null==f?void 0:f.length)>0,E=!g&&b,v=e.currentTeam.description?e.currentTeam.description:e.currentTeam.display_name;return L().createElement(xa.mc,{menuButton:{id:"sidebarTeamMenuButton",class:"btn btn-sm btn-quaternary btn-inverted",children:L().createElement(L().Fragment,null,L().createElement("span",null,e.currentTeam.display_name),L().createElement("i",{className:"icon icon-chevron-down"}))},menuButtonTooltip:{text:v},menu:{id:"sidebarTeamMenu"}},(m&&d||c)&&L().createElement(za,null),h&&p&&l&&L().createElement(Ga,null),l&&L().createElement(Wa,null),L().createElement(Ka,null),h&&p&&l&&L().createElement(Ya,{teamID:e.currentTeam.id}),!h&&g!==e.currentTeam.name&&L().createElement(Ja,null),(E||r)&&L().createElement(xa.wv,null),E&&L().createElement(Qa,null),r&&L().createElement(Za,{isCloud:u}),L().createElement(xa.wv,null),L().createElement(es,null),L().createElement(ts,null))}function za(e){const t=(0,a.useDispatch)(),n=(0,P.useCallback)((()=>{t((0,ra.q)({modalId:W.IQ.INVITATION,dialogType:Et.default,dialogProps:{focusOriginElement:"sidebarTeamMenuButton"}}))}),[t]);return L().createElement(xa.q7,Object.assign({onClick:n,leadingElement:L().createElement(Ge.AccountMultiplePlusOutlineIcon,{size:18,"aria-hidden":"true"}),labels:L().createElement(L().Fragment,null,L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.invitePeopleMenuItem.primaryLabel",defaultMessage:"Invite people"}),L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.invitePeopleMenuItem.secondaryLabel",defaultMessage:"Add or invite people to the team"})),"aria-haspopup":"dialog"},e))}function Ga(e){const t=(0,a.useDispatch)(),n=(0,P.useCallback)((()=>{t((0,ra.q)({modalId:W.IQ.ADD_GROUPS_TO_TEAM,dialogType:tt.A,dialogProps:{focusOriginElement:"sidebarTeamMenuButton"}}))}),[t]);return L().createElement(xa.q7,Object.assign({onClick:n,leadingElement:L().createElement(Ge.AccountPlusOutlineIcon,{size:18,"aria-hidden":"true"}),labels:L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.addGroupsToTeamMenuItem.primaryLabel",defaultMessage:"Add groups"}),"aria-haspopup":"dialog"},e))}function Wa(e){const t=(0,a.useDispatch)(),n=(0,P.useCallback)((()=>{t((0,ra.q)({modalId:W.IQ.TEAM_SETTINGS,dialogType:Ba.A,dialogProps:{focusOriginElement:"sidebarTeamMenuButton"}}))}),[t]);return L().createElement(xa.q7,Object.assign({leadingElement:L().createElement(Ge.SettingsOutlineIcon,{size:18,"aria-hidden":"true"}),onClick:n,labels:L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.teamSettingsMenuItem.primaryLabel",defaultMessage:"Team settings"}),"aria-haspopup":"dialog"},e))}function Ka(e){const t=(0,a.useDispatch)(),n=(0,a.useSelector)((e=>(0,ca.pU)(e,me.xB.REMOVE_USER_FROM_TEAM))),s=(0,a.useSelector)((e=>(0,ca.pU)(e,me.xB.MANAGE_TEAM_ROLES))),r=(0,P.useCallback)((()=>{t((0,ra.q)({modalId:W.IQ.TEAM_MEMBERS,dialogType:Ua.A,dialogProps:{focusOriginElement:"sidebarTeamMenuButton"}}))}),[t]);let i=L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.viewMembersMenuItem.primaryLabel",defaultMessage:"View members"});return n&&s&&(i=L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.manageMembersMenuItem.primaryLabel",defaultMessage:"Manage members"})),L().createElement(xa.q7,Object.assign({leadingElement:L().createElement(Ge.AccountMultipleOutlineIcon,{size:18,"aria-hidden":"true"}),onClick:r,labels:i,"aria-haspopup":"dialog"},e))}function Ya(e){let{teamID:t}=e;const n=(0,a.useDispatch)(),s=(0,P.useCallback)((()=>{n((0,ra.q)({modalId:W.IQ.MANAGE_TEAM_GROUPS,dialogType:Fa.A,dialogProps:{teamID:t}}))}),[n,t]);return L().createElement(xa.q7,{leadingElement:L().createElement(Ge.MonitorAccountIcon,{size:18,"aria-hidden":"true"}),onClick:s,labels:L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.manageGroupsMenuItem.primaryLabel",defaultMessage:"Manage groups"}),"aria-haspopup":"dialog"})}function Ja(){const e=(0,a.useDispatch)(),t=(0,P.useCallback)((()=>{e((0,ra.q)({modalId:W.IQ.LEAVE_TEAM,dialogType:Da.A}))}),[e]);return L().createElement(xa.q7,{leadingElement:L().createElement(Ge.ExitToAppIcon,{size:18,"aria-hidden":"true"}),onClick:t,isDestructive:!0,labels:L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.leaveTeamMenuItem.primaryLabel",defaultMessage:"Leave team"}),"aria-haspopup":"dialog"})}function Qa(){const e=(0,O.useHistory)(),t=(0,P.useCallback)((()=>{e.push("/select_team")}),[e]);return L().createElement(xa.q7,{leadingElement:L().createElement(Ge.MessagePlusOutlineIcon,{size:18,"aria-hidden":"true"}),onClick:t,labels:L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.joinAnotherTeamMenuItem.primaryLabel",defaultMessage:"Join another team"})})}function Za(e){let{isCloud:t}=e;const n=(0,O.useHistory)(),s=(0,a.useSelector)(qe.dw),r=(0,a.useSelector)(qe.Pd),i=t&&"true"===(null==s?void 0:s.is_free_trial),o=t&&(null==r?void 0:r.sku)===W.YE.STARTER,l=(0,ka.A)(),c=o&&!i&&l.teams.active>=0,d=t&&(i||c),u=(0,P.useCallback)((()=>{c||d||n.push("/create_team")}),[n,c]);return L().createElement(xa.q7,{leadingElement:L().createElement(Ge.PlusIcon,{size:18,"aria-hidden":"true"}),onClick:u,labels:L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.createTeamMenuItem.primaryLabel",defaultMessage:"Create a team"}),trailingElements:d&&L().createElement(Xa,{isFreeTrial:i})})}function Xa(e){let{isFreeTrial:t}=e;const{formatMessage:n}=(0,le.useIntl)();return L().createElement(Ha.A,{feature:W.W0.CREATE_MULTIPLE_TEAMS,minimumPlanRequiredForFeature:W.gS.Professional,blocked:!t,tooltipMessage:n({id:"navbar_dropdown.create.tooltip.cloudFreeTrial",defaultMessage:"During your trial you are able to create multiple teams. These teams will be archived after your trial."}),titleAdminPreTrial:n({id:"navbar_dropdown.create.modal.titleAdminPreTrial",defaultMessage:"Try unlimited teams with a free trial"}),messageAdminPreTrial:n({id:"navbar_dropdown.create.modal.messageAdminPreTrial",defaultMessage:"Create unlimited teams with one of our paid plans. Get the full experience of Enterprise when you start a free, {trialLength} day trial."},{trialLength:qa.$w}),titleAdminPostTrial:n({id:"navbar_dropdown.create.modal.titleAdminPostTrial",defaultMessage:"Upgrade to create unlimited teams"}),messageAdminPostTrial:n({id:"navbar_dropdown.create.modal.messageAdminPostTrial",defaultMessage:"Multiple teams allow for context-specific spaces that are more attuned to your and your teams' needs. Upgrade to the Professional plan to create unlimited teams."}),titleEndUser:n({id:"navbar_dropdown.create.modal.titleEndUser",defaultMessage:"Multiple teams available in paid plans"}),messageEndUser:n({id:"navbar_dropdown.create.modal.messageEndUser",defaultMessage:"Multiple teams allow for context-specific spaces that are more attuned to your teams' needs."})})}Za.propTypes={isCloud:F().bool.isRequired};const $a="https://mattermost.com/pl/mattermost-academy-team-training";function es(){const e=(0,P.useCallback)((()=>{window.open($a,"_blank","noopener noreferrer")}),[]);return L().createElement(xa.q7,{className:"learnAboutTeamsMenuItem",onClick:e,leadingElement:L().createElement(Ge.LightbulbOutlineIcon,{size:18,"aria-hidden":"true"}),labels:L().createElement(le.FormattedMessage,{id:"sidebarLeft.teamMenu.learnAboutTeamsMenuItem.primaryLabel",defaultMessage:"Learn about teams"})})}function ts(){const e=(0,a.useSelector)(Tt.Ui);if(e.length>0){const t=e.map((e=>L().createElement(xa.q7,{id:"".concat(e.id,"_pluginmenuitem"),key:e.id,onClick:function(){e.action&&e.action()},labels:L().createElement("span",null,e.text)})));return L().createElement(L().Fragment,null,L().createElement(xa.wv,null),t)}return null}const ns=e=>{const t=(0,a.useSelector)(o.H7);return t?L().createElement("header",{className:"sidebarHeaderContainer"},L().createElement(Va,{currentTeam:t}),(e.canCreateChannel||e.canJoinPublicChannel)&&L().createElement(Oa.Ay,{canCreateChannel:e.canCreateChannel,onCreateNewChannelClick:e.showNewChannelModal,canJoinPublicChannel:e.canJoinPublicChannel,onBrowseChannelClick:e.showMoreChannelsModal,onOpenDirectMessageClick:e.handleOpenDirectMessagesModal,canCreateCustomGroups:e.canCreateCustomGroups,onCreateNewUserGroupClick:e.showCreateUserGroupModal,unreadFilterEnabled:e.unreadFilterEnabled,onCreateNewCategoryClick:e.showCreateCategoryModal,onInvitePeopleClick:e.invitePeopleModal})):null};ns.propTypes={showNewChannelModal:F().func.isRequired,showMoreChannelsModal:F().func.isRequired,showCreateUserGroupModal:F().func.isRequired,invitePeopleModal:F().func.isRequired,showCreateCategoryModal:F().func.isRequired,canCreateChannel:F().bool.isRequired,canJoinPublicChannel:F().bool.isRequired,handleOpenDirectMessagesModal:F().func.isRequired,unreadFilterEnabled:F().bool.isRequired,canCreateCustomGroups:F().bool.isRequired};const as=ns;var ss=n(14696),rs=n(63669),is=n(92243),os=n(32269),ls=n(4565),cs=n(26562),ds=n(30138);function us(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ms="channel";class hs extends L().PureComponent{constructor(e){super(e),us(this,"focusTextbox",(()=>{if(null===this.switchBox)return;const e=this.switchBox.getTextbox();document.activeElement!==e&&(e.focus(),X.PO(e))})),us(this,"setSwitchBoxRef",(e=>{this.switchBox=e,this.focusTextbox()})),us(this,"hideOnSelect",(()=>{this.focusPostTextbox(),this.setState({text:""}),this.props.onExited()})),us(this,"focusPostTextbox",(()=>{ye.Fr()||setTimeout((()=>{const e=document.querySelector("#post_textbox");e&&e.focus()}))})),us(this,"hideOnCancel",(()=>{var e,t;null===(e=(t=this.props).onExited)||void 0===e||e.call(t),(0,ds.p)(this.props.focusOriginElement,!0)})),us(this,"onChange",(e=>{this.setState({text:e.target.value,shouldShowLoadingSpinner:!0})})),us(this,"handleSubmit",(async e=>{if(e)if(this.props.rhsOpen&&this.props.rhsState===W._n.EDIT_HISTORY&&this.props.actions.closeRightHandSide(),this.state.mode===ms){const{joinChannelById:t,switchToChannel:n}=this.props.actions,a=e.channel;e.type===W.Ay.MENTION_MORE_CHANNELS&&a.type===W.Ay.OPEN_CHANNEL&&await t(a.id),n(a).then((e=>{"data"in e&&this.hideOnSelect()}))}else(0,nn.J)().push("/"+e.name),this.hideOnSelect()})),us(this,"handleSuggestionsReceived",(e=>{const t=e.items.some((e=>e.loading));this.setState({shouldShowLoadingSpinner:t,pretext:e.matchedPretext,hasSuggestions:e.items.length>0})})),us(this,"render",(()=>{const e=this.channelProviders,t=L().createElement("h2",{id:"quickSwitchHeader"},L().createElement(le.FormattedMessage,{id:"quick_switch_modal.switchChannels",defaultMessage:"Find Channels"}));let n;n=this.props.isMobileView?L().createElement(le.FormattedMessage,{id:"quick_switch_modal.help_mobile",defaultMessage:"Type to find a channel."}):L().createElement(le.FormattedMessage,{id:"quickSwitchModal.help_no_team",defaultMessage:"Type to find a channel. Use <b>UP/DOWN</b> to browse, <b>ENTER</b> to select, <b>ESC</b> to dismiss.",values:{b:e=>L().createElement("b",null,e)}});const a=L().createElement("div",{className:"channel-switcher__header"},t),s=L().createElement("div",{className:"channel-switcher__hint",id:"quickSwitchHint"},n);return L().createElement(ss.zW,{className:"a11y__modal channel-switcher",id:"quickSwitchModal",show:!0,bodyPadding:!1,enforceFocus:!1,onExited:this.hideOnCancel,onHide:this.hideOnCancel,ariaLabel:this.props.intl.formatMessage({id:"quick_switch_modal.switchChannels",defaultMessage:"Find Channels"}),modalHeaderText:a,modalSubheaderText:s,compassDesign:!0},L().createElement("div",{className:"channel-switcher__suggestion-box"},L().createElement("i",{className:"icon icon-magnify icon-16"}),L().createElement(os.A,{ref:this.setSwitchBoxRef,id:"quickSwitchInput","aria-label":this.props.intl.formatMessage({id:"quick_switch_modal.input",defaultMessage:"quick switch input"}),className:"form-control focused",onChange:this.onChange,value:this.state.text,onItemSelected:this.handleSubmit,listComponent:ls.A,listPosition:"bottom",maxLength:"64",providers:e,completeOnTab:!1,spellCheck:"false",delayInputUpdate:!0,openWhenEmpty:!0,onSuggestionsReceived:this.handleSuggestionsReceived,forceSuggestionsWhenBlur:!0,renderDividers:[W.Ay.MENTION_UNREAD,W.Ay.MENTION_RECENT_CHANNELS],shouldSearchCompleteText:!0}),!this.state.shouldShowLoadingSpinner&&!this.state.hasSuggestions&&this.state.text&&L().createElement(rs.A,{variant:is.L.Search,titleValues:{channelName:"".concat(this.state.pretext)}})))})),this.channelProviders=[new cs.A],this.switchBox=null,this.state={text:"",mode:ms,hasSuggestions:!0,shouldShowLoadingSpinner:!0,pretext:""}}}us(hs,"propTypes",{onExited:F().func.isRequired,isMobileView:F().bool.isRequired,rhsOpen:F().bool,actions:F().shape({joinChannelById:F().func.isRequired,switchToChannel:F().func.isRequired,closeRightHandSide:F().func.isRequired}).isRequired,focusOriginElement:F().string.isRequired});const ps=(0,le.injectIntl)(hs),gs=(0,a.connect)((function(e){return{isMobileView:(0,q.w3)(e),rhsState:(0,d.bM)(e),rhsOpen:(0,d.A)(e)}}),(function(e){return{actions:(0,j.bindActionCreators)({joinChannelById:c.yO,switchToChannel:c.BX,closeRightHandSide:ua.bP},e)}}))(ps);var fs=n(87131),bs=n(61190);function Es(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const vs=(0,le.defineMessages)({disableTooltip:{id:"sidebar_left.channel_filter.showAllChannels",defaultMessage:"Show all channels"},enableTooltip:{id:"sidebar_left.channel_filter.filterByUnread",defaultMessage:"Filter by unread"}}),Cs={default:[bs.f.ctrl,bs.f.shift,"U"],mac:[bs.f.cmd,bs.f.shift,"U"]};class _s extends L().PureComponent{constructor(){super(...arguments),Es(this,"handleUnreadFilterClick",(e=>{null==e||e.preventDefault(),null==e||e.stopPropagation(),this.toggleUnreadFilter()})),Es(this,"handleUnreadFilterKeyPress",(e=>{sn.r(e)&&e.shiftKey&&sn.e(e,W.Ay.KeyCodes.U)&&(e.preventDefault(),e.stopPropagation(),this.toggleUnreadFilter())})),Es(this,"toggleUnreadFilter",(()=>{const{unreadFilterEnabled:e}=this.props;e?(0,be.sx)("ui","ui_sidebar_unread_filter_disabled"):(0,be.sx)("ui","ui_sidebar_unread_filter_enabled"),this.props.actions.setUnreadFilterEnabled(!e)}))}componentDidMount(){document.addEventListener("keydown",this.handleUnreadFilterKeyPress)}componentWillUnmount(){document.removeEventListener("keydown",this.handleUnreadFilterKeyPress)}render(){const{intl:e,unreadFilterEnabled:t}=this.props,n=e.formatMessage({id:"sidebar_left.channel_filter.filterUnreadAria",defaultMessage:"unreads filter"});return L().createElement("div",{className:"SidebarFilters"},L().createElement(fs.A,{title:t?vs.disableTooltip:vs.enableTooltip,shortcut:Cs},L().createElement("a",{href:"#",className:B()("SidebarFilters_filterButton",{active:t}),onClick:this.toggleUnreadFilter,"aria-label":n},L().createElement("i",{className:"icon icon-filter-variant"}))))}}Es(_s,"propTypes",{unreadFilterEnabled:F().bool.isRequired,actions:F().shape({setUnreadFilterEnabled:F().func.isRequired}).isRequired});const ys=(0,le.injectIntl)(_s),Ms=(0,a.connect)((function(e){const t=(0,o.vt)(e);return{hasMultipleTeams:t&&t.length>1,unreadFilterEnabled:(0,ma.ZM)(e)}}),(function(e){return{actions:(0,j.bindActionCreators)({setUnreadFilterEnabled:da.zk},e)}}))(ys);function Ts(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ss extends L().PureComponent{constructor(){super(...arguments),Ts(this,"openQuickSwitcher",(e=>{e.preventDefault(),(0,be.sx)("ui","ui_sidebar_open_channel_switcher_v2"),this.props.actions.openModal({modalId:W.IQ.QUICK_SWITCH,dialogType:gs,dialogProps:{focusOriginElement:"SidebarChannelNavigatorButton"}})})),Ts(this,"handleShortcut",(e=>{const{actions:{closeModal:t}}=this.props;sn.r(e)&&e.shiftKey&&(sn.e(e,W.Ay.KeyCodes.M)&&(e.preventDefault(),t(W.IQ.QUICK_SWITCH)),sn.e(e,W.Ay.KeyCodes.L)&&t(W.IQ.QUICK_SWITCH))})),Ts(this,"handleQuickSwitchKeyPress",(e=>{sn.r(e)&&!e.shiftKey&&sn.e(e,W.Ay.KeyCodes.K)&&(e.altKey||X.Xz(e)||(e.preventDefault(),this.toggleQuickSwitchModal()))})),Ts(this,"toggleQuickSwitchModal",(()=>{const{isQuickSwitcherOpen:e,actions:{openModal:t,closeModal:n}}=this.props;e?n(W.IQ.QUICK_SWITCH):t({modalId:W.IQ.QUICK_SWITCH,dialogType:gs,dialogProps:{focusOriginElement:"SidebarChannelNavigatorButton"}})}))}componentDidMount(){document.addEventListener("keydown",this.handleShortcut),document.addEventListener("keydown",this.handleQuickSwitchKeyPress)}componentWillUnmount(){document.removeEventListener("keydown",this.handleShortcut),document.removeEventListener("keydown",this.handleQuickSwitchKeyPress)}render(){return L().createElement("div",{className:"SidebarChannelNavigator webapp"},!this.props.showUnreadsCategory&&L().createElement(Ms,null),L().createElement("button",{className:"SidebarChannelNavigator_jumpToButton",onClick:this.openQuickSwitcher,"aria-label":this.props.intl.formatMessage({id:"sidebar_left.channel_navigator.channelSwitcherLabel",defaultMessage:"Channel Switcher"}),"aria-haspopup":"dialog","data-testid":"SidebarChannelNavigatorButton",id:"SidebarChannelNavigatorButton"},L().createElement("i",{className:"icon icon-magnify"}),L().createElement(le.FormattedMessage,{id:"sidebar_left.channel_navigator.jumpTo",defaultMessage:"Find channel"}),L().createElement("div",{className:"SidebarChannelNavigator_shortcutText"},"".concat(ye.cX()?"âŒ˜":"Ctrl+","K"))))}}Ts(Ss,"propTypes",{showUnreadsCategory:F().bool.isRequired,isQuickSwitcherOpen:F().bool.isRequired,actions:F().shape({openModal:F().func.isRequired,closeModal:F().func.isRequired}).isRequired});const ws=(0,le.injectIntl)(Ss),Is=(0,a.connect)((function(e){return{showUnreadsCategory:(0,b.pE)(e),isQuickSwitcherOpen:(0,ha.o)(e,W.IQ.QUICK_SWITCH)}}),(function(e){return{actions:(0,j.bindActionCreators)({openModal:ra.q,closeModal:ra.O},e)}}))(ws);var As=n(62563),Ns=n(62844),Rs=(n(6889),n(46177)),Ps=n.n(Rs),Ls=n(22005),Os=n(35880),ks=n(77234),Ds=n(35631),xs=n(16602),Fs=n(8907),Us=n(22789),Bs=n(19202);function Hs(e){const t=(0,le.useIntl)(),n=(0,P.useCallback)((()=>{e.actions.deleteCategory(e.category.id)}),[e.actions.deleteCategory,e.category]);return L().createElement(ss.zW,{compassDesign:!0,ariaLabel:t.formatMessage({id:"delete_category_modal.deleteCategory",defaultMessage:"Delete this category?"}),onExited:e.onExited,modalHeaderText:L().createElement(le.FormattedMessage,{id:"delete_category_modal.deleteCategory",defaultMessage:"Delete this category?"}),handleCancel:e.onExited,handleConfirm:n,confirmButtonText:L().createElement(le.FormattedMessage,{id:"delete_category_modal.delete",defaultMessage:"Delete"}),confirmButtonClassName:"delete"},L().createElement("span",{className:"delete-category__helpText"},L().createElement(le.FormattedMessage,{id:"delete_category_modal.helpText",defaultMessage:"Channels in <b>{category_name}</b> will move back to the Channels and Direct messages categories. You're not removed from any channels.",values:{category_name:e.category.display_name,b:e=>L().createElement("b",null,e)}})))}Hs.propTypes={onExited:F().func.isRequired,actions:F().shape({deleteCategory:F().func.isRequired}).isRequired},(0,le.defineMessages)({cancel:{id:"generic_modal.cancel",defaultMessage:"Cancel"},confirm:{id:"generic_modal.confirm",defaultMessage:"Confirm"},paginationCount:{id:"footer_pagination.count",defaultMessage:"Showing {startCount, number}-{endCount, number} of {total, number}"},paginationNext:{id:"footer_pagination.next",defaultMessage:"Next"},paginationPrev:{id:"footer_pagination.prev",defaultMessage:"Previous"}});const qs=(0,a.connect)(null,(function(e){return{actions:(0,j.bindActionCreators)({deleteCategory:oa.K7},e)}}))(Hs);var js=n(12555),Vs=n(19174),zs=n(51877),Gs=n(77813);const Ws=e=>{let{category:t}=e;const n=(0,a.useDispatch)(),r=(0,a.useSelector)(b.pE),i=(0,P.useMemo)(ma.vk,[t]),o=(0,a.useSelector)((e=>i(e,t))),{formatMessage:l}=(0,le.useIntl)();let c=null;if(t.type!==Fs.e.DIRECT_MESSAGES){function v(){n((0,oa.qh)(t.id,!t.muted))}c=L().createElement(xa.q7,{id:"mute-".concat(t.id),onClick:v,leadingElement:L().createElement(Ge.BellOutlineIcon,{size:18}),labels:t.muted?L().createElement(le.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.unmuteCategory",defaultMessage:"Unmute Category"}):L().createElement(le.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.muteCategory",defaultMessage:"Mute Category"})})}let d=null,u=null;if(t.type===Fs.e.CUSTOM){function C(){n((0,ra.q)({modalId:W.IQ.DELETE_CATEGORY,dialogType:qs,dialogProps:{category:t}}))}function _(){n((0,ra.q)({modalId:W.IQ.EDIT_CATEGORY,dialogType:js.default,dialogProps:{categoryId:t.id,initialCategoryName:t.display_name}}))}d=L().createElement(xa.q7,{id:"delete-".concat(t.id),isDestructive:!0,"aria-haspopup":!0,onClick:C,leadingElement:L().createElement(Ge.TrashCanOutlineIcon,{size:18}),labels:L().createElement(le.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.deleteCategory",defaultMessage:"Delete Category"})}),u=L().createElement(xa.q7,{id:"rename-".concat(t.id),onClick:_,"aria-haspopup":!0,leadingElement:L().createElement(Ge.PencilOutlineIcon,{size:18}),labels:L().createElement(le.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.renameCategory",defaultMessage:"Rename Category"})})}function m(e){n((0,oa.rV)(t.id,e)),(0,be.sx)("ui","ui_sidebar_sort_dm_".concat(e))}let h=L().createElement(le.FormattedMessage,{id:"sidebar.sortedManually",defaultMessage:"Manually"}),p=L().createElement(Ge.FormatListBulletedIcon,{size:18});t.sorting===xs.b.Alphabetical?(h=L().createElement(le.FormattedMessage,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),p=L().createElement(Ge.SortAlphabeticalAscendingIcon,{size:18})):t.sorting===xs.b.Recency&&(h=L().createElement(le.FormattedMessage,{id:"user.settings.sidebar.recent",defaultMessage:"Recent Activity"}),p=L().createElement(Ge.ClockOutlineIcon,{size:18}));const g=L().createElement(xa.g8,{id:"sortChannels-".concat(t.id),leadingElement:p,labels:L().createElement(le.FormattedMessage,{id:"sidebar.sort",defaultMessage:"Sort"}),trailingElements:L().createElement(L().Fragment,null,h,L().createElement(Ge.ChevronRightIcon,{size:16})),menuId:"sortChannels-".concat(t.id,"-menu"),menuAriaLabel:l({id:"sidebar_left.sidebar_category_menu.sort.dropdownAriaLabel",defaultMessage:"Sort submenu"})},L().createElement(xa.q7,{id:"sortAplhabetical-".concat(t.id),labels:L().createElement(le.FormattedMessage,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),onClick:()=>m(xs.b.Alphabetical),trailingElements:t.sorting===xs.b.Alphabetical?L().createElement(Ge.CheckIcon,{size:16}):null}),L().createElement(xa.q7,{id:"sortByMostRecent-".concat(t.id),labels:L().createElement(le.FormattedMessage,{id:"sidebar.sortedByRecencyLabel",defaultMessage:"Recent Activity"}),onClick:()=>m(xs.b.Recency),trailingElements:t.sorting===xs.b.Recency?L().createElement(Ge.CheckIcon,{size:16}):null}),L().createElement(xa.q7,{id:"sortManual-".concat(t.id),labels:L().createElement(le.FormattedMessage,{id:"sidebar.sortedManually",defaultMessage:"Manually"}),onClick:()=>m(xs.b.Manual),trailingElements:t.sorting===xs.b.Manual?L().createElement(Ge.CheckIcon,{size:16}):null})),f=(0,P.useCallback)((()=>{n((0,s.Zi)(o)),(0,be.sx)("ui","ui_sidebar_category_menu_viewCategory")}),[n,o]),E=!1===r?L().createElement(zs.A,{id:t.id,handleViewCategory:f,numChannels:o.length}):null;return L().createElement(Gs.A,{id:t.id,name:t.display_name},E,E&&L().createElement(xa.wv,null),c,u,d,L().createElement(xa.wv,null),g,L().createElement(xa.wv,null),L().createElement(Vs.A,{id:t.id}))},Ks=(0,P.memo)(Ws),Ys=e=>{let{category:t,handleOpenDirectMessagesModal:n}=e;const[s,r]=(0,P.useState)(!1),{formatMessage:i}=(0,le.useIntl)(),o=(0,a.useDispatch)(),c=(0,a.useSelector)(b.pR),d=(0,a.useSelector)(l.WR);function u(e){o((0,oa.rV)(t.id,e)),(0,be.sx)("ui","ui_sidebar_sort_dm_".concat(e))}let m=L().createElement(Ge.ClockOutlineIcon,{size:18}),h=L().createElement(le.FormattedMessage,{id:"user.settings.sidebar.recent",defaultMessage:"Recent Activity"});t.sorting===xs.b.Alphabetical&&(h=L().createElement(le.FormattedMessage,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),m=L().createElement(Ge.SortAlphabeticalAscendingIcon,{size:18}));const p=L().createElement(xa.g8,{id:"sortDirectMessages-".concat(t.id),leadingElement:m,labels:L().createElement(le.FormattedMessage,{id:"sidebar.sort",defaultMessage:"Sort"}),trailingElements:L().createElement(L().Fragment,null,h,L().createElement(Ge.ChevronRightIcon,{size:16})),menuId:"sortDirectMessages-".concat(t.id,"-menu")},L().createElement(xa.q7,{id:"sortAlphabetical-".concat(t.id),labels:L().createElement(le.FormattedMessage,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),onClick:()=>u(xs.b.Alphabetical),trailingElements:t.sorting===xs.b.Alphabetical?L().createElement(Ge.CheckIcon,{size:16}):null}),L().createElement(xa.q7,{id:"sortByMostRecent-".concat(t.id),labels:L().createElement(le.FormattedMessage,{id:"sidebar.sortedByRecencyLabel",defaultMessage:"Recent Activity"}),onClick:()=>u(xs.b.Recency),trailingElements:t.sorting===xs.b.Recency?L().createElement(Ge.CheckIcon,{size:16}):null}));let g=L().createElement("span",null,c);1e4===c&&(g=L().createElement(le.FormattedMessage,{id:"channel_notifications.levels.all",defaultMessage:"All"}));const f=L().createElement(xa.g8,{id:"showMessagesCount-".concat(t.id),leadingElement:L().createElement(Ge.AccountMultipleOutlineIcon,{size:18}),labels:L().createElement(le.FormattedMessage,{id:"sidebar.show",defaultMessage:"Show"}),trailingElements:L().createElement(L().Fragment,null,g,L().createElement(Ge.ChevronRightIcon,{size:16})),menuId:"showMessagesCount-".concat(t.id,"-menu")},W.Ay.DM_AND_GM_SHOW_COUNTS.map((e=>L().createElement(xa.q7,{id:"showDmCount-".concat(t.id,"-").concat(e),key:"showDmCount-".concat(t.id,"-").concat(e),labels:L().createElement("span",null,e),onClick:()=>{return t=e,void o((0,Ds.SF)(d,[{user_id:d,category:W.Ay.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:me.pm.LIMIT_VISIBLE_DMS_GMS,value:t.toString()}]));var t},trailingElements:c===e?L().createElement(Ge.CheckIcon,{size:16}):null})))),E=L().createElement(xa.q7,{id:"openDirectMessage-".concat(t.id),onClick:n,leadingElement:L().createElement(Ge.AccountPlusOutlineIcon,{size:18}),labels:L().createElement(le.FormattedMessage,{id:"sidebar.openDirectMessage",defaultMessage:"Open a direct message"})});return L().createElement("div",{className:B()("SidebarMenu","MenuWrapper",{menuOpen:s},{"MenuWrapper--open":s})},L().createElement(xa.mc,{menuButton:{id:"SidebarCategorySortingMenu-Button-".concat(t.id),"aria-label":i({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"},{name:t.display_name}),class:"SidebarMenu_menuButton sortingMenu",children:L().createElement(Ge.DotsVerticalIcon,{size:16})},menuButtonTooltip:{text:i({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"},{name:t.display_name}),class:"hidden-xs"},menu:{id:"SidebarCategorySortingMenu-MenuList-".concat(t.id),"aria-label":i({id:"sidebar_left.sidebar_category_menu.dropdownAriaLabel",defaultMessage:"Edit category menu"}),onToggle:function(e){r(e)}}},p,f,L().createElement(xa.wv,null),E))},Js=(0,P.memo)(Ys);function Qs(e){return e.views.addChannelCtaDropdown.isOpen}var Zs=n(52052),Xs=n(63234),$s=n(17983),er=n(99068);const tr=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)(o.Sy),n=(0,le.useIntl)(),s=(0,a.useSelector)((e=>(0,b.Jz)(e,W.pm.TOUCHED,W.JS.ADD_CHANNELS_CTA))),r=(0,a.useSelector)((e=>(0,ca.xY)(e,la.A.CREATE_PUBLIC_CHANNEL))),i=(0,a.useSelector)((e=>(0,ca.xY)(e,la.A.CREATE_PRIVATE_CHANNEL)))||r,l=(0,a.useSelector)((e=>(0,ca.xY)(e,la.A.JOIN_PUBLIC_CHANNELS))),c=(0,a.useSelector)(Qs),d=(0,a.useSelector)(f.WR),u=(0,P.useCallback)((t=>{e(function(e){return{type:W.Q3.ADD_CHANNEL_CTA_DROPDOWN_TOGGLE,open:e}}(t))}),[]);let m="SidebarChannelNavigator__addChannelsCtaLhsButton";if(s||(m+=" SidebarChannelNavigator__addChannelsCtaLhsButton--untouched"),!i&&!l||!t)return null;const h=()=>{e((0,ra.q)({modalId:W.IQ.MORE_CHANNELS,dialogType:Zs.default})),(0,be.sx)("ui","browse_channels_button_is_clicked")},p=()=>{e((0,ra.q)({modalId:W.IQ.NEW_CHANNEL_MODAL,dialogType:Xs.default})),(0,be.sx)("ui","create_new_channel_button_is_clicked")},g=e=>L().createElement("button",{className:m,id:"addChannelsCta","aria-label":n.formatMessage({id:"sidebar_left.add_channel_dropdown.dropdownAriaLabel",defaultMessage:"Add Channel Dropdown"}),onClick:()=>null==e?void 0:e()},L().createElement("div",{"aria-label":n.formatMessage({id:"sidebar_left.sidebar_channel_navigator.addChannelsCta",defaultMessage:"Add channels"})},L().createElement("i",{className:"icon-plus-box"}),L().createElement("span",null,n.formatMessage({id:"sidebar_left.addChannelsCta",defaultMessage:"Add Channels"})))),E=()=>{(0,be.sx)("ui","add_channels_cta_button_clicked"),s||e((0,Ds.SF)(d,[{category:W.pm.TOUCHED,user_id:d,name:W.JS.ADD_CHANNELS_CTA,value:"true"}]))};return i?L().createElement(er.A,{className:"AddChannelsCtaDropdown",onToggle:e=>{u(e),E()},open:c},g(),L().createElement($s.A,{id:"AddChannelCtaDropdown",ariaLabel:n.formatMessage({id:"sidebar_left.add_channel_cta_dropdown.dropdownAriaLabel",defaultMessage:"Add Channels Dropdown"})},(()=>{let e,t;return l&&(e=L().createElement($s.A.ItemAction,{id:"showMoreChannels",onClick:h,icon:L().createElement("i",{className:"icon-globe"}),text:n.formatMessage({id:"sidebar_left.add_channel_dropdown.browseChannels",defaultMessage:"Browse channels"})})),i&&(t=L().createElement($s.A.ItemAction,{id:"showNewChannel",onClick:p,icon:L().createElement("i",{className:"icon-plus"}),text:n.formatMessage({id:"sidebar_left.add_channel_dropdown.createNewChannel",defaultMessage:"Create new channel"})})),L().createElement(L().Fragment,null,L().createElement($s.A.Group,null,t,e))})())):g((()=>{h(),E()}))};var nr=n(53791);const ar=e=>{const t=(0,le.useIntl)(),n=(0,a.useSelector)(o.Sy);return n?L().createElement(ut.A,{teamId:n,permissions:[me.xB.ADD_USER_TO_TEAM,me.xB.INVITE_GUEST]},L().createElement(ht.A,{ariaLabel:t.formatMessage({id:"sidebar_left.inviteMembers",defaultMessage:"Invite Members"}),id:"inviteMembersButton",className:"intro-links color--link cursor--pointer".concat(e.className?" ".concat(e.className):""),modalId:W.IQ.INVITATION,dialogType:Et.default,onClick:()=>{(0,be.sx)((0,nr.p2)(e.isAdmin),"click_sidebar_invite_members_button")},dialogProps:{focusOriginElement:"inviteMembersButton"}},L().createElement("div",{className:"SidebarChannelNavigator__inviteMembersLhsButton","aria-label":t.formatMessage({id:"sidebar_left.sidebar_channel_navigator.inviteUsers",defaultMessage:"Invite Members"})},L().createElement("i",{className:"icon-plus-box","aria-hidden":"true"}),L().createElement(le.FormattedMessage,{id:"sidebar_left.inviteMembers",defaultMessage:"Invite Members"})))):null};ar.propTypes={className:F().string,isAdmin:F().bool.isRequired};const sr=ar;var rr=n(66039),ir=n(49876);function or(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lr extends L().PureComponent{constructor(e){super(e),or(this,"handleA11yActivateEvent",(()=>{var e;null===(e=this.categoryTitleRef.current)||void 0===e||e.addEventListener("keydown",this.handleA11yKeyDown),this.a11yKeyDownRegistered=!0})),or(this,"handleA11yDeactivateEvent",(()=>{var e;null===(e=this.categoryTitleRef.current)||void 0===e||e.removeEventListener("keydown",this.handleA11yKeyDown),this.a11yKeyDownRegistered=!1})),or(this,"handleA11yKeyDown",(e=>{(0,sn.e)(e,W.Ay.KeyCodes.ENTER)&&(e.preventDefault(),this.handleCollapse())})),or(this,"renderChannel",((e,t)=>{const{setChannelRef:n,category:a,draggingState:s}=this.props;return L().createElement(ir.A,{key:e,channelIndex:t,channelId:e,isDraggable:!0,setChannelRef:n,isCategoryCollapsed:a.collapsed,isCategoryDragged:s.type===W.I8.CATEGORY&&s.id===a.id,isAutoSortedCategory:a.sorting===xs.b.Alphabetical||a.sorting===xs.b.Recency})})),or(this,"handleCollapse",(()=>{const{category:e}=this.props;e.collapsed?(0,be.sx)("ui","ui_sidebar_expand_category"):(0,be.sx)("ui","ui_sidebar_collapse_category"),this.props.actions.setCategoryCollapsed(e.id,!e.collapsed)})),or(this,"removeAnimation",(()=>{this.newDropBoxRef.current&&this.newDropBoxRef.current.classList.remove("animating")})),or(this,"handleOpenDirectMessagesModal",(e=>{e.preventDefault(),this.props.handleOpenMoreDirectChannelsModal(e.nativeEvent),(0,be.sx)("ui","ui_sidebar_create_direct_message")})),or(this,"isDropDisabled",(()=>{const{draggingState:e,category:t}=this.props;return t.type===Fs.e.DIRECT_MESSAGES?e.type===W.I8.CHANNEL:t.type===Fs.e.CHANNELS&&e.type===W.I8.DM})),or(this,"renderNewDropBox",(e=>{const{draggingState:t,category:n,isNewCategory:a,channelIds:s}=this.props;return!a||null!=s&&s.length?null:L().createElement(L().Fragment,null,L().createElement(Ls.Draggable,{draggableId:"NEW_CHANNEL_SPACER__".concat(n.id),isDragDisabled:!0,index:0},(e=>L().createElement("li",Object.assign({ref:e.innerRef,draggable:"false",className:"SidebarChannel noFloat newChannelSpacer"},e.draggableProps,{tabIndex:-1})))),L().createElement("div",{className:"SidebarCategory_newDropBox"},L().createElement("div",{ref:this.newDropBoxRef,className:B()("SidebarCategory_newDropBox-content",{collapsed:n.collapsed||t.type===W.I8.CATEGORY&&t.id===n.id,isDraggingOver:e}),onTransitionEnd:this.removeAnimation},L().createElement("i",{className:"icon-hand-right"}),L().createElement("span",{className:"SidebarCategory_newDropBox-label"},L().createElement(le.FormattedMessage,{id:"sidebar_left.sidebar_category.newDropBoxLabel",defaultMessage:"Drag channels here..."})))))})),or(this,"showPlaceholder",(()=>{const{channelIds:e,draggingState:t,category:n,isNewCategory:a}=this.props;return n.sorting!==xs.b.Alphabetical&&n.sorting!==xs.b.Recency&&!a||!!e.find((e=>e===t.id))})),this.categoryTitleRef=L().createRef(),this.newDropBoxRef=L().createRef(),this.state={isMenuOpen:!1},this.a11yKeyDownRegistered=!1}componentDidUpdate(e){this.props.category.collapsed!==e.category.collapsed&&this.newDropBoxRef.current&&this.newDropBoxRef.current.classList.add("animating")}componentDidMount(){var e,t;null===(e=this.categoryTitleRef.current)||void 0===e||e.addEventListener(W.pn.ACTIVATE,this.handleA11yActivateEvent),null===(t=this.categoryTitleRef.current)||void 0===t||t.addEventListener(W.pn.DEACTIVATE,this.handleA11yDeactivateEvent)}componentWillUnmount(){var e,t;null===(e=this.categoryTitleRef.current)||void 0===e||e.removeEventListener(W.pn.ACTIVATE,this.handleA11yActivateEvent),null===(t=this.categoryTitleRef.current)||void 0===t||t.removeEventListener(W.pn.DEACTIVATE,this.handleA11yDeactivateEvent),this.a11yKeyDownRegistered&&this.handleA11yDeactivateEvent()}render(){const{category:e,categoryIndex:t,channelIds:n,isNewCategory:a}=this.props;if(!e)return null;if(e.type===Fs.e.FAVORITES&&(null==n||!n.length))return null;const s=n.map(this.renderChannel);let r,i,o=!0;if(a)i=L().createElement("div",{className:"SidebarCategory_newLabel"},L().createElement(le.FormattedMessage,{id:"sidebar_left.sidebar_category.newLabel",defaultMessage:"new"})),r=L().createElement(Ks,{category:e});else if(e.type===Fs.e.DIRECT_MESSAGES){const t=(0,Us.V)({id:"sidebar.createDirectMessage",defaultMessage:"Create new direct message"});r=L().createElement(L().Fragment,null,L().createElement(Js,{category:e,handleOpenDirectMessagesModal:this.handleOpenDirectMessagesModal}),L().createElement(fs.A,{title:L().createElement(L().Fragment,null,t,L().createElement(Bs.h,{shortcut:Bs.A.navDMMenu,hideDescription:!0,isInsideTooltip:!0}))},L().createElement("button",{id:"newDirectMessageButton",className:"SidebarChannelGroupHeader_addButton",onClick:this.handleOpenDirectMessagesModal,"aria-label":t},L().createElement("i",{className:"icon-plus"})))),n&&n.length||(o=!1)}else r=L().createElement(Ks,{category:e});let l=e.display_name;if(e.type!==Fs.e.CUSTOM){const t=cr[e.type];l=(0,Us.V)({id:t.id,defaultMessage:t.defaultMessage})}return L().createElement(Ls.Draggable,{draggableId:e.id,index:t,disableInteractiveElementBlocking:!0},((t,n)=>{let a=null;"direct_messages"!==e.type||e.collapsed||(a=L().createElement(sr,{className:"followingSibling",isAdmin:this.props.isAdmin}));let c=null;return"channels"!==e.type||e.collapsed||(c=L().createElement(tr,null)),L().createElement("div",Object.assign({className:B()("SidebarChannelGroup a11y__section",{dropDisabled:this.isDropDisabled(),menuIsOpen:this.state.isMenuOpen,capture:this.props.draggingState.state===W.W7.CAPTURE,isCollapsed:e.collapsed}),ref:t.innerRef},t.draggableProps),L().createElement(Ls.Droppable,{droppableId:e.id,type:"SIDEBAR_CHANNEL",isDropDisabled:this.isDropDisabled()},((a,c)=>L().createElement("div",Object.assign({},a.droppableProps,{ref:a.innerRef,className:B()({draggingOver:c.isDraggingOver})}),L().createElement(rr.w,{ref:this.categoryTitleRef,displayName:l,dragHandleProps:t.dragHandleProps,isCollapsed:e.collapsed,isCollapsible:o,isDragging:n.isDragging,isDraggingOver:c.isDraggingOver,muted:e.muted,onClick:this.handleCollapse},i,null,r),L().createElement("div",{className:B()("SidebarChannelGroup_content")},L().createElement("ul",{className:"NavGroupContent"},this.renderNewDropBox(c.isDraggingOver),s,this.showPlaceholder()?a.placeholder:null))))),a,c)}))}}const cr=(0,le.defineMessages)({channels:{id:"sidebar.types.channels",defaultMessage:"CHANNELS"},direct_messages:{id:"sidebar.types.direct_messages",defaultMessage:"DIRECT MESSAGES"},favorites:{id:"sidebar.types.favorites",defaultMessage:"FAVORITES"}}),dr=(0,a.connect)((function(){const e=(0,ma._)();return(t,n)=>({channelIds:e(t,n.category),draggingState:(0,ma.NX)(t),currentUserId:(0,l.WR)(t),isAdmin:(0,Y.qc)((0,l.HW)(t).roles)})}),(function(e){return{actions:(0,j.bindActionCreators)({setCategoryCollapsed:oa.AD,setCategorySorting:oa.rV,savePreferences:Ds.SF},e)}}))(lr);function ur(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mr=(0,D.S)("DraftsLink",(0,P.lazy)((()=>n.e(2539).then(n.bind(n,22539))))),hr=(0,D.S)("GlobalThreadsLink",(0,P.lazy)((()=>n.e(7351).then(n.bind(n,31551))))),pr=(0,D.S)("UnreadChannelIndicator",(0,P.lazy)((()=>n.e(4986).then(n.bind(n,4986))))),gr=(0,D.S)("UnreadChannels",(0,P.lazy)((()=>n.e(4526).then(n.bind(n,12145)))));function fr(e){return L().createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function br(e){return L().createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function Er(e){return L().createElement("div",Object.assign({},e,{className:"scrollbar--verticalTrack"}))}function vr(e){return L().createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}const Cr={position:"absolute"};class _r extends L().PureComponent{constructor(e){var t;super(e),t=this,ur(this,"channelsListScrollTimeout",null),ur(this,"getDisplayedChannelIds",(()=>this.props.displayedChannels.map((e=>e.id)))),ur(this,"getDisplayedStaticPageIds",(()=>this.props.staticPages.map((e=>e.id)))),ur(this,"setChannelRef",((e,t)=>{t?this.channelRefs.set(e,t):this.channelRefs.delete(e)})),ur(this,"getFirstUnreadChannelFromChannelIdArray",(e=>e.find((e=>e!==this.props.currentChannelId&&this.props.unreadChannelIds.includes(e))))),ur(this,"handleScrollAnimationUpdate",(e=>{const t=e.getCurrentValue();this.scrollbar.current.scrollTop(t)})),ur(this,"scrollToFirstUnreadChannel",(()=>{this.scrollToChannel(this.getFirstUnreadChannel(),!0)})),ur(this,"scrollToLastUnreadChannel",(()=>{this.scrollToChannel(this.getLastUnreadChannel(),!0)})),ur(this,"scrollToChannel",(function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return;const a=t.channelRefs.get(e);if(!a)return;const s=a.offsetTop,r=s+a.offsetHeight,i=t.scrollbar.current.getScrollTop(),o=t.scrollbar.current.getClientHeight();if(s<i+32){const a=n||!t.state.showTopUnread?10:55;let r;const i=t.getDisplayedChannelIds();r=i.length>0&&i[0]===e?0:s-a-32,t.scrollToPosition(r)}else if(r>i+o){const e=r-o+(n||!t.state.showBottomUnread?10:55);t.scrollToPosition(e)}})),ur(this,"scrollToPosition",(e=>{this.scrollAnimation.setCurrentValue(this.scrollbar.current.getScrollTop()).setAtRest(),this.scrollAnimation.setEndValue(e)})),ur(this,"updateUnreadIndicators",(()=>{if(this.props.draggingState.state)return void this.setState({showTopUnread:!1,showBottomUnread:!1});let e=!1,t=!1;const n=this.getFirstUnreadChannel(),a=this.getLastUnreadChannel();if(n){const t=this.channelRefs.get(n);t&&t.offsetTop+t.offsetHeight-10-32<this.scrollbar.current.getScrollTop()&&(e=!0)}if(a){const e=this.channelRefs.get(a);e&&e.offsetTop+10>this.scrollbar.current.getScrollTop()+this.scrollbar.current.getClientHeight()&&(t=!0)}e===this.state.showTopUnread&&t===this.state.showBottomUnread||this.setState({showTopUnread:e,showBottomUnread:t})})),ur(this,"getFirstUnreadChannel",(()=>this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds()))),ur(this,"getLastUnreadChannel",(()=>this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds().reverse()))),ur(this,"navigateById",(e=>{-1===this.props.staticPages.findIndex((t=>t.id===e))?this.props.actions.switchToChannelById(e):this.props.actions.switchToLhsStaticPage(e)})),ur(this,"navigateChannelShortcut",(e=>{if(!e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||!(0,sn.e)(e,W.YM.KeyCodes.UP)&&!(0,sn.e)(e,W.YM.KeyCodes.DOWN))(0,sn.r)(e)&&e.shiftKey&&(0,sn.e)(e,W.YM.KeyCodes.K)&&this.props.handleOpenMoreDirectChannelsModal(e);else{e.preventDefault();const t=this.getDisplayedStaticPageIds(),n=[...t,...this.getDisplayedChannelIds()],a=this.props.currentChannelId||this.props.currentStaticPageId,s=n.indexOf(a);let r;r=(0,sn.e)(e,W.YM.KeyCodes.DOWN)?s+1:s-1;const i=n[(0,X.zi)(r,n.length)];this.navigateById(i),r>=t.length&&this.scrollToChannel(i)}})),ur(this,"navigateUnreadChannelShortcut",(e=>{if(e.altKey&&e.shiftKey&&!e.ctrlKey&&!e.metaKey&&((0,sn.e)(e,W.YM.KeyCodes.UP)||(0,sn.e)(e,W.YM.KeyCodes.DOWN))){e.preventDefault();const t=this.getDisplayedChannelIds(),n=[...this.props.unreadChannelIds];this.props.collapsedThreads&&(t.unshift(""),this.props.hasUnreadThreads&&n.unshift(""));let a=0;a=(0,sn.e)(e,W.YM.KeyCodes.UP)?-1:1;const s=(0,Z.y9)(this.props.currentChannelId,t,n,a);if(-1!==s){const e=t[s];this.navigateById(e),this.scrollToChannel(e)}}})),ur(this,"renderCategory",((e,t)=>L().createElement(dr,{key:e.id,category:e,categoryIndex:t,setChannelRef:this.setChannelRef,handleOpenMoreDirectChannelsModal:this.props.handleOpenMoreDirectChannelsModal,isNewCategory:this.props.newCategoryIds.includes(e.id)}))),ur(this,"onScroll",Ps()((()=>{this.updateUnreadIndicators()}),100)),ur(this,"onTransitionEnd",Ps()((()=>{this.updateUnreadIndicators()}),100)),ur(this,"onBeforeCapture",(e=>{this.channelRefs.forEach((e=>e.classList.remove("animating")));const t=[...document.querySelectorAll('[data-rbd-droppable-id*="droppable-categories"]')];t[0].style.height="".concat(t[0].scrollHeight,"px"),this.props.multiSelectedChannelIds.find((t=>e.draggableId===t))||this.props.actions.clearChannelSelection();const n={state:W.W7.CAPTURE,id:e.draggableId};if(this.props.categories.some((t=>t.id===e.draggableId)))n.type=W.I8.CATEGORY;else{const t=this.props.displayedChannels.filter((t=>-1!==this.props.multiSelectedChannelIds.indexOf(t.id)||t.id===e.draggableId));t.every((e=>e.type===me.Bz.DM_CHANNEL||e.type===me.Bz.GM_CHANNEL))?n.type=W.I8.DM:t.every((e=>e.type!==me.Bz.DM_CHANNEL&&e.type!==me.Bz.GM_CHANNEL))?n.type=W.I8.CHANNEL:n.type=W.I8.MIXED_CHANNELS}this.props.actions.setDraggingState(n)})),ur(this,"onBeforeDragStart",(()=>{this.props.actions.setDraggingState({state:W.W7.BEFORE})})),ur(this,"onDragStart",(e=>{this.props.onDragStart(e),this.props.actions.setDraggingState({state:W.W7.DURING}),[...document.querySelectorAll('[data-rbd-droppable-id*="droppable-categories"]')][0].style.height=""})),ur(this,"onDragEnd",(e=>{this.props.onDragEnd(e),"DROP"===e.reason&&e.destination&&("SIDEBAR_CHANNEL"===e.type?(this.props.actions.moveChannelsInSidebar(e.destination.droppableId,e.destination.index,e.draggableId),(0,be.sx)("ui","ui_sidebar_dragdrop_dropped_channel")):"SIDEBAR_CATEGORY"===e.type&&(this.props.actions.moveCategory(this.props.currentTeam.id,e.draggableId,e.destination.index),(0,be.sx)("ui","ui_sidebar_dragdrop_dropped_category"))),this.props.actions.stopDragging()})),ur(this,"showChannelListScrollbar",(()=>{null!==this.channelsListScrollTimeout&&clearTimeout(this.channelsListScrollTimeout),this.setState({autoHide:!1})})),ur(this,"hideChannelListScrollbar",(()=>{this.channelsListScrollTimeout=setTimeout((()=>{this.setState({autoHide:!0})}),300)})),this.channelRefs=new Map,this.state={showTopUnread:!1,showBottomUnread:!1,autoHide:!0},this.scrollbar=L().createRef(),this.animate=new ks.SpringSystem,this.scrollAnimation=this.animate.createSpring(),this.scrollAnimation.setOvershootClampingEnabled(!0),this.scrollAnimation.addListener({onSpringUpdate:this.handleScrollAnimationUpdate})}componentDidMount(){document.addEventListener("keydown",this.navigateChannelShortcut),document.addEventListener("keydown",this.navigateUnreadChannelShortcut)}componentWillUnmount(){document.removeEventListener("keydown",this.navigateChannelShortcut),document.removeEventListener("keydown",this.navigateUnreadChannelShortcut)}componentDidUpdate(e){this.props.currentChannelId&&e.currentChannelId&&(this.props.currentTeam!==e.currentTeam&&this.scrollbar.current.scrollToTop(),this.props.currentChannelId,e.currentChannelId,this.props.currentChannelId!==e.currentChannelId&&this.props.actions.close(),this.updateUnreadIndicators())}render(){const{categories:e}=this.props;let t;if(this.props.isUnreadFilterEnabled)t=L().createElement(gr,{setChannelRef:this.setChannelRef});else{let n;this.props.showUnreadsCategory&&(n=L().createElement(gr,{setChannelRef:this.setChannelRef}));const a=e.map(this.renderCategory);t=L().createElement(L().Fragment,null,n,L().createElement(Ls.DragDropContext,{onDragEnd:this.onDragEnd,onBeforeDragStart:this.onBeforeDragStart,onBeforeCapture:this.onBeforeCapture,onDragStart:this.onDragStart},L().createElement(Ls.Droppable,{droppableId:"droppable-categories",type:"SIDEBAR_CATEGORY"},(e=>L().createElement("div",Object.assign({id:"sidebar-droppable-categories",ref:e.innerRef},e.droppableProps),a,e.placeholder)))))}const n=L().createElement(le.FormattedMessage,{id:"sidebar.unreads",defaultMessage:"More unreads"}),a=L().createElement(le.FormattedMessage,{id:"sidebar.unreads",defaultMessage:"More unreads"}),s=this.props.intl.formatMessage({id:"accessibility.sections.lhsList",defaultMessage:"channel sidebar region"});return L().createElement(L().Fragment,null,L().createElement(hr,null),L().createElement(mr,null),L().createElement("div",{id:"sidebar-left",role:"application","aria-label":s,className:B()("SidebarNavContainer a11y__region",{disabled:this.props.isUnreadFilterEnabled}),"data-a11y-disable-nav":Boolean(this.props.draggingState.type),"data-a11y-sort-order":"7",onTransitionEnd:this.onTransitionEnd},L().createElement(pr,{name:"Top",show:this.state.showTopUnread,onClick:this.scrollToFirstUnreadChannel,extraClass:"nav-pills__unread-indicator-top",content:n}),L().createElement(pr,{name:"Bottom",show:this.state.showBottomUnread,onClick:this.scrollToLastUnreadChannel,extraClass:"nav-pills__unread-indicator-bottom",content:a}),L().createElement("div",{onPointerLeave:this.hideChannelListScrollbar,onPointerOver:this.showChannelListScrollbar},L().createElement(Os.Ay,{ref:this.scrollbar,autoHide:this.state.autoHide,renderThumbHorizontal:br,renderThumbVertical:vr,renderTrackVertical:Er,renderView:fr,onScroll:this.onScroll,style:Cr},t))))}}const yr=(0,le.injectIntl)(_r),Mr=(0,a.connect)((function(e){const t=(0,o.H7)(e),n=(0,b.WW)(e);let a=!1;var s;return n&&(a=Boolean(null===(s=(0,As.kL)(e))||void 0===s?void 0:s.total_unread_threads)),{currentTeam:t,currentChannelId:(0,r.eH)(e),categories:(0,ma.WJ)(e),isUnreadFilterEnabled:(0,ma.ZM)(e),unreadChannelIds:(0,r.tr)(e),displayedChannels:(0,ma.sC)(e),draggingState:(0,ma.NX)(e),newCategoryIds:e.views.channelSidebar.newCategoryIds,multiSelectedChannelIds:e.views.channelSidebar.multiSelectedChannelIds,showUnreadsCategory:(0,b.pE)(e),collapsedThreads:n,hasUnreadThreads:a,currentStaticPageId:(0,z.SM)(e),staticPages:(0,z.j4)(e)}}),(function(e){return{actions:(0,j.bindActionCreators)({close:Ns.VN,switchToChannelById:c.Tw,moveChannelsInSidebar:da.nh,moveCategory:oa.Ax,setDraggingState:da.Jb,stopDragging:da.U5,clearChannelSelection:da.lE,switchToLhsStaticPage:Ns.S_},e)}}))(yr);function Tr(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Sr=(0,D.S)("MobileSidebarHeader",(0,P.lazy)((()=>n.e(5808).then(n.bind(n,25808))))),wr=(0,D.S)("MoreDirectChannels",(0,P.lazy)((()=>n.e(6532).then(n.bind(n,96532))))),Ir=(0,D.S)("BrowseChannels",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,52052))))),Ar=(0,D.S)("EditCategoryModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,12555))))),Nr=(0,D.S)("CreateUserGroupsModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,36143))))),Rr=(0,D.S)("InvitationModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,49888))))),Pr=(0,D.S)("KeyboardShortcutsModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,92904))))),Lr=(0,D.S)("NewChannelModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,63234))))),Or=(0,D.S)("UserSettingsModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,59529)))));class kr extends L().PureComponent{constructor(e){super(e),Tr(this,"handleClickClearChannelSelection",(e=>{e.defaultPrevented||this.props.actions.clearChannelSelection()})),Tr(this,"handleKeyDownEvent",(e=>{(0,sn.e)(e,W.Ay.KeyCodes.ESCAPE)?this.props.actions.clearChannelSelection():(0,sn.r)(e,!0)&&((0,sn.e)(e,W.Ay.KeyCodes.FORWARD_SLASH)?(e.preventDefault(),this.props.isKeyBoardShortcutModalOpen?this.props.actions.closeModal(W.IQ.KEYBOARD_SHORTCUTS_MODAL):this.props.actions.openModal({modalId:W.IQ.KEYBOARD_SHORTCUTS_MODAL,dialogType:Pr})):(0,sn.e)(e,W.Ay.KeyCodes.A)&&e.shiftKey&&(e.preventDefault(),this.props.actions.openModal({modalId:W.IQ.USER_SETTINGS,dialogType:Or,dialogProps:{isContentProductSettings:!0,focusOriginElement:"sidebar.tsx"}})))})),Tr(this,"showMoreDirectChannelsModal",(()=>{this.setState({showDirectChannelsModal:!0}),(0,be.sx)("ui","ui_channels_more_direct_v2")})),Tr(this,"hideMoreDirectChannelsModal",(()=>{this.setState({showDirectChannelsModal:!1})})),Tr(this,"showCreateCategoryModal",(()=>{this.props.actions.openModal({modalId:W.IQ.EDIT_CATEGORY,dialogType:Ar,dialogProps:{}}),(0,be.sx)("ui","ui_sidebar_menu_createCategory")})),Tr(this,"showMoreChannelsModal",(()=>{this.props.actions.openModal({modalId:W.IQ.MORE_CHANNELS,dialogType:Ir}),(0,be.sx)("ui","ui_channels_more_public_v2")})),Tr(this,"invitePeopleModal",(()=>{this.props.actions.openModal({modalId:W.IQ.INVITATION,dialogType:Rr,dialogProps:{focusOriginElement:"browseOrAddChannelMenuButton"}}),(0,be.sx)("ui","ui_channels_dropdown_invite_people")})),Tr(this,"showNewChannelModal",(()=>{this.props.actions.openModal({modalId:W.IQ.NEW_CHANNEL_MODAL,dialogType:Lr}),this.closeEditRHS(),(0,be.sx)("ui","ui_channels_create_channel_v2")})),Tr(this,"showCreateUserGroupModal",(()=>{this.props.actions.openModal({modalId:W.IQ.USER_GROUPS_CREATE,dialogType:Nr}),(0,be.sx)("ui","ui_channels_create_user_group")})),Tr(this,"handleOpenMoreDirectChannelsModal",(e=>{null==e||e.preventDefault(),this.state.showDirectChannelsModal?this.hideMoreDirectChannelsModal():(this.showMoreDirectChannelsModal(),this.closeEditRHS())})),Tr(this,"onDragStart",(()=>{this.setState({isDragging:!0})})),Tr(this,"onDragEnd",(()=>{this.setState({isDragging:!1})})),Tr(this,"renderModals",(()=>{let e;return this.state.showDirectChannelsModal&&(e=L().createElement(wr,{onModalDismissed:this.hideMoreDirectChannelsModal,isExistingChannel:!1,focusOriginElement:"newDirectMessageButton"})),L().createElement(L().Fragment,null,e)})),Tr(this,"closeEditRHS",(()=>{this.props.rhsOpen&&this.props.rhsState===W._n.EDIT_HISTORY&&this.props.actions.closeRightHandSide()})),this.state={showDirectChannelsModal:!1,isDragging:!1}}componentDidMount(){this.props.teamId&&this.props.actions.fetchMyCategories(this.props.teamId),window.addEventListener("click",this.handleClickClearChannelSelection),window.addEventListener("keydown",this.handleKeyDownEvent)}componentDidUpdate(e){this.props.teamId&&e.teamId!==this.props.teamId&&this.props.actions.fetchMyCategories(this.props.teamId)}componentWillUnmount(){window.removeEventListener("click",this.handleClickClearChannelSelection),window.removeEventListener("keydown",this.handleKeyDownEvent)}render(){if(!this.props.teamId)return L().createElement("div",null);const e=(0,X.Vw)({id:"accessibility.sections.lhsNavigator",defaultMessage:"channel navigator region"});return L().createElement(La,{id:"SidebarContainer",className:B()({"move--right":this.props.isOpen&&this.props.isMobileView,dragging:this.state.isDragging})},this.props.isMobileView?L().createElement(Sr,null):L().createElement(as,{showNewChannelModal:this.showNewChannelModal,showMoreChannelsModal:this.showMoreChannelsModal,showCreateUserGroupModal:this.showCreateUserGroupModal,invitePeopleModal:this.invitePeopleModal,showCreateCategoryModal:this.showCreateCategoryModal,canCreateChannel:this.props.canCreatePrivateChannel||this.props.canCreatePublicChannel,canJoinPublicChannel:this.props.canJoinPublicChannel,handleOpenDirectMessagesModal:this.handleOpenMoreDirectChannelsModal,unreadFilterEnabled:this.props.unreadFilterEnabled,canCreateCustomGroups:this.props.canCreateCustomGroups}),L().createElement("div",{id:"lhsNavigator",role:"application","aria-label":e,className:"a11y__region","data-a11y-sort-order":"6"},L().createElement(Is,null)),L().createElement("div",{className:"sidebar--left__icons"},L().createElement(un.default,{pluggableName:"LeftSidebarHeader"})),L().createElement(Mr,{handleOpenMoreDirectChannelsModal:this.handleOpenMoreDirectChannelsModal,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd}),L().createElement(Aa,null),this.renderModals())}}Tr(kr,"propTypes",{teamId:F().string.isRequired,canCreatePublicChannel:F().bool.isRequired,canCreatePrivateChannel:F().bool.isRequired,canJoinPublicChannel:F().bool.isRequired,isOpen:F().bool.isRequired,actions:F().shape({fetchMyCategories:F().func.isRequired,openModal:F().func.isRequired,closeModal:F().func.isRequired,clearChannelSelection:F().func.isRequired,closeRightHandSide:F().func.isRequired}).isRequired,unreadFilterEnabled:F().bool.isRequired,isMobileView:F().bool.isRequired,isKeyBoardShortcutModalOpen:F().bool.isRequired,canCreateCustomGroups:F().bool.isRequired,rhsOpen:F().bool});const Dr=(0,a.connect)((function(e){const t=(0,o.H7)(e),n=(0,ma.ZM)(e);let a=!1,s=!1,r=!1;t&&(a=(0,ca.xY)(e,la.A.CREATE_PUBLIC_CHANNEL),s=(0,ca.xY)(e,la.A.CREATE_PRIVATE_CHANNEL),r=(0,ca.xY)(e,la.A.JOIN_PUBLIC_CHANNELS));const i=(0,b.h7)(e)&&(0,ca.y4)(e,{permission:la.A.CREATE_CUSTOM_GROUP});return{teamId:t?t.id:"",canCreatePrivateChannel:s,canCreatePublicChannel:a,canJoinPublicChannel:r,isOpen:(0,z.Cu)(e),unreadFilterEnabled:n,isMobileView:(0,q.w3)(e),isKeyBoardShortcutModalOpen:(0,ha.o)(e,W.IQ.KEYBOARD_SHORTCUTS_MODAL),canCreateCustomGroups:i,rhsState:(0,d.bM)(e),rhsOpen:(0,d.A)(e)}}),(function(e){return{actions:(0,j.bindActionCreators)({clearChannelSelection:da.lE,fetchMyCategories:oa.pQ,openModal:ra.q,closeModal:ra.O,closeRightHandSide:ua.bP},e)}}))(kr);var xr=n(34574);const Fr=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)(b.WW),n=(0,P.useRef)(!1);return(0,P.useEffect)((()=>{n.current?e((0,xr.Eq)()):n.current=!0}),[t]),null};var Ur=n(39487);const Br=n.p+"files/6a2055863ca6d151ebb4.png",Hr=n.p+"files/5309202966a267198738.png",qr=n.p+"files/15307d1bee6d7e48a3c1.png",jr=n.p+"files/cd8cb8b2332ebb5e7a6d.png",Vr=n.p+"files/544631aa0cac60b57833.png",zr=n.p+"files/90de726ce0a2fe9958d3.png",Gr=n.p+"files/940dec81931d4df6027f.png",Wr=n.p+"files/bbedcb731056777d6679.png",Kr=n.p+"files/3399e2ee5698233ffe44.png",Yr=n.p+"files/5230b3ff762bfd3f84df.png",Jr=n.p+"files/f6ea1b2c4b12cde69e70.png",Qr=n.p+"files/8f702b9068ad5f14443a.png",Zr=n.p+"files/9777bf12a1f691f71268.png",Xr=n.p+"files/20b39a15c40e4db238f1.png",$r=n.p+"files/2c18b373ff146fd8108b.png";var ei=n(51881);function ti(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ni=function(e){return e.Mention="Mention",e.Unread="Unread",e.None="None",e}(ni||{});class ai extends L().PureComponent{constructor(){super(...arguments),ti(this,"updateDesktopApp",(()=>{const{unreadStatus:e}=this.props,{isUnread:t,unreadMentionCount:n}=(0,r.pP)(e);ei.h.updateUnreadsAndMentions(t,n)})),ti(this,"updateTitle",(()=>{const{siteName:e,currentChannel:t,currentTeam:n,currentTeammate:a,unreadStatus:s,inGlobalThreads:i,inDrafts:o,inScheduledPosts:l}=this.props,{formatMessage:c}=this.props.intl,d=e||"",{isUnread:u,unreadMentionCount:m}=(0,r.pP)(s),h=m>0?"(".concat(m,") "):"",p=!this.isDynamicFaviconSupported&&u?"* ":"";if(t&&n&&t.id){let e=t.display_name;t.type===W.YM.DM_CHANNEL&&null!=a&&(e=a.display_name),document.title="".concat(h).concat(p).concat(e," - ").concat(n.display_name," ").concat(d)}else document.title=n&&i?c({id:"globalThreads.title",defaultMessage:"{prefix}Threads - {displayName} {siteName}"},{prefix:"".concat(h).concat(p),displayName:n.display_name,siteName:d}):n&&o?c({id:"drafts.title",defaultMessage:"{prefix}Drafts - {displayName} {siteName}"},{prefix:"".concat(h).concat(p),displayName:n.display_name,siteName:d}):n&&l?c({id:"scheduledPosts.title",defaultMessage:"{prefix}Scheduled - {displayName} {siteName}"},{prefix:"".concat(h).concat(p),displayName:n.display_name,siteName:d}):c({id:"sidebar.team_select",defaultMessage:"{siteName} - Join a team"},{siteName:d||"Mattermost"})})),ti(this,"updateFavicon",(e=>{if(!ye.gm()&&!ye.H8())return;if(!document.querySelector('link[rel="icon"]'))return;const t=document.querySelector('link[rel="icon"][sizes="16x16"]'),n=document.querySelector('link[rel="icon"][sizes="24x24"]'),a=document.querySelector('link[rel="icon"][sizes="32x32"]'),s=document.querySelector('link[rel="icon"][sizes="64x64"]'),r=document.querySelector('link[rel="icon"][sizes="96x96"]'),i=e=>(0,Ur.GX)(e);switch(e){case ni.Mention:t.href=i(zr),n.href=i(Gr),a.href=i(Wr),s.href=i(Kr),r.href=i(Yr);break;case ni.Unread:t.href=i(Jr),n.href=i(Qr),a.href=i(Zr),s.href=i(Xr),r.href=i($r);break;default:t.href=i(Br),n.href=i(Hr),a.href=i(qr),s.href=i(jr),r.href=i(Vr)}}))}componentDidUpdate(e){this.updateTitle();const t=this.getBadgeStatus(e.unreadStatus),n=this.getBadgeStatus(this.props.unreadStatus);t!==n&&this.updateFavicon(n),this.updateDesktopApp()}get isDynamicFaviconSupported(){return ye.H8()||ye.gm()}getBadgeStatus(e){return"number"==typeof e?ni.Mention:e?ni.Unread:ni.None}render(){return null}}ti(ai,"propTypes",{siteName:F().string,inGlobalThreads:F().bool.isRequired,inDrafts:F().bool.isRequired,inScheduledPosts:F().bool.isRequired});const si=(0,le.injectIntl)(ai),ri=(0,O.withRouter)((0,a.connect)((function(e,t){let{location:{pathname:n}}=t;const a=(0,i.zj)(e),s=(0,r.Lw)(e),l=s&&s.teammate_id?s:null;return{currentChannel:s,currentTeam:(0,o.H7)(e),currentTeammate:l,siteName:a.SiteName,unreadStatus:(0,r.m5)(e),inGlobalThreads:null!=(0,O.matchPath)(n,{path:"/:team/threads/:threadIdentifier?"}),inDrafts:null!=(0,O.matchPath)(n,{path:"/:team/drafts"}),inScheduledPosts:null!=(0,O.matchPath)(n,{path:"/:team/scheduled_posts"})}}),(function(e){return{actions:(0,j.bindActionCreators)({},e)}}))(si)),ii=(0,D.S)("ProductNoticesModal",(0,P.lazy)((()=>n.e(452).then(n.bind(n,20452))))),oi=(0,D.S)("ResetStatusModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,58737))))),li=(0,D.S)("MobileSidebarRight",(0,P.lazy)((()=>n.e(4302).then(n.bind(n,4302))))),ci=["app__body","channel-view"];function di(e){const t=(0,a.useSelector)(q.w3),n=(0,a.useSelector)(f.F4),s=(0,a.useDispatch)();return(0,P.useEffect)((()=>{var e;const t=(0,ye.VN)()||(0,ye.UP)(),{navigator:n}=window,a=(null==n||null===(e=n.userAgentData)||void 0===e?void 0:e.platform)||(null==n?void 0:n.platform)||"unknown";return document.body.classList.add(...function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[...ci];return"Win32"===e||"Win64"===e?n.push("os--windows"):"MacIntel"!==e&&"MacPPC"!==e||n.push("os--mac"),t&&n.push("browser--ie"),n}(a,t)),()=>{document.body.classList.remove(...ci),s((0,H.uF)())}}),[]),(0,P.useEffect)((()=>{let e;return n&&(e=setInterval((()=>{s((0,E.I8)())}),W.YM.STATUS_INTERVAL)),()=>{clearInterval(e)}}),[n]),L().createElement(L().Fragment,null,L().createElement(Fr,null),L().createElement(ia,null),L().createElement(Dr,null),L().createElement("div",{id:"channel_view",className:"channel-view","data-testid":"channel_view"},L().createElement(ri,null),L().createElement(ii,null),L().createElement("div",{className:B()("container-fluid channel-view-inner")},e.shouldRenderCenterChannel?L().createElement(sa,null):L().createElement(ue.A,{centered:!0}),L().createElement(un.default,{pluggableName:"Root"}),L().createElement(oi,null))),t&&L().createElement(li,null))}di.propTypes={shouldRenderCenterChannel:F().bool.isRequired};var ui=n(854);const mi=(0,D.S)("BackstageController",(0,P.lazy)((()=>n.e(595).then(n.bind(n,34526))))),hi=(0,D.n)();var pi=A()(hi).withConfig({displayName:"_StyledPluggable"})({gridArea:"center"});function gi(e){var t;const n=(0,O.useHistory)(),{team:s}=(0,O.useParams)(),[r,i]=(0,P.useState)(!1),[o,c]=(0,P.useState)(fi(e.teamsList,s)),d=(0,P.useRef)(Date.now()),u=(0,P.useRef)(Date.now());async function m(t,a){c(null);const{data:s,error:r}=await e.joinTeam(t,a);r?n.push("/error?type=team_not_found"):s&&c(s)}(function(){var e,t;const n=(0,a.useSelector)(l.HW),s=null!==(e=null==n?void 0:n.id)&&void 0!==e?e:"",r=null!==(t=null==n?void 0:n.roles)&&void 0!==t?t:"";(0,P.useEffect)((()=>{s&&K.mT.setUserId(s),r&&K.mT.setUserRoles(r)}),[s,r])})(),(0,P.useEffect)((()=>{ui.A.stop("team_controller"),ei.h.reactAppInitialized(),e.fetchAllMyChannelMembers(),async function(){await e.fetchAllMyTeamsChannels(),i(!0)}()}),[]),(0,P.useEffect)((()=>{if(e.disableWakeUpReconnectHandler)return()=>{};const t=setInterval((()=>{const e=Date.now();e-u.current>6e4&&(console.log("computer woke up - reconnecting"),(0,k.M6)()),u.current=e}),3e4);return()=>{clearInterval(t)}}),[e.disableWakeUpReconnectHandler]),(0,P.useEffect)((()=>{function t(){window.isActive=!0,e.markAsReadOnFocus(),e.disableRefetchingOnBrowserFocus||Date.now()-d.current>12e4&&e.currentTeamId&&e.fetchChannelsAndMembers(e.currentTeamId)}function n(){window.isActive=!1,d.current=Date.now(),e.unsetActiveChannelOnServer()}function a(e){if(e.shiftKey&&(0,sn.r)(e)&&(0,sn.e)(e,W.Ay.KeyCodes.L)){const e=document.querySelector("#sidebar-right.is-open.expanded #reply_textbox");if(e)e.focus();else{const e=document.getElementById("post_textbox");e&&e.focus()}}}return window.addEventListener("focus",t),window.addEventListener("blur",n),window.addEventListener("keydown",a),()=>{window.removeEventListener("focus",t),window.removeEventListener("blur",n),window.removeEventListener("keydown",a)}}),[e.currentTeamId]),(0,P.useEffect)((()=>{const e=(0,ye.ux)();return e&&R().enable(),window.isActive=!0,C.A.setTeamIdJoinedOnLoad(null),()=>{window.isActive=!1,e&&R().disable()}}),[]);const h=e.teamsList.map((e=>e.id)).sort().join("+");if((0,P.useEffect)((()=>{if(s){if(W.Ay.RESERVED_TEAM_NAMES.includes(s))return;const t=fi(e.teamsList,s);t?async function(t){const{data:a,error:s}=await e.initializeTeam(t);s?n.push("/error?type=team_not_found"):a&&c(a)}(t):o&&o.name!==s?m(s,!1):o||m(s,!0)}}),[s,h]),e.mfaRequired)return n.push("/mfa/setup"),null;if(null===o)return null;const p=(null==o?void 0:o.name.toLowerCase())===(null==s?void 0:s.toLowerCase());return L().createElement(O.Switch,null,L().createElement(O.Route,{path:"/:team(".concat(Qn.LD,")/integrations"),component:mi}),L().createElement(O.Route,{path:"/:team(".concat(Qn.LD,")/emoji"),component:mi}),null===(t=e.plugins)||void 0===t?void 0:t.map((e=>L().createElement(O.Route,{key:e.id,path:"/:team(".concat(Qn.LD,")/")+e.route,render:()=>L().createElement(pi,{pluggableName:"NeedsTeamComponent",pluggableId:e.id})}))),L().createElement(di,{shouldRenderCenterChannel:r&&p}))}function fi(e,t){var n;if(!t)return null;return(null!==(n=e.find((e=>e.name===t)))&&void 0!==n?n:null)||null}const bi=(0,P.memo)(gi),Ei={fetchChannelsAndMembers:s.DC,fetchAllMyTeamsChannels:s.al,fetchAllMyChannelMembers:s.AK,markAsReadOnFocus:c.jK,initializeTeam:S,joinTeam:function(e,t){return async(n,a)=>{const r=a(),i=(0,l.HW)(r);try{const r=await n((0,g.Uj)(e));if((0,_.o)(r)){const e=r.data;if(i&&e&&0===e.delete_at){const r=await n((0,v.$w)(e.id,i.id));if((0,_.o)(r)){t&&C.A.setTeamIdJoinedOnLoad(e.id),await n(S(e));try{await n((0,s.DC)(e.id))}catch(e){return(0,p.UP)(e,n,a),n((0,m.vV)(e)),{error:e}}return{data:e}}throw r.error}throw new Error("Team not found or deleted")}throw r.error}catch(e){return(0,p.UP)(e,n,a),n((0,m.vV)(e)),{error:e}}}},unsetActiveChannelOnServer:s.Zw},vi=(0,a.connect)((function(e,t){const n=(0,i.Ay)(e),a=(0,i.zj)(e),s=(0,l.HW)(e),c=e.plugins.components.NeedsTeamComponent,m="true"===a.DisableRefetchingOnBrowserFocus,h="true"===a.DisableWakeUpReconnectHandler;return{currentTeamId:(0,o.Sy)(e),currentChannelId:(0,r.eH)(e),teamsList:(0,o.vt)(e),plugins:c,selectedThreadId:(0,u.EB)(e),selectedPostId:(0,d.zb)(e),mfaRequired:(0,w.T)(s,n,a,t.match.url),disableRefetchingOnBrowserFocus:m,disableWakeUpReconnectHandler:h}}),Ei),Ci=vi(bi)},8283:(e,t,n)=>{n.d(t,{A:()=>I});var a=n(23453),s=n(5908),r=n(87373),i=n(23739),o=n(79751),l=n(62688),c=n.n(l),d=(n(17046),n(43813),n(4290),n(97023)),u=n.n(d),m=n(14778),h=n(48774),p=n(69669),g=n(17461),f=n(49136),b=n(1277),E=n(24163),v=n(17983),C=n(99068),_=n(83873),y=n(78451),M=n(85873);function T(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class S extends u().PureComponent{constructor(){super(...arguments),T(this,"state",{showConfirmModal:!1,item:{member_count:0}}),T(this,"loadItems",(async(e,t)=>{const{data:n}=await this.props.actions.getGroupsAssociatedToTeam(this.props.team.id,t,e,b.$,!0);return{items:n.groups,totalCount:n.totalGroupCount}})),T(this,"handleDeleteCanceled",(()=>{this.setState({showConfirmModal:!1})})),T(this,"handleDeleteConfirmed",(()=>{this.setState({showConfirmModal:!1});const{item:e,listModal:t}=this.state;this.props.actions.unlinkGroupSyncable(e.id,this.props.team.id,h.CL.Team).then((async()=>{if(t){t.setState({loading:!0});const{items:e,totalCount:n}=await t.props.loadItems(t.state.page,t.state.searchTerm);t.setState({loading:!1,items:e,totalCount:n})}}))})),T(this,"onClickRemoveGroup",((e,t)=>{this.setState({showConfirmModal:!0,item:e,listModal:t})})),T(this,"onClickConfirmRemoveGroup",((e,t)=>this.props.actions.unlinkGroupSyncable(e.id,this.props.team.id,h.CL.Team).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:n}=await t.props.loadItems(t.state.page,t.state.searchTerm);t.setState({loading:!1,items:e,totalCount:n})})))),T(this,"onHide",(()=>{this.props.actions.closeModal(y.IQ.MANAGE_TEAM_GROUPS)})),T(this,"titleButtonOnClick",(()=>{this.onHide(),this.props.actions.openModal({modalId:y.IQ.ADD_GROUPS_TO_TEAM,dialogType:p.A})})),T(this,"setTeamMemberStatus",(async(e,t,n)=>{this.props.actions.patchGroupSyncable(e.id,this.props.team.id,h.CL.Team,{scheme_admin:n}).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:n}=await t.props.loadItems(t.state.page,t.state.searchTerm);this.props.actions.getMyTeamMembers(),t.setState({loading:!1,items:e,totalCount:n})}))})),T(this,"renderRow",((e,t)=>{let n;return n=e.scheme_admin?u().createElement(m.FormattedMessage,{id:"team_members_dropdown.teamAdmins",defaultMessage:"Team Admins"}):u().createElement(m.FormattedMessage,{id:"team_members_dropdown.teamMembers",defaultMessage:"Team Members"}),u().createElement("div",{key:e.id,className:"more-modal__row"},u().createElement("img",{className:"more-modal__image",src:_,alt:"group picture",width:"32",height:"32"}),u().createElement("div",{className:"more-modal__details"},u().createElement("div",{className:"more-modal__name","data-testid":"group-name"},e.display_name," ",u().createElement(f.A,null)," ","-"," ",u().createElement(f.A,null),u().createElement("span",{className:"more-modal__name_count"},u().createElement(m.FormattedMessage,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),u().createElement("div",{className:"more-modal__actions"},u().createElement(C.A,null,u().createElement("button",{id:"teamGroupsDropdown_".concat(e.display_name),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true","data-testid":"menu-button"},u().createElement("span",null,n," "),u().createElement(E.A,null)),u().createElement(v.A,{openLeft:!0,ariaLabel:M.Vw({id:"team_members_dropdown.menuAriaLabel",defaultMessage:"Change the role of a team member"})},u().createElement(v.A.ItemAction,{show:!e.scheme_admin,onClick:()=>this.setTeamMemberStatus(e,t,!0),text:M.Vw({id:"team_members_dropdown.makeTeamAdmins",defaultMessage:"Make Team Admins"})}),u().createElement(v.A.ItemAction,{show:Boolean(e.scheme_admin),onClick:()=>this.setTeamMemberStatus(e,t,!1),text:M.Vw({id:"team_members_dropdown.makeTeamMembers",defaultMessage:"Make Team Members"})}),u().createElement(v.A.ItemAction,{id:"remove-group",onClick:()=>this.onClickRemoveGroup(e,t),text:M.Vw({id:"group_list_modal.removeGroupButton",defaultMessage:"Remove Group"})})))))}))}render(){const{formatMessage:e}=this.props.intl,t=this.state.item.member_count;return u().createElement(u().Fragment,null,u().createElement(b.A,{show:!this.state.showConfirmModal,titleText:e({id:"team_groups",defaultMessage:"{team} Groups"},{team:this.props.team.display_name}),searchPlaceholderText:e({id:"manage_team_groups_modal.search_placeholder",defaultMessage:"Search groups"}),renderRow:this.renderRow,loadItems:this.loadItems,onHide:this.onHide,titleBarButtonText:e({id:"group_list_modal.addGroupButton",defaultMessage:"Add Groups"}),titleBarButtonOnClick:this.titleButtonOnClick,"data-testid":"list-modal"}),u().createElement(g.A,{show:this.state.showConfirmModal,title:e({id:"remove_group_confirm_title",defaultMessage:"Remove Group and {memberCount, number} {memberCount, plural, one {Member} other {Members}}"},{memberCount:t}),message:e({id:"remove_group_confirm_message",defaultMessage:"{memberCount, number} {memberCount, plural, one {member} other {members}} associated to this group will be removed from the team. Are you sure you wish to remove this group and {memberCount} {memberCount, plural, one {member} other {members}}?"},{memberCount:t}),confirmButtonText:e({id:"remove_group_confirm_button",defaultMessage:"Yes, Remove Group and {memberCount, plural, one {Member} other {Members}}"},{memberCount:t}),onConfirm:this.handleDeleteConfirmed,onCancel:this.handleDeleteCanceled,id:"confirm-modal"}))}}T(S,"propTypes",{actions:c().shape({getGroupsAssociatedToTeam:c().func.isRequired,closeModal:c().func.isRequired,openModal:c().func.isRequired,unlinkGroupSyncable:c().func.isRequired,patchGroupSyncable:c().func.isRequired,getMyTeamMembers:c().func.isRequired}).isRequired});const w=(0,m.injectIntl)(S),I=(0,a.connect)(((e,t)=>({team:e.entities.teams.teams[t.teamID]})),(e=>({actions:(0,s.bindActionCreators)({getGroupsAssociatedToTeam:r.Lp,closeModal:o.O,openModal:o.q,unlinkGroupSyncable:r.IC,patchGroupSyncable:r.r2,getMyTeamMembers:i.tt},e)})))(w)},87364:(e,t,n)=>{n.d(t,{A:()=>K});var a=n(23453),s=n(5908),r=n(14776),i=n(79751),o=n(98496),l=n(78451),c=n(62688),d=n.n(c),u=(n(4290),n(97023)),m=n.n(u),h=n(34529),p=n(14778),g=n(16983),f=n(49888),b=(n(3188),n(30973),n(23739)),E=n(17085),v=n(40057),C=n(80635),_=n(7430),y=n(59935),M=n(65357),T=n(89247),S=(n(43813),n(17046),n(24876)),w=n(30413),I=n(77440),A=n(46859),N=(n(57406),n(55448),n(79342)),R=n(17461),P=n(24163),L=n(17983),O=n(99068),k=n(83007);function D(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class x extends m().PureComponent{constructor(e){super(e),D(this,"handleMakeMember",(async()=>{const e=this.props.currentUser;if(this.props.user.id===e.id&&e.roles.includes("system_admin"))this.handleDemote(this.props.user,"team_user");else{const{error:t}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!1);t?this.setState({serverError:t.message}):(this.props.actions.getUser(this.props.user.id),this.props.actions.getTeamMember(this.props.teamMember.team_id,this.props.user.id),this.props.user.id===e.id&&(await this.props.actions.getMyTeamMembers(),this.props.actions.getMyTeamUnreads(this.props.collapsedThreads)))}})),D(this,"handleRemoveFromTeam",(async()=>{const{error:e}=await this.props.actions.removeUserFromTeamAndGetStats(this.props.teamMember.team_id,this.props.user.id);e&&this.setState({serverError:e.message})})),D(this,"handleMakeAdmin",(async()=>{const e=this.props.currentUser;if(this.props.user.id===e.id&&e.roles.includes("system_admin"))this.handleDemote(this.props.user,"team_user team_admin");else{const{error:e}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!0);e?this.setState({serverError:e.message}):(this.props.actions.getUser(this.props.user.id),this.props.actions.getTeamMember(this.props.teamMember.team_id,this.props.user.id))}})),D(this,"handleDemote",((e,t)=>{this.setState({serverError:this.state.serverError,showDemoteModal:!0,user:e,role:t})})),D(this,"handleDemoteCancel",(()=>{this.setState({serverError:null,showDemoteModal:!1,user:null,role:null})})),D(this,"handleDemoteSubmit",(async()=>{const{error:e}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!1);e?this.setState({serverError:e.message}):(this.props.actions.getUser(this.props.user.id),(0,k.J)().push(this.props.teamUrl))})),this.state={serverError:null,showDemoteModal:!1,user:null,role:null}}render(){let e=null;this.state.serverError&&(e=m().createElement("div",{className:"has-error"},m().createElement("label",{className:"has-error control-label"},this.state.serverError)));const{currentTeam:t,teamMember:n,user:a,intl:s}=this.props;let r=null;r=(0,N.P)(a.roles)?m().createElement(p.FormattedMessage,{id:"team_members_dropdown.guest",defaultMessage:"Guest"}):a.roles.length>0&&(0,N.FV)(a.roles)?m().createElement(p.FormattedMessage,{id:"team_members_dropdown.systemAdmin",defaultMessage:"System Admin"}):n.roles.length>0&&(0,N.qc)(n.roles)||n.scheme_admin?m().createElement(p.FormattedMessage,{id:"team_members_dropdown.teamAdmin",defaultMessage:"Team Admin"}):m().createElement(p.FormattedMessage,{id:"team_members_dropdown.member",defaultMessage:"Member"});const i=this.props.currentUser;let o=!(0,N.P)(a.roles)&&((0,N.qc)(n.roles)||n.scheme_admin)&&!(0,N.FV)(a.roles),l=!((0,N.P)(a.roles)||(0,N.qc)(n.roles)||(0,N.FV)(a.roles)||n.scheme_admin);a.delete_at>0&&(r=m().createElement(p.FormattedMessage,{id:"team_members_dropdown.inactive",defaultMessage:"Inactive"}),o=!1,l=!1);const c=a.id!==i.id&&(!(null!=t&&t.group_constrained)||a.is_bot);let d=null;if(a.id===i.id){const t=m().createElement(p.FormattedMessage,{id:"team_members_dropdown.confirmDemoteRoleTitle",defaultMessage:"Confirm Demotion from System Admin Role"}),n=m().createElement("div",null,m().createElement(p.FormattedMessage,{id:"team_members_dropdown.confirmDemoteDescription",defaultMessage:"If you demote yourself from the System Admin role and there is not another user with System Admin privileges, you'll need to re-assign a System Admin by accessing the Mattermost server through a terminal and running the following command."}),m().createElement("br",null),m().createElement("br",null),m().createElement(p.FormattedMessage,{id:"team_members_dropdown.confirmDemotionCmd",defaultMessage:"platform roles system_admin {username}",values:{username:i.username}}),e),a=m().createElement(p.FormattedMessage,{id:"team_members_dropdown.confirmDemotion",defaultMessage:"Confirm Demotion"});d=m().createElement(R.A,{show:this.state.showDemoteModal,title:t,message:n,confirmButtonText:a,onConfirm:this.handleDemoteSubmit,onCancel:this.handleDemoteCancel})}if(!c&&!l&&!o)return m().createElement("div",null,r);const{index:u,totalUsers:h}=this.props;let g=!1;h>3&&h-u<=3&&(g=!0);const f=m().createElement(L.A.ItemAction,{id:"removeFromTeam",onClick:this.handleRemoveFromTeam,text:m().createElement(p.FormattedMessage,{id:"team_members_dropdown.leave_team",defaultMessage:"Remove from Team"})}),b=m().createElement(L.A.ItemAction,{onClick:this.handleMakeAdmin,text:m().createElement(p.FormattedMessage,{id:"team_members_dropdown.makeAdmin",defaultMessage:"Make Team Admin"})}),E=m().createElement(L.A.ItemAction,{onClick:this.handleMakeMember,text:m().createElement(p.FormattedMessage,{id:"team_members_dropdown.makeMember",defaultMessage:"Make Team Member"})});return m().createElement(O.A,null,m().createElement("button",{id:"teamMembersDropdown_".concat(a.username),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true"},m().createElement("span",null,r," "),m().createElement(P.A,null)),m().createElement("div",null,m().createElement(L.A,{openLeft:!0,openUp:g,ariaLabel:s.formatMessage({id:"team_members_dropdown.menuAriaLabel",defaultMessage:"Change the role of a team member"})},c?f:null,l?b:null,o?E:null),d,e))}}D(x,"propTypes",{teamUrl:d().string.isRequired,index:d().number.isRequired,totalUsers:d().number.isRequired,actions:d().shape({getMyTeamMembers:d().func.isRequired,getMyTeamUnreads:d().func.isRequired,getUser:d().func.isRequired,getTeamMember:d().func.isRequired,getTeamStats:d().func.isRequired,getChannelStats:d().func.isRequired,updateTeamMemberSchemeRoles:d().func.isRequired,updateUserActive:d().func.isRequired,removeUserFromTeamAndGetStats:d().func.isRequired}).isRequired});const F=(0,p.injectIntl)(x),U=(0,a.connect)((function(e){return{currentUser:(0,_.HW)(e),teamUrl:(0,r._p)(e),currentTeam:(0,r.H7)(e),collapsedThreads:(0,I.WW)(e)}}),(function(e){return{actions:(0,s.bindActionCreators)({getMyTeamMembers:b.tt,getMyTeamUnreads:b.UR,getUser:E.wz,getTeamMember:b.e6,getTeamStats:b.ls,getChannelStats:w.Fe,updateUserActive:E.tS,updateTeamMemberSchemeRoles:b.bd,removeUserFromTeamAndGetStats:A.RF},e)}}))(F);var B=n(4715);function H(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class q extends m().PureComponent{constructor(e){super(e),H(this,"loadComplete",(()=>{this.setState({loading:!1})})),H(this,"nextPage",(async e=>{this.setState({loading:!0}),await Promise.all([this.props.actions.loadProfilesAndTeamMembers(e,50,this.props.currentTeamId,{active:!0}),this.props.actions.getTeamMembers(this.props.currentTeamId,e,l.Ay.DEFAULT_MAX_USERS_PER_TEAM,{sort:v.P9.SORT_USERNAME_OPTION,exclude_deleted_users:!0})]),this.loadComplete()})),H(this,"search",(e=>{this.props.actions.setModalSearchTerm(e)})),this.searchTimeoutId=0,this.state={loading:!0}}async componentDidMount(){await Promise.all([this.props.actions.loadProfilesAndTeamMembers(0,l.Ay.PROFILE_CHUNK_SIZE,this.props.currentTeamId,{active:!0}),this.props.actions.getTeamMembers(this.props.currentTeamId,0,l.Ay.DEFAULT_MAX_USERS_PER_TEAM,{sort:v.P9.SORT_USERNAME_OPTION,exclude_deleted_users:!0}),this.props.actions.getTeamStats(this.props.currentTeamId)]),this.loadComplete()}componentWillUnmount(){this.props.actions.setModalSearchTerm("")}componentDidUpdate(e){if(e.searchTerm!==this.props.searchTerm){clearTimeout(this.searchTimeoutId);const e=this.props.searchTerm;if(""===e)return this.loadComplete(),void(this.searchTimeoutId=0);const t=window.setTimeout((async()=>{const{loadStatusesForProfilesList:n,loadTeamMembersForProfilesList:a,searchProfiles:s}=this.props.actions,{data:r}=await s(e,{team_id:this.props.currentTeamId});t===this.searchTimeoutId&&(this.setState({loading:!0}),n(r),a(r,this.props.currentTeamId,!0).then((e=>{let{data:t}=e;t&&this.loadComplete()})))}),l.Ay.SEARCH_TIMEOUT_MILLISECONDS);this.searchTimeoutId=t}}render(){let e;this.props.canManageTeamMembers&&(e=[U]);const t=this.props.teamMembers,n=this.props.users,a={};let s;if(this.state.loading)s=null;else{s=[];for(let e=0;e<n.length;e++){const r=n[e];t[r.id]&&0===r.delete_at&&(s.push(r),a[r.id]={teamMember:t[r.id]})}}return m().createElement(S.A,{users:s,usersPerPage:50,total:this.props.totalTeamMembers,nextPage:this.nextPage,search:this.search,actions:e,actionUserProps:a,focusOnMount:!B.Fr()})}}H(q,"propTypes",{searchTerm:d().string.isRequired,users:d().array.isRequired,currentTeamId:d().string.isRequired,totalTeamMembers:d().number.isRequired,canManageTeamMembers:d().bool,actions:d().shape({getTeamMembers:d().func.isRequired,searchProfiles:d().func.isRequired,getTeamStats:d().func.isRequired,loadProfilesAndTeamMembers:d().func.isRequired,loadStatusesForProfilesList:d().func.isRequired,loadTeamMembersForProfilesList:d().func.isRequired,setModalSearchTerm:d().func.isRequired}).isRequired});const j=(0,a.connect)((function(e,t){const n=(0,C.mg)(e,t.teamId,v.xB.MANAGE_TEAM_ROLES),a=e.views.search.modalSearch;let s;s=a?(0,_.QJ)(e,a):(0,_.G1)(e);const i=(0,r.MF)(e)||{active_member_count:0};return{searchTerm:a,users:s,teamMembers:(0,r.XK)(e)||{},currentTeamId:e.entities.teams.currentTeamId,totalTeamMembers:i.active_member_count,canManageTeamMembers:n}}),(function(e){return{actions:(0,s.bindActionCreators)({searchProfiles:E.U,getTeamStats:b.ls,getTeamMembers:b.fP,loadProfilesAndTeamMembers:M.U3,loadStatusesForProfilesList:y.Y5,loadTeamMembersForProfilesList:M.iO,setModalSearchTerm:T.qv},e)}}))(q);var V=n(26808),z=n(30138);function G(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class W extends m().PureComponent{constructor(e){super(e),G(this,"handleHide",(()=>{this.setState({show:!1})})),G(this,"handleInvitePeople",(()=>{const{actions:e}=this.props;e.openModal({modalId:l.IQ.INVITATION,dialogType:f.default}),this.handleHide()})),G(this,"handleExit",(()=>{this.props.focusOriginElement&&(0,z.p)(this.props.focusOriginElement,!0),this.props.onExited()})),this.state={show:!0}}componentDidMount(){this.props.onLoad&&this.props.onLoad()}render(){var e,t;let n="";return this.props.currentTeam&&(n=this.props.currentTeam.display_name),m().createElement(h.Modal,{dialogClassName:"a11y__modal more-modal",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"none","aria-labelledby":"teamMemberModalLabel",id:"teamMembersModal"},m().createElement(h.Modal.Header,{closeButton:!0},m().createElement(h.Modal.Title,{componentClass:"h1",id:"teamMemberModalLabel"},m().createElement(p.FormattedMessage,{id:"team_member_modal.members",defaultMessage:"{team} Members",values:{team:n}})),m().createElement(V.A,{teamId:null===(e=this.props.currentTeam)||void 0===e?void 0:e.id,permissions:[g.A.ADD_USER_TO_TEAM,g.A.INVITE_GUEST]},m().createElement("button",{id:"invitePeople",type:"button",className:"btn btn-primary btn-sm invite-people-btn",onClick:this.handleInvitePeople},m().createElement(p.FormattedMessage,{id:"team_member_modal.invitePeople",defaultMessage:"Invite People"})))),m().createElement(h.Modal.Body,null,m().createElement(j,{teamId:null===(t=this.props.currentTeam)||void 0===t?void 0:t.id})))}}G(W,"propTypes",{onExited:d().func.isRequired,onLoad:d().func,focusOriginElement:d().string,actions:d().shape({openModal:d().func.isRequired}).isRequired});const K=(0,a.connect)((function(e){const t=l.IQ.TEAM_MEMBERS;return{currentTeam:(0,r.H7)(e),show:(0,o.o)(e,t)}}),(function(e){return{actions:(0,s.bindActionCreators)({openModal:i.q},e)}}))(W)},8610:(e,t,n)=>{n.d(t,{A:()=>le});var a=n(23453),s=n(40057),r=n(80635),i=n(14776),o=n(98496),l=n(78451),c=n(62688),d=n.n(c),u=(n(43813),n(17046),n(97023)),m=n.n(u),h=n(34529),p=n(51565),g=n.n(p),f=n(14778),b=n(5908),E=n(23739),v=(n(57406),n(55448),n(76685),n(49698)),C=n(66215),_=(n(4290),n(66963));function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const S={DropdownIndicator:null},w={control:e=>M(M({},e),{},{background:"var(--center-channel-color-rgb)"}),input:e=>M(M({},e),{},{color:"rgba(var(--center-channel-color-rgb), 0.64)"}),multiValue:e=>M(M({},e),{},{borderRadius:"10px",background:"rgba(var(--center-channel-color-rgb), 0.08)",display:"flex",alignItems:"center"}),multiValueLabel:e=>M(M({},e),{},{padding:"4px 6px 4px 10px",color:"var(--center-channel-color)",fontFamily:"Open Sans",fontSize:"10px",fontWeight:600,lineHeight:"12px",letterSpacing:"0.2px"}),multiValueRemove:e=>M(M({},e),{},{borderRadius:"50%",background:"rgba(var(--center-channel-color-rgb), 0.32)",fontFamily:"compass-icons",fontSize:"12px",fontWeight:400,color:"white",width:"10px",height:"10px",padding:0,marginRight:"4px",":hover":{background:"rgba(var(--center-channel-color-rgb), 0.32)",color:"white"}})},I=e=>{let{placeholder:t,value:n,handleNewSelection:a,onChange:s,id:r,isClearable:i,description:o}=e;const[l,c]=m().useState(""),d=(0,u.useCallback)((()=>{null!=n&&n.includes(l.trim())||0===l.length||(a(l),c(""))}),[a,l,n]),h=(0,u.useCallback)((e=>{if(l)switch(e.key){case" ":case",":case"Enter":d(),e.preventDefault()}}),[l,d]),p=(0,u.useMemo)((()=>n.map((e=>({label:e,value:e})))),[n]);return m().createElement(m().Fragment,null,m().createElement(_.A,{id:r,className:"select-text-input",styles:w,components:S,isClearable:i,onChange:(0,u.useCallback)((e=>s(e)),[s]),inputValue:l,isMulti:!0,menuIsOpen:!1,onInputChange:c,onKeyDown:h,placeholder:t,value:p,onBlur:d}),o?m().createElement("p",{className:"select-text-description"},o):void 0)};var A=n(66549);const N=e=>{let{allowedDomains:t,setAllowedDomains:n,setHasChanges:a,setSaveChangesPanelState:s}=e;const[r,i]=(0,u.useState)(t.length>0),{formatMessage:o}=(0,f.useIntl)(),l=(0,u.useCallback)((e=>{i(e),e||n([])}),[n]),c=(0,u.useCallback)((e=>{a(!0),s("editing"),n([...t,e])}),[t,n,a,s]),d=(0,u.useCallback)((e=>{a(!0),s("editing"),n((null==e?void 0:e.map((e=>e.value)))||[])}),[n,a,s]);return m().createElement(m().Fragment,null,m().createElement(A.A,{inputFieldTitle:m().createElement(f.FormattedMessage,{id:"general_tab.allowedDomains",defaultMessage:"Allow only users with a specific email domain to join this team"}),"data-testid":"allowedDomainsCheckbox",className:"access-allowed-domains-section",title:o({id:"general_tab.AllowedDomainsTitle",defaultMessage:"Users with a specific email domain"}),description:o({id:"general_tab.AllowedDomainsInfo",defaultMessage:'When enabled, users can only join the team if their email matches a specific domain (e.g. "mattermost.org")'}),descriptionAboveContent:!0,inputFieldData:{name:"showAllowedDomains"},inputFieldValue:r,handleChange:l}),r&&m().createElement(I,{id:"allowedDomains",placeholder:o({id:"general_tab.AllowedDomainsExample",defaultMessage:"corp.mattermost.com, mattermost.com"}),"aria-label":o({id:"general_tab.allowedDomains.ariaLabel",defaultMessage:"Allowed Domains"}),value:t,onChange:d,handleNewSelection:c,isClearable:!1,description:o({id:"general_tab.AllowedDomainsTip",defaultMessage:"Seperate multiple domains with a space, comma, tab or enter."})}))};N.propTypes={allowedDomains:d().arrayOf(d().string).isRequired,setAllowedDomains:d().func.isRequired,setHasChanges:d().func.isRequired,setSaveChangesPanelState:d().func.isRequired};const R=N;var P=n(85406),L=n(98566),O=n(8589);const k=(0,f.defineMessages)({OpenInviteDescriptionError:{id:"team_settings.openInviteDescription.error",defaultMessage:"There was an error generating the invite code, please try again"}}),D=e=>{var t;let{regenerateTeamInviteId:n}=e;const o=(0,a.useSelector)((e=>(0,i.H7)(e))),l=(0,a.useSelector)((e=>(0,r.mg)(e,(null==o?void 0:o.id)||"",s.xB.INVITE_USER))),[c,d]=(0,u.useState)(null!==(t=null==o?void 0:o.invite_id)&&void 0!==t?t:""),[h,p]=(0,u.useState)(),{formatMessage:g}=(0,f.useIntl)();(0,u.useEffect)((()=>{d((null==o?void 0:o.invite_id)||"")}),[null==o?void 0:o.invite_id]);const b=(0,u.useCallback)((async()=>{const{data:e,error:t}=await n((null==o?void 0:o.id)||"");null!=e&&e.invite_id?d(e.invite_id):t&&p(k.OpenInviteDescriptionError)}),[n,null==o?void 0:o.id]);if(!l)return null;const E=m().createElement("div",{"data-testid":"teamInviteContainer",id:"teamInviteContainer"},m().createElement(L.A,{id:"teamInviteId",type:"text",value:c,maxLength:32}),m().createElement("button",{"data-testid":"regenerateButton",id:"regenerateButton",className:"btn btn-tertiary",onClick:b},m().createElement(P.RefreshIcon,null),g({id:"general_tab.regenerate",defaultMessage:"Regenerate"})));return m().createElement(O.A,{className:"access-invite-section",title:g({id:"general_tab.codeTitle",defaultMessage:"Invite Code"}),description:g({id:"general_tab.codeLongDesc",defaultMessage:"The Invite Code is part of the unique team invitation link which is sent to members youâ€™re inviting to this team. Regenerating the code creates a new invitation link and invalidates the previous link."}),content:E,error:h,descriptionAboveContent:!0})};D.propTypes={regenerateTeamInviteId:d().func.isRequired};const x=D;var F=n(17518);const U=e=>{let{isGroupConstrained:t,allowOpenInvite:n,setAllowOpenInvite:a}=e;const{formatMessage:s}=(0,f.useIntl)();if(t){const e=m().createElement("p",{id:"groupConstrainedContent"},s({id:"team_settings.openInviteDescription.groupConstrained",defaultMessage:"Members of this team are added and removed by linked groups. <link>Learn More</link>"},{link:e=>m().createElement(F.A,{href:"https://mattermost.com/pl/default-ldap-group-constrained-team-channel.html",location:"open_invite"},e)}));return m().createElement(O.A,{className:"access-invite-domains-section",title:s({id:"general_tab.openInviteText",defaultMessage:"Users on this server"}),description:s({id:"general_tab.openInviteDesc",defaultMessage:"When enabled, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing this setting will create a new invitation link and invalidate the previous link."}),descriptionAboveContent:!0,content:e})}return m().createElement(A.A,{className:"access-invite-domains-section",inputFieldTitle:m().createElement(f.FormattedMessage,{id:"general_tab.openInviteTitle",defaultMessage:"Allow any user with an account on this server to join this team"}),inputFieldData:{name:"allowOpenInvite"},inputFieldValue:n,handleChange:a,title:s({id:"general_tab.openInviteText",defaultMessage:"Users on this server"}),description:s({id:"general_tab.openInviteDesc",defaultMessage:"When enabled, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing this setting will create a new invitation link and invalidate the previous link."}),descriptionAboveContent:!0})};U.propTypes={allowOpenInvite:d().bool.isRequired,isGroupConstrained:d().bool,setAllowOpenInvite:d().func.isRequired};const B=U,H=e=>e&&0!==e.length?(e.includes(",")?e.split(","):[e]).map((e=>e.trim())):[],q=(0,a.connect)(null,(function(e){return{actions:(0,b.bindActionCreators)({patchTeam:E.Oy,regenerateTeamInviteId:E.US},e)}}))((e=>{var t;let{closeModal:n,collapseModal:a,hasChangeTabError:s,hasChanges:r,setHasChangeTabError:i,setHasChanges:o,team:l,actions:c}=e;const[d,h]=(0,u.useState)((()=>H(l.allowed_domains))),[p,g]=(0,u.useState)(null!==(t=l.allow_open_invite)&&void 0!==t&&t),[b,E]=(0,u.useState)(),{formatMessage:_}=(0,f.useIntl)(),y=(0,u.useCallback)((async()=>{const{error:e}=await c.patchTeam({id:l.id,allowed_domains:1===d.length?d[0]:d.join(", ")});return!e}),[c,d,l]),M=(0,u.useCallback)((async()=>{if(p===l.allow_open_invite)return!0;const e={id:l.id,allow_open_invite:p},{error:t}=await c.patchTeam(e);return!t}),[c,p,l]),T=(0,u.useCallback)((e=>{o(!0),E("editing"),g(e)}),[o]),S=(0,u.useCallback)((()=>{E("editing"),o(!1),i(!1)}),[i,o]),w=(0,u.useCallback)((()=>{var e;h(H(l.allowed_domains)),g(null!==(e=l.allow_open_invite)&&void 0!==e&&e),S()}),[S,l.allow_open_invite,l.allowed_domains]),I=(0,u.useCallback)((()=>{r?i(!0):a()}),[a,r,i]),A=(0,u.useCallback)((async()=>{const e=await y(),t=await M();e&&t?(E("saved"),i(!1)):E("error")}),[y,M,i]);return m().createElement(v.A,{content:m().createElement(m().Fragment,null,m().createElement("div",{className:"modal-header"},m().createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal",onClick:n},m().createElement("span",{"aria-hidden":"true"},"Ã—")),m().createElement("h4",{className:"modal-title"},m().createElement("div",{className:"modal-back"},m().createElement("i",{className:"fa fa-angle-left","aria-label":_({id:"generic_icons.collapse",defaultMessage:"Collapes Icon"}),onClick:I})),m().createElement("span",null,_({id:"team_settings_modal.title",defaultMessage:"Team Settings"})))),m().createElement("div",{className:"modal-access-tab-content user-settings",id:"accessSettings","aria-labelledby":"accessButton",role:"tabpanel"},l.group_constrained?void 0:m().createElement(R,{allowedDomains:d,setAllowedDomains:h,setHasChanges:o,setSaveChangesPanelState:E}),m().createElement("div",{className:"divider-light"}),m().createElement(B,{isGroupConstrained:l.group_constrained,allowOpenInvite:p,setAllowOpenInvite:T}),m().createElement("div",{className:"divider-light"}),l.group_constrained?void 0:m().createElement(x,{regenerateTeamInviteId:c.regenerateTeamInviteId}),r?m().createElement(C.A,{handleCancel:w,handleSubmit:A,handleClose:S,tabChangeError:s,state:b}):void 0))})}));n(83931);var j=n(26614);const V=e=>{let{handleDescriptionChanges:t,clientError:n,description:a}=e;const{formatMessage:s}=(0,f.useIntl)(),r=(0,u.useCallback)((e=>{t(e.target.value)}),[t]),i=m().createElement(L.A,{id:"teamDescription","data-testid":"teamDescriptionInput",containerClassName:"description-section-input",type:"textarea",maxLength:l.Ay.MAX_TEAMDESCRIPTION_LENGTH,onChange:r,value:a,label:s({id:"general_tab.teamDescription",defaultMessage:"Description"})});return m().createElement(O.A,{description:s({id:"general_tab.teamDescriptionInfo",defaultMessage:"Team description provides additional information to help users select the right team. Maximum of 50 characters."}),content:i,className:"description-setting-item",error:n})},z=e=>{let{clientError:t,handleNameChanges:n,name:a}=e;const{formatMessage:s}=(0,f.useIntl)(),r=(0,u.useCallback)((e=>n(e.target.value)),[n]),i=m().createElement(L.A,{id:"teamName","data-testid":"teamNameInput",type:"text",maxLength:l.Ay.MAX_TEAMNAME_LENGTH,onChange:r,value:a,label:s({id:"general_tab.teamName",defaultMessage:"Team Name"})});return m().createElement(O.A,{title:s({id:"general_tab.teamInfo",defaultMessage:"Team info"}),description:s({id:"general_tab.teamNameInfo",defaultMessage:"This name will appear on your sign-in screen and at the top of the left sidebar."}),content:i,error:t})};n(60473),n(36169);var G=n(12026),W=n(68124),K=n(85873);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function J(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Q=e=>{let{team:t,file:n,teamName:a,disabled:s,onFileChange:r,onRemove:i,clientError:o}=e;const c=(0,u.useRef)(null),[d,h]=(0,u.useState)(""),[p,g]=(0,u.useState)(),{formatMessage:b}=(0,f.useIntl)(),E=(0,K.lt)(t),v=(0,u.useCallback)((()=>{c.current&&(c.current.value="",c.current.click())}),[]);(0,u.useEffect)((()=>{n&&(e=>{if(e){const t=URL.createObjectURL(e),n=new FileReader;n.onload=e=>{const n=W.hM(e.target.result),a=W.R6(n);h(t),g(a)},n.readAsArrayBuffer(e)}})(n)}),[n]);const C=m().createElement(m().Fragment,null,m().createElement("div",{className:"team-picture-section"},(()=>{if(n){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({backgroundImage:"url("+d+")",backgroundSize:"cover",backgroundRepeat:"round"},p);return m().createElement("div",{id:"teamIconImage",style:e,className:"team-img-preview",onClick:v})}return E?m().createElement("img",{id:"teamIconImage",className:"team-img-preview",src:E,onClick:v}):m().createElement("div",{className:"team-picture-section__team-icon"},m().createElement("span",{id:"teamIconInitial",onClick:v,className:"team-picture-section__team-name"},a.charAt(0).toUpperCase()+a.charAt(1)))})(),m().createElement(m().Fragment,null,m().createElement("input",{"data-testid":"uploadPicture",ref:c,className:"hidden",accept:l.Ay.ACCEPT_STATIC_IMAGE,disabled:s,type:"file",onChange:r,"aria-hidden":!0,tabIndex:-1}),m().createElement("span",{disabled:s,onClick:v},m().createElement(G.A,null)))),n||E?m().createElement("button",{onClick:i,"data-testid":"removeImageButton",className:"style--none picture-setting-item__remove-button"},m().createElement(P.TrashCanOutlineIcon,null),b({id:"setting_picture.remove_image",defaultMessage:"Remove image"})):null);return m().createElement(O.A,{title:b({id:"setting_picture.title",defaultMessage:"Team Icon"}),description:E?void 0:b({id:"setting_picture.help.profile",defaultMessage:"Upload a picture in BMP, JPG, JPEG, or PNG format. Maximum file size: {max}"},{max:"50MB"}),content:C,className:"picture-setting-item",error:o})};Q.propTypes={teamName:d().string.isRequired,disabled:d().bool.isRequired,onFileChange:d().func.isRequired,onRemove:d().func.isRequired};const Z=Q,X=["image/jpeg","image/png","image/bmp"],$=(0,f.defineMessages)({Required:{id:"general_tab.required",defaultMessage:"This field is required"},TeamNameRestrictions:{id:"general_tab.teamNameRestrictions",defaultMessage:"Team Name must be {min} or more characters up to a maximum of {max}. You can add a longer team description.",values:{min:l.Ay.MIN_TEAMNAME_LENGTH,max:l.Ay.MAX_TEAMNAME_LENGTH}},TeamIconInvalidFileType:{id:"general_tab.teamIconInvalidFileType",defaultMessage:"Only BMP, JPG or PNG images may be used for team icons"},TeamIconTooLarge:{id:"general_tab.teamIconTooLarge",defaultMessage:"Unable to upload team icon. File is too large."},TeamIconError:{id:"general_tab.teamIconError",defaultMessage:"An error occurred while selecting the image."}}),ee=(0,a.connect)((function(e){var t;const n=(0,j.zj)(e);return{maxFileSize:parseInt(null!==(t=n.MaxFileSize)&&void 0!==t?t:"",10)}}),(function(e){return{actions:(0,b.bindActionCreators)({getTeam:E.Uo,patchTeam:E.Oy,removeTeamIcon:E.zz,setTeamIcon:E.PY},e)}}))((e=>{var t;let{team:n,hasChanges:a,maxFileSize:s,closeModal:r,collapseModal:i,hasChangeTabError:o,setHasChangeTabError:c,setHasChanges:d,actions:h}=e;const[p,g]=(0,u.useState)(n.display_name),[b,E]=(0,u.useState)(n.description),[_,y]=(0,u.useState)(),[M,T]=(0,u.useState)(!1),[S,w]=(0,u.useState)(),[I,A]=(0,u.useState)(),[N,R]=(0,u.useState)(),{formatMessage:P}=(0,f.useIntl)(),L=(0,u.useCallback)((async()=>{if(p.trim()===n.display_name&&b===n.description)return!0;if(!p)return A($.Required),!1;if(p.length<l.Ay.MIN_TEAMNAME_LENGTH)return A($.TeamNameRestrictions),!1;A(void 0);const{error:e}=await h.patchTeam({id:n.id,display_name:p,description:b});return!e}),[h,b,p,n.description,n.display_name,n.id]),O=(0,u.useCallback)((async()=>{if(!_)return!0;T(!0),w(void 0);const{error:e}=await h.setTeamIcon(n.id,_);return T(!1),!e}),[h,n,_]),k=(0,u.useCallback)((async()=>{const e=await L();await O()&&e?(R("saved"),c(!1)):R("error")}),[L,O,c]),D=(0,u.useCallback)((()=>{R("editing"),d(!1),c(!1)}),[c,d]),x=(0,u.useCallback)((()=>{var e;g(null!==(e=n.display_name)&&void 0!==e?e:n.name),E(n.description),y(void 0),w(void 0),A(void 0),D()}),[D,n.description,n.display_name,n.name]),F=(0,u.useCallback)((async()=>{T(!0),w(void 0),y(void 0),D();const{error:e}=await h.removeTeamIcon(n.id);T(!1),e&&(R("error"),d(!0),c(!0))}),[h,D,c,d,n.id]),U=(0,u.useCallback)((e=>{if(e&&e.target&&e.target.files&&e.target.files[0]){const t=e.target.files[0];X.includes(t.type)?t.size>s?w($.TeamIconTooLarge):(y(t),w(void 0),R("editing"),d(!0)):w($.TeamIconInvalidFileType)}else y(void 0),w($.TeamIconError)}),[s,d]),B=(0,u.useCallback)((e=>{d(!0),R("editing"),g(e)}),[d]),H=(0,u.useCallback)((e=>{d(!0),R("editing"),E(e)}),[d]),q=(0,u.useCallback)((()=>{a?c(!0):i()}),[i,a,c]),j=m().createElement(m().Fragment,null,m().createElement("div",{className:"modal-header"},m().createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal",onClick:r},m().createElement("span",{"aria-hidden":"true"},"Ã—")),m().createElement("h4",{className:"modal-title"},m().createElement("div",{className:"modal-back"},m().createElement("i",{className:"fa fa-angle-left","aria-label":P({id:"generic_icons.collapse",defaultMessage:"Collapes Icon"}),onClick:q})),m().createElement("span",null,P({id:"team_settings_modal.title",defaultMessage:"Team Settings"})))),m().createElement("div",{className:"modal-info-tab-content user-settings",id:"infoSettings","aria-labelledby":"infoButton",role:"tabpanel"},m().createElement("div",{className:"name-description-container"},m().createElement(z,{name:p,clientError:I,handleNameChanges:B}),m().createElement(V,{description:b,handleDescriptionChanges:H})),m().createElement(Z,{team:n,file:_,disabled:M,onFileChange:U,onRemove:F,teamName:null!==(t=n.display_name)&&void 0!==t?t:n.name,clientError:S}),a?m().createElement(C.A,{handleCancel:x,handleSubmit:k,handleClose:D,tabChangeError:o,state:N}):void 0));return m().createElement(v.A,{content:j})})),te=e=>{let t,{activeTab:n="",closeModal:a,collapseModal:s,team:r,hasChanges:i,hasChangeTabError:o,setHasChanges:l,setHasChangeTabError:c}=e;if(!r)return null;switch(n){case"info":t=m().createElement(ee,{team:r,hasChanges:i,setHasChanges:l,hasChangeTabError:o,setHasChangeTabError:c,closeModal:a,collapseModal:s});break;case"access":t=m().createElement(q,{team:r,hasChanges:i,setHasChanges:l,hasChangeTabError:o,setHasChangeTabError:c,closeModal:a,collapseModal:s});break;default:t=m().createElement("div",null)}return t};te.propTypes={activeTab:d().string.isRequired,hasChanges:d().bool.isRequired,hasChangeTabError:d().bool.isRequired,setHasChanges:d().func.isRequired,setHasChangeTabError:d().func.isRequired,closeModal:d().func.isRequired,collapseModal:d().func.isRequired};const ne=te,ae=(0,a.connect)((function(e){return{team:(0,i.H7)(e)}}))(ne);var se=n(30138);const re=m().lazy((()=>n.e(9163).then(n.bind(n,61544)))),ie=e=>{let{onExited:t,canInviteUsers:n,focusOriginElement:a}=e;const[s,r]=(0,u.useState)("info"),[i,o]=(0,u.useState)(!0),[l,c]=(0,u.useState)(!1),[d,p]=(0,u.useState)(!1),b=(0,u.useRef)(null),{formatMessage:E}=(0,f.useIntl)(),v=(0,u.useCallback)((e=>{l?p(!0):(r(e),c(!1),p(!1))}),[l]),C=(0,u.useCallback)((()=>o(!1)),[]),_=(0,u.useCallback)((()=>{a&&(0,se.p)(a,!0),r("info"),c(!1),p(!1),t()}),[t,a]),y=(0,u.useCallback)((()=>{const e=g().findDOMNode(b.current);null==e||e.closest(".modal-dialog").classList.remove("display--content"),r("")}),[]),M=[{name:"info",uiName:E({id:"team_settings_modal.infoTab",defaultMessage:"Info"}),icon:"icon icon-information-outline",iconTitle:E({id:"generic_icons.info",defaultMessage:"Info Icon"})}];return n&&M.push({name:"access",uiName:E({id:"team_settings_modal.accessTab",defaultMessage:"Access"}),icon:"icon icon-account-multiple-outline",iconTitle:E({id:"generic_icons.member",defaultMessage:"Member Icon"})}),m().createElement(h.Modal,{dialogClassName:"a11y__modal settings-modal",show:i,onHide:C,onExited:_,role:"none","aria-labelledby":"teamSettingsModalLabel",id:"teamSettingsModal"},m().createElement(h.Modal.Header,{id:"teamSettingsModalLabel",closeButton:!0},m().createElement(h.Modal.Title,{componentClass:"h2",className:"modal-header__title"},E({id:"team_settings_modal.title",defaultMessage:"Team Settings"}))),m().createElement(h.Modal.Body,{ref:b},m().createElement("div",{className:"settings-table"},m().createElement("div",{className:"settings-links"},m().createElement(m().Suspense,{fallback:null},m().createElement(re,{tabs:M,activeTab:s,updateTab:v}))),m().createElement("div",{className:"settings-content minimize-settings"},m().createElement(ae,{activeTab:s,hasChanges:l,setHasChanges:c,hasChangeTabError:d,setHasChangeTabError:p,closeModal:C,collapseModal:y})))))};ie.propTypes={onExited:d().func.isRequired,canInviteUsers:d().bool.isRequired,focusOriginElement:d().string};const oe=ie,le=(0,a.connect)((function(e){const t=(0,i.Sy)(e),n=(0,r.mg)(e,t,s.xB.INVITE_USER),a=l.IQ.TEAM_SETTINGS;return{show:(0,o.o)(e,a),canInviteUsers:n}}))(oe)},12026:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(97023),s=n.n(a),r=n(14778);function i(){const{formatMessage:e}=(0,r.useIntl)();return s().createElement("i",{className:"icon-pencil-outline",title:e({id:"generic_icons.edit",defaultMessage:"Edit Icon"})})}},66215:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(62688),s=n.n(a),r=n(71633),i=n.n(r),o=n(97023),l=n.n(o),c=n(14778),d=n(85406);function u(e){let{handleSubmit:t,handleCancel:n,handleClose:a,tabChangeError:s=!1,state:r="editing",customErrorMessage:u,saveButtonText:m,cancelButtonText:h}=e;const p=i()("SaveChangesPanel",{error:s||"error"===r},{saved:"saved"===r}),g=i()("SaveChangesPanel__message",{error:s||"error"===r},{saved:"saved"===r}),f=i()("SaveChangesPanel__cancel-btn",{error:s||"error"===r},{saved:"saved"===r}),b=i()("SaveChangesPanel__save-btn",{error:s||"error"===r},{saved:"saved"===r});return(0,o.useEffect)((()=>{let e;return"saved"===r&&(e=setTimeout((()=>{a()}),1200)),()=>clearTimeout(e)}),[a,r]),l().createElement("div",{className:p},l().createElement("p",{className:g},l().createElement(d.AlertCircleOutlineIcon,{size:18,color:"currentcolor"}),u&&(s||"error"===r)?u:s||"editing"===r?l().createElement(c.FormattedMessage,{id:"saveChangesPanel.message",defaultMessage:"You have unsaved changes"}):"error"===r?l().createElement(c.FormattedMessage,{id:"saveChangesPanel.error",defaultMessage:"There was an error saving your settings"}):l().createElement(c.FormattedMessage,{id:"saveChangesPanel.saved",defaultMessage:"Settings saved"})),(()=>{if("saved"===r)return l().createElement("div",{className:"SaveChangesPanel__btn-ctr"},l().createElement("button",{id:"panelCloseButton","data-testid":"panelCloseButton",type:"button",className:"btn btn-icon btn-sm",onClick:a},l().createElement("i",{className:"icon icon-close"})));const e=s||"error"===r;return l().createElement("div",{className:"SaveChangesPanel__btn-ctr"},l().createElement("button",{"data-testid":"SaveChangesPanel__cancel-btn",className:f,onClick:n},h||l().createElement(c.FormattedMessage,{id:"saveChangesPanel.cancel",defaultMessage:"Undo"})),l().createElement("button",{"data-testid":"SaveChangesPanel__save-btn",className:b,onClick:t,disabled:e},m||l().createElement(c.FormattedMessage,{id:"saveChangesPanel.save",defaultMessage:"Save"})))})())}u.propTypes={handleSubmit:s().func.isRequired,handleCancel:s().func.isRequired,handleClose:s().func.isRequired,tabChangeError:s().bool,customErrorMessage:s().string,saveButtonText:s().node,cancelButtonText:s().node};const m=u},92159:(e,t,n)=>{n.d(t,{H:()=>s,K:()=>r});const a={},s=(e,t)=>e.entities.channelBookmarks.byChannelId[t]||a,r=(e,t,n)=>s(e,t)[n]},49176:(e,t,n)=>{n.d(t,{Cu:()=>r,SM:()=>i,j4:()=>l});var a=n(8361),s=n(77440);function r(e){return e.views.lhs.isOpen}function i(e){return e.views.lhs.currentStaticPageId}const o=(0,n(67173).wV)(),l=(0,a.Mz)("getVisibleSidebarStaticPages",s.WW,o,((e,t)=>{const n=[];return e&&n.push({id:"threads",isVisible:!0}),n.push({id:"drafts",isVisible:t>0}),n.filter((e=>e.isVisible))}))}}]);
//# sourceMappingURL=5930.d47cc82b08bd4deef812.js.map