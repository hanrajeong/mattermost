"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[5638],{5638:(e,t,a)=>{a.r(t),a.d(t,{default:()=>J}),a(17046);var n=a(23453),r=a(81911),s=a(5908),i=a(23739),o=a(65952),m=a(26614),l=a(77440),c=a(14776),d=a(46859),u=a(69657),p=a(49176),h=a(78451),b=(a(4290),a(29206),a(83931),a(71633)),g=a.n(b),f=a(97023),y=a.n(f),T=a(22005),v=a(35880),E=a(14778),I=a(16983),w=a(72208),N=(a(57406),a(55448),a(62688)),O=a.n(N),_=(a(1112),a(10844),a(59671)),M=a(85236),C=a(87131),P=a(61190),S=a(3295);const k=["btnClass","url","displayName","order","unread","mentions","teamIconUrl","isDraggable","switchTeam","teamIndex","teamId","tip"],D=(0,E.defineMessages)({nameUndefined:{id:"team.button.name_undefined",defaultMessage:"This team does not have a name"}});function K(e){let{btnClass:t,url:a,displayName:n,order:s,unread:i,mentions:o,teamIconUrl:m,isDraggable:l=!1,switchTeam:c,teamIndex:d,teamId:u,tip:p}=e,h=function(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;a[n]=e[n]}return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.includes(a)||{}.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}(e,k);const{formatMessage:b}=(0,E.useIntl)(),v=(0,f.useCallback)((e=>{(0,_.Gy)(S.CU.TeamLinkClicked),e.preventDefault(),c(a),setTimeout((()=>{(0,_.sx)("ui","ui_team_sidebar_switch_team")}),0)}),[c,a]);let I=h.active?"active":"";const w=!a.endsWith("create_team")&&!a.endsWith("select_team");let N,O=b({id:"team.button.ariaLabel",defaultMessage:"{teamName} team"},{teamName:n});I||(i&&!h.isInProduct?(I="unread",N=y().createElement("span",{"data-testid":"team-badge-"+u,className:"unread-badge"})):I=w?"":"special",O=b({id:"team.button.unread.ariaLabel",defaultMessage:"{teamName} team unread"},{teamName:n}),o&&(O=b({id:"team.button.mentions.ariaLabel",defaultMessage:"{teamName} team, {mentionCount} mentions"},{teamName:n,mentionCount:o}),N=y().createElement("span",{"data-testid":"team-badge-"+u,className:g()("badge badge-max-number pull-right small",{urgent:h.hasUrgent})},o>99?"99+":o))),O=O.toLowerCase();const C=y().createElement(M.A,{className:I,withHover:!0,content:h.content||n||"",url:m});let P;void 0!==s&&s<10&&h.showOrder&&(P=y().createElement("div",{className:"order-indicator"},s));const D=y().createElement(U,{order:s,tip:p},y().createElement("div",{className:"team-btn "+t},!h.isInProduct&&N,C)),K=y().createElement(r.Link,{id:"".concat(a.slice(1),"TeamButton"),"aria-label":w?O:n,to:a,onClick:v},D);return l?y().createElement(T.Draggable,{draggableId:u,index:d},((e,t)=>y().createElement(r.Link,Object.assign({to:a,id:"".concat(a.slice(1),"TeamButton"),"aria-label":O,onClick:v,className:"draggable-team-container inline-block",ref:e.innerRef},e.draggableProps,e.dragHandleProps),y().createElement("div",{className:g()(["team-container ".concat(I),{isDragging:t.isDragging}])},D,P)))):y().createElement("div",{"data-testid":"team-container-"+u,className:"team-container ".concat(I)},K,P)}function U(e){let{order:t,tip:a,children:n}=e;const r=(0,E.useIntl)(),s=(0,f.useMemo)((()=>{if(t&&!(t>=10))return{default:[P.f.ctrl,P.f.alt,t.toString()],mac:[P.f.cmd,P.f.option,t.toString()]}}),[t]);return y().isValidElement(n)?y().createElement(C.A,{title:a||r.formatMessage(D.nameUndefined),shortcut:s},n):null}K.propTypes={btnClass:O().string,url:O().string.isRequired,displayName:O().string,content:O().node,tip:O().oneOfType([O().string,O().element]).isRequired,order:O().number,showOrder:O().bool,active:O().bool,unread:O().bool,mentions:O().number,placement:O().oneOf(["left","right","top","bottom"]),teamIconUrl:O().oneOfType([O().string,O().oneOf([null])]),switchTeam:O().func.isRequired,isDraggable:O().bool,teamIndex:O().number,teamId:O().string,isInProduct:O().bool,hasUrgent:O().bool};var j=a(7344),x=a(694),L=a(19513),A=a(75792),H=a(8389),R=a(85873);function W(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Y(e){return y().createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function V(e){return y().createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function F(e){return y().createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}class z extends y().PureComponent{constructor(e){super(e),W(this,"switchToPrevOrNextTeam",((e,t,a)=>{if(L.e(e,h.YM.KeyCodes.UP)||L.e(e,h.YM.KeyCodes.DOWN)){e.preventDefault();const n=L.e(e,h.YM.KeyCodes.DOWN)?1:-1,r=a.findIndex((e=>e.id===t)),s=r+n;let i;return i=-1===s?a[a.length-1]:s===a.length?a[0]:a[s],this.props.actions.switchTeam("/".concat(i.name)),!0}return!1})),W(this,"switchToTeamByNumber",((e,t,a)=>{const n=[h.YM.KeyCodes.ONE,h.YM.KeyCodes.TWO,h.YM.KeyCodes.THREE,h.YM.KeyCodes.FOUR,h.YM.KeyCodes.FIVE,h.YM.KeyCodes.SIX,h.YM.KeyCodes.SEVEN,h.YM.KeyCodes.EIGHT,h.YM.KeyCodes.NINE,h.YM.KeyCodes.ZERO];for(const r in n)if(L.e(e,n[r])&&parseInt(r,10)<a.length){if(e.preventDefault(),a[r].id===t)return!1;const n=a[r];return this.props.actions.switchTeam("/".concat(n.name)),!0}return!1})),W(this,"handleKeyDown",(e=>{if((e.ctrlKey||e.metaKey)&&e.altKey){const{currentTeamId:t}=this.props,a=(0,H.y)(this.props.myTeams,this.props.locale,this.props.userTeamsOrderPreference);if(this.switchToPrevOrNextTeam(e,t,a))return;if(this.switchToTeamByNumber(e,t,a))return;this.setState({showOrder:!0})}})),W(this,"handleKeyUp",(e=>{(e.ctrlKey||e.metaKey)&&e.altKey||this.setState({showOrder:!1})})),W(this,"onDragEnd",(e=>{const{updateTeamsOrderForUser:t}=this.props.actions;if(!e.destination)return;const a=(0,H.y)(this.props.myTeams,this.props.locale,this.props.userTeamsOrderPreference),n=e.source.index,r=e.destination.index,s=((e,t,n)=>[...e.slice(0,t),a.find((e=>e.id===n)),...e.slice(t,e.length)])((o=n,[...(i=a).slice(0,o),...i.slice(o+1,i.length)]),r,e.draggableId);var i,o;t(s.map((e=>e.id))),this.setState({teamsOrder:s})})),this.state={showOrder:!1,teamsOrder:[]}}componentDidUpdate(e){e.currentTeamId!==this.props.currentTeamId&&this.props.enableWebSocketEventScope&&j.A.updateActiveTeam(this.props.currentTeamId)}componentDidMount(){this.props.actions.getTeams(0,200),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}render(){const{intl:e}=this.props,t=document.querySelector("#root");if(this.props.myTeams.length<=1)return t.classList.remove("multi-teams"),null;t.classList.add("multi-teams");const a=[],n=(0,H.y)(this.props.myTeams,this.props.locale,this.props.userTeamsOrderPreference),r=(0,A.$4)(this.props.products,this.props.location.pathname);if(r&&!r.showTeamSidebar)return null;const s=n.map(((e,t)=>y().createElement(K,{key:"switch_team_"+e.name,url:"/".concat(e.name),tip:e.display_name,active:e.id===this.props.currentTeamId,displayName:e.display_name,order:t+1,showOrder:this.state.showOrder,unread:this.props.unreadTeamsSet.has(e.id),mentions:this.props.mentionsInTeamMap.has(e.id)?this.props.mentionsInTeamMap.get(e.id):0,hasUrgent:!!this.props.teamHasUrgentMap.has(e.id)&&this.props.teamHasUrgentMap.get(e.id),teamIconUrl:R.lt(e),switchTeam:t=>this.props.actions.switchTeam(t,r?e:void 0),isDraggable:!0,teamId:e.id,teamIndex:t,isInProduct:Boolean(r)}))),i=[],o=y().createElement("i",{className:"icon icon-plus",role:"img","aria-label":e.formatMessage({id:"sidebar.team_menu.button.plusIcon",defaultMessage:"Plus Icon"})});return this.props.moreTeamsToJoin&&!this.props.experimentalPrimaryTeam?i.push(y().createElement(K,{btnClass:"team-btn__add",key:"more_teams",url:"/select_team",tip:y().createElement(E.FormattedMessage,{id:"team_sidebar.join",defaultMessage:"Other teams you can join"}),content:o,switchTeam:this.props.actions.switchTeam,displayName:e.formatMessage({id:"team_sidebar.join",defaultMessage:"Other teams you can join"})})):i.push(y().createElement(w.A,{permissions:[I.A.CREATE_TEAM],key:"more_teams"},y().createElement(K,{btnClass:"team-btn__add",url:"/create_team",tip:y().createElement(E.FormattedMessage,{id:"navbar_dropdown.create",defaultMessage:"Create a Team"}),content:o,switchTeam:this.props.actions.switchTeam,displayName:e.formatMessage({id:"navbar_dropdown.create",defaultMessage:"Create a Team"})}))),!r&&a.push(y().createElement("div",{key:"team-sidebar-bottom-plugin",className:"team-sidebar-bottom-plugin is-empty"},y().createElement(x.default,{pluggableName:"BottomTeamSidebar"}))),y().createElement("div",{className:g()("team-sidebar",{"move--right":this.props.isOpen}),role:"navigation","aria-labelledby":"teamSidebarWrapper"},y().createElement("div",{className:"team-wrapper",id:"teamSidebarWrapper"},y().createElement(v.Ay,{autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:V,renderThumbVertical:F,renderView:Y},y().createElement(T.DragDropContext,{onDragEnd:this.onDragEnd},y().createElement(T.Droppable,{droppableId:"my_teams",type:"TEAM_BUTTON"},(e=>y().createElement("div",Object.assign({ref:e.innerRef},e.droppableProps),s,e.placeholder)))),i)),a)}}const B=(0,E.injectIntl)(z),q=(0,n.connect)((function(e){const t=(0,m.zj)(e),a=t.ExperimentalPrimaryTeam,n=(0,c.sZ)(e),r=n&&n.length>0,s=e.plugins.components.Product||[],[i,d,b]=(0,o.O$)(e),g="true"===t.FeatureFlagWebSocketEventScope;return{currentTeamId:(0,c.Sy)(e),myTeams:(0,c.vt)(e),isOpen:(0,p.Cu)(e),experimentalPrimaryTeam:a,locale:(0,u.k)(e),moreTeamsToJoin:r,userTeamsOrderPreference:(0,l.Jt)(e,h.pm.TEAMS_ORDER,"",""),products:s,unreadTeamsSet:i,mentionsInTeamMap:d,teamHasUrgentMap:b,enableWebSocketEventScope:g}}),(function(e){return{actions:(0,s.bindActionCreators)({getTeams:i.ZN,switchTeam:d._I,updateTeamsOrderForUser:d.uL},e)}})),J=(0,r.withRouter)(q(B))},85236:(e,t,a)=>{a.d(t,{A:()=>p});var n=a(62688),r=a.n(n),s=(a(3188),a(59297),a(4290),a(71633)),i=a.n(s),o=a(97023),m=a.n(o),l=a(14778),c=a(85873);function d(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class u extends m().PureComponent{render(){const{content:e,url:t,size:a,withHover:n,className:r}=this.props,s=n?"":"no-hover",{formatMessage:o}=this.props.intl,l=t||(0,c.lt)({display_name:e});let d;return d="string"==typeof e?l?m().createElement("div",{"data-testid":"teamIconImage",className:"TeamIcon__image TeamIcon__".concat(a),"aria-label":o({id:"sidebar.team_menu.button.teamImage",defaultMessage:"{teamName} Team Image"},{teamName:e}),style:{backgroundImage:"url('".concat(l,"')")},role:"img"}):m().createElement("div",{"data-testid":"teamIconInitial",className:"TeamIcon__initials TeamIcon__initials__".concat(a),"aria-label":o({id:"sidebar.team_menu.button.teamInitials",defaultMessage:"{teamName} Team Initials"},{teamName:e}),role:"img"},e?e.replace(/\s/g,"").substring(0,2):"??"):e,m().createElement("div",{className:i()("TeamIcon TeamIcon__".concat(a),{withImage:l},r,s)},m().createElement("div",{className:"TeamIcon__content ".concat(s)},d))}}d(u,"propTypes",{url:r().oneOfType([r().string,r().oneOf([null])]),content:r().node.isRequired,size:r().oneOf(["sm","lg"]),withHover:r().bool,className:r().string}),d(u,"defaultProps",{size:"sm"});const p=(0,l.injectIntl)(u)},49176:(e,t,a)=>{a.d(t,{Cu:()=>s,SM:()=>i,j4:()=>m});var n=a(8361),r=a(77440);function s(e){return e.views.lhs.isOpen}function i(e){return e.views.lhs.currentStaticPageId}const o=(0,a(67173).wV)(),m=(0,n.Mz)("getVisibleSidebarStaticPages",r.WW,o,((e,t)=>{const a=[];return e&&a.push({id:"threads",isVisible:!0}),a.push({id:"drafts",isVisible:t>0}),a.filter((e=>e.isVisible))}))}}]);
//# sourceMappingURL=5638.77ec373b731e4a223209.js.map