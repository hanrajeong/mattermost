"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[5073],{62114:(e,t,n)=>{n.d(t,{A:()=>m});var o=n(62688),a=n.n(o),i=(n(17046),n(97023)),s=n.n(i),r=n(14778),l=n(23453),c=n(14696),d=n(30596),u=n(40057),p=n(21650);const h=e=>{let{pulsatingDotPlacement:t="left",pulsatingDotTranslate:n}=e;const o=(0,l.useDispatch)(),a=(0,l.useSelector)(p.F9),h=s().createElement(r.FormattedMessage,{id:"newChannelWithBoard.tutorialTip.title",defaultMessage:"Access linked boards from the App Bar"}),m=s().createElement(r.FormattedMessage,{id:"newChannelWithBoard.tutorialTip.description",defaultMessage:"The board you just created can be quickly accessed by clicking on the Boards icon in the App bar. You can view the boards that are linked to this channel in the right-hand sidebar and open one in full view."}),[f,g]=(0,i.useState)(a),b=(0,i.useCallback)((e=>{e.stopPropagation(),g(!1),o((0,d.z)({[u.pm.NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED]:!0}))}),[]),_=(0,i.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),f?(o((0,d.z)({[u.pm.NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED]:!0})),g(!1)):g(!0)}),[]),E=(0,c.LX)(["app-bar-icon-focalboard"],[],{y:-2,height:4,x:0,width:0});return a?s().createElement(c.Yd,{show:!0,screen:m,title:h,overlayPunchOut:E,placement:"right-start",pulsatingDotPlacement:t,step:1,singleTip:!0,showOptOut:!1,interactivePunchOut:!0,handleDismiss:b,handleOpen:_,handlePrevious:b,offset:[-30,5],pulsatingDotTranslate:n}):null};h.propTypes={pulsatingDotTranslate:a().shape({x:a().number.isRequired,y:a().number.isRequired})};const m=h},96121:(e,t,n)=>{n.d(t,{A:()=>u});var o=n(62688),a=n.n(o),i=n(97023),s=n.n(i),r=n(62114),l=n(87131),c=n(78451);const d=e=>{const{ariaLabelOverride:t,buttonClass:n,buttonId:o,children:a,onClick:i,tooltip:d,tooltipShortcut:u,isRhsOpen:p,pluginId:h}=e,m=h===c.g_.focalboard,f=null!=t?t:d;return s().createElement(s().Fragment,null,s().createElement(l.A,{title:p?"":d,shortcut:u},s().createElement("button",{id:o,"aria-label":f,className:n||"channel-header__icon",onClick:i},a)),m&&s().createElement(r.A,{pulsatingDotPlacement:"start",pulsatingDotTranslate:{x:0,y:-22}}))};d.propTypes={ariaLabelOverride:a().string,buttonClass:a().string,buttonId:a().string.isRequired,children:a().node.isRequired,onClick:a().func.isRequired,tooltip:a().string.isRequired,isRhsOpen:a().bool,pluginId:a().string};const u=d},86222:(e,t,n)=>{n.r(t),n.d(t,{default:()=>De});var o=n(23453),a=n(81911),i=n(5908),s=n(30413),r=n(29370),l=n(40057),c=n(65952),d=n(26614),u=n(14776),p=n(7430),h=n(16230),m=n(2386),f=n(75270),g=n(64890),b=n(68124),_=(n(4290),n(71633)),E=n.n(_),v=n(97023),C=n.n(v),w=n(14778),y=n(67277),M=n(2866),N=n(77828),A=n(87131),x=(n(17046),n(35134)),T=n.n(x),S=n(34545),O=n.n(S),P=n(17983),H=n(99068),R=n(78451);const L=(0,o.connect)((function(e){return{currentChannel:(0,c.Lw)(e),pluginCallComponents:e.plugins.components.CallButton,channelMember:(0,c.tW)(e),sidebarOpen:e.views.rhs.isSidebarOpen}}))((function(e){let{pluginCallComponents:t,currentChannel:n,channelMember:o,sidebarOpen:a}=e;const[i,s]=(0,v.useState)(!1),[r,l]=(0,v.useState)(!0),c=(0,v.useRef)(a),{formatMessage:d}=(0,w.useIntl)();if((0,v.useEffect)((()=>{c.current&&!a&&(l(!1),setTimeout((()=>{l(!0)}),R.YM.CHANNEL_HEADER_BUTTON_DISABLE_TIMEOUT)),c.current=a}),[a]),0===t.length)return null;const u={container:{marginTop:16,height:32}};if(1===t.length){const e=t[0],a=()=>{var t;return null===(t=e.action)||void 0===t?void 0:t.call(e,n,o)};return C().createElement("div",{style:u.container,className:"flex-child",onClick:r?a:void 0,onTouchEnd:r?a:void 0},e.button)}const p=t.map((e=>C().createElement("li",{className:"MenuItem",key:e.id,onClick:t=>{var a;t.preventDefault(),null===(a=e.action)||void 0===a||a.call(e,n,o)}},e.dropdownButton)));return C().createElement("div",{style:u.container,className:"flex-child"},C().createElement(H.A,{onToggle:e=>s(e)},C().createElement("button",{className:E()("style--none call-button dropdown",{active:i})},C().createElement(O(),{color:"inherit","aria-label":d({id:"generic_icons.call",defaultMessage:"Call icon"}).toLowerCase()}),C().createElement("span",{className:"call-button-label"},"Call"),C().createElement(T(),{color:"inherit","aria-label":d({id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"}).toLowerCase()})),C().createElement(P.A,{id:"callOptions",ariaLabel:d({id:"call_button.menuAriaLabel",defaultMessage:"Call type selector"}),customStyles:{top:"auto",left:"auto",right:0}},p)))}));var k=n(43595),I=n(77440),B=n(77656),D=n(21650),U=n(62688),F=n.n(U),j=(n(43813),n(34529)),W=n(6098),q=n(17651),z=n(96121);function G(e){const{formatMessage:t}=(0,w.useIntl)();return C().createElement("span",e,C().createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 18 18",version:"1.1",role:"img","aria-label":t({id:"generic_icons.plugins",defaultMessage:"Plugins"})},C().createElement("path",{d:"M14.58 9.14399L17.136 6.60599C17.304 6.42599 17.388 6.20999 17.388 5.95799C17.388 5.70599 17.298 5.49599 17.118 5.32799C16.95 5.14799 16.74 5.05799 16.488 5.05799C16.236 5.05799 16.026 5.14799 15.858 5.32799L13.302 7.86599L10.134 4.69799L12.672 2.14199C12.852 1.97399 12.942 1.76399 12.942 1.51199C12.942 1.25999 12.852 1.04999 12.672 0.881987C12.504 0.701987 12.294 0.611987 12.042 0.611987C11.79 0.611987 11.574 0.695987 11.394 0.863987L8.856 3.41999L6.318 0.863987C6.138 0.695987 5.922 0.611987 5.67 0.611987C5.418 0.611987 5.208 0.695987 5.04 0.863987V0.881987C4.86 1.04999 4.77 1.25999 4.77 1.51199C4.77 1.76399 4.86 1.97399 5.04 2.14199L5.67 2.78999L2.808 5.65199C2.016 6.44399 1.458 7.36799 1.134 8.42399C0.81 9.45599 0.744 10.512 0.936 11.592C1.128 12.66 1.56 13.632 2.232 14.508L0.27 16.47C0.09 16.638 0 16.848 0 17.1C0 17.352 0.09 17.562 0.27 17.73C0.45 17.898 0.66 17.982 0.9 17.982C1.152 17.994 1.362 17.91 1.53 17.73L3.492 15.768C4.368 16.44 5.34 16.872 6.408 17.064C7.488 17.256 8.544 17.19 9.576 16.866C10.632 16.542 11.556 15.984 12.348 15.192L15.21 12.33L15.858 12.96C16.026 13.14 16.236 13.23 16.488 13.23C16.74 13.23 16.95 13.14 17.118 12.96H17.136C17.304 12.792 17.388 12.582 17.388 12.33C17.388 12.078 17.304 11.862 17.136 11.682L14.58 9.14399ZM11.088 13.914C10.452 14.55 9.702 14.976 8.838 15.192C8.01 15.408 7.176 15.408 6.336 15.192C5.472 14.976 4.722 14.55 4.086 13.914C3.45 13.278 3.024 12.528 2.808 11.664C2.592 10.824 2.592 9.98999 2.808 9.16199C3.024 8.29799 3.45 7.54799 4.086 6.91199L6.948 4.04999L13.95 11.052L11.088 13.914Z"})))}var Y=n(27840);function V(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Q extends C().PureComponent{constructor(){super(...arguments),V(this,"handleRootClose",(()=>{this.props.onClose()}))}render(){const{open:e,rootCloseEvent:t,children:n}=this.props;return C().createElement(W.YE,{disabled:!e,onRootClose:this.handleRootClose,event:t},C().createElement("ul",{role:"menu",className:"dropdown-menu channel-header_plugin-dropdown"},n))}}V(Q,"propTypes",{open:F().bool,children:F().node,onClose:F().func.isRequired,rootCloseEvent:F().oneOf(["click","mousedown"]),bsRole:F().string.isRequired});class X extends C().PureComponent{constructor(){super(...arguments),V(this,"handleClick",(e=>{this.props.onClick&&this.props.onClick(e)}))}render(){const{children:e}=this.props;let t="";return this.props.dropdownOpen&&(t=" channel-header__icon--active"),C().createElement("button",{id:"pluginChannelHeaderButtonDropdown",className:"channel-header__icon channel-header__icon--wide "+t,type:"button",onClick:this.handleClick},e)}}V(X,"propTypes",{children:F().node,dropdownOpen:F().bool,onClick:F().func,bsRole:F().string.isRequired});class K extends C().PureComponent{constructor(e){super(e),V(this,"disableButtonsClosingRHS",!1),V(this,"toggleDropdown",(e=>{this.setState({dropdownOpen:e})})),V(this,"onClose",(()=>{this.toggleDropdown(!1)})),V(this,"fireAction",(e=>{this.disableButtonsClosingRHS||e(this.props.channel,this.props.channelMember)})),V(this,"fireActionAndClose",(e=>{e(this.props.channel,this.props.channelMember),this.onClose()})),V(this,"createComponentButton",(e=>{var t,n;function o(e,t){return"string"==typeof t?t:t&&"object"==typeof t&&"type"in t&&t.type===w.FormattedMessage?e.formatMessage({id:t.props.id,defaultMessage:t.props.defaultMessage},t.props.value):""}let a;e.tooltipText?a=o(this.props.intl,e.tooltipText):e.dropdownText&&(a=o(this.props.intl,e.dropdownText));const i=null!==(t=null!==(n=e.tooltipText)&&void 0!==n?n:e.dropdownText)&&void 0!==t?t:"";return C().createElement(z.A,{key:"channelHeaderButton"+e.id,buttonClass:"channel-header__icon",onClick:()=>this.fireAction(e.action),buttonId:e.id+"ChannelHeaderButton",tooltip:i,ariaLabelOverride:a,pluginId:e.pluginId},e.icon)})),V(this,"onBindingClick",(async e=>{if(this.disableButtonsClosingRHS)return;const{channel:t,intl:n}=this.props,o=(0,Y.aC)(e.app_id,e.location,this.props.channel.id,this.props.channel.team_id),a=await this.props.actions.handleBindingClick(e,o,n);if(a.error){const e=a.error,o=e.text||n.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForChannel(e,o,t.id)}const i=a.data;switch(i.type){case q.G4.OK:i.text&&this.props.actions.postEphemeralCallResponseForChannel(i,i.text,t.id);break;case q.G4.NAVIGATE:break;case q.G4.FORM:i.form&&this.props.actions.openAppsModal(i.form,o);break;default:{const e=this.props.intl.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:i.type});this.props.actions.postEphemeralCallResponseForChannel(i,e,t.id)}}})),V(this,"createAppBindingButton",(e=>C().createElement(z.A,{key:"channelHeaderButton_".concat(e.app_id,"_").concat(e.location),buttonClass:"channel-header__icon style--none",onClick:()=>this.onBindingClick(e),buttonId:"".concat(e.app_id,"_").concat(e.location),tooltip:e.label},C().createElement("img",{src:e.icon,width:"24",height:"24"})))),V(this,"createDropdown",((e,t)=>{const n=e.filter((e=>e.action)).map((e=>C().createElement("li",{key:"channelHeaderPlug"+e.id},C().createElement("a",{href:"#",className:"d-flex align-items-center",onClick:()=>this.fireActionAndClose(e.action)},C().createElement("span",{className:"d-flex align-items-center overflow--ellipsis"},e.icon),C().createElement("span",null,e.dropdownText)))));let o=n;return this.props.appsEnabled&&(o=n.concat(t.map((e=>C().createElement("li",{key:"channelHeaderPlug"+e.app_id+e.location},C().createElement("a",{href:"#",className:"d-flex align-items-center",onClick:()=>this.fireActionAndClose((()=>this.onBindingClick(e)))},C().createElement("span",{className:"d-flex align-items-center overflow--ellipsis icon"},C().createElement("img",{src:e.icon})),C().createElement("span",null,e.label))))))),C().createElement("div",{className:"flex-child"},C().createElement(j.Dropdown,{id:"channelHeaderPlugDropdown",onToggle:this.toggleDropdown,open:this.state.dropdownOpen},C().createElement(X,{bsRole:"toggle",dropdownOpen:this.state.dropdownOpen},C().createElement(A.A,{title:C().createElement(w.FormattedMessage,{id:"generic_icons.plugins",defaultMessage:"Plugins"})},C().createElement(C().Fragment,null,C().createElement(G,{id:"pluginChannelHeaderIcon",className:"icon icon--standard icon__pluginChannelHeader","aria-hidden":"true"}),C().createElement("span",{id:"pluginCount",className:"icon__text"},o.length)))),C().createElement(Q,{bsRole:"menu",open:this.state.dropdownOpen,onClose:this.onClose},o)))})),this.state={dropdownOpen:!1}}componentDidUpdate(e){e.sidebarOpen&&!this.props.sidebarOpen&&(this.disableButtonsClosingRHS=!0,setTimeout((()=>{this.disableButtonsClosingRHS=!1}),R.YM.CHANNEL_HEADER_BUTTON_DISABLE_TIMEOUT))}render(){const e=this.props.components||[],t=this.props.appsEnabled&&this.props.appBindings||[];if(this.props.shouldShowAppBar||0===e.length&&0===t.length)return null;if(e.length+t.length<=15){let n=e.filter((e=>e.icon&&e.action)).map(this.createComponentButton);return this.props.appsEnabled&&(n=n.concat(t.map(this.createAppBindingButton))),n}return this.createDropdown(e,t)}}V(K,"propTypes",{components:F().array,appBindings:F().array,appsEnabled:F().bool.isRequired,sidebarOpen:F().bool.isRequired,shouldShowAppBar:F().bool.isRequired,actions:F().shape({}).isRequired}),V(K,"defaultProps",{components:[],appBindings:[]});const J=(0,w.injectIntl)(K),Z=(0,o.connect)((function(e){const t=(0,k.cO)(e);return{components:(0,D.IH)(e),appBindings:(0,k.eK)(e),appsEnabled:t,appBarEnabled:(0,k.SN)(e),theme:(0,I.O4)(e),sidebarOpen:e.views.rhs.isSidebarOpen,shouldShowAppBar:(0,D.hN)(e)}}),(function(e){return{actions:(0,i.bindActionCreators)({handleBindingClick:B.I$,postEphemeralCallResponseForChannel:B.hV,openAppsModal:B.el},e)}}))(J);var $=n(85873),ee=(n(76685),n(79751)),te=n(64182),ne=n(57486),oe=n(62975),ae=(n(29206),n(3188),n(6552),n(18955)),ie=n(38889),se=n(94621),re=n(18515);function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){de(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function de(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ue={singleline:!0},pe={singleline:!1},he={mentionHighlight:!1,atMentions:!0},me={hideUtilities:!0},fe={duration:{open:R.pl.FADE_IN_DURATION,close:R.pl.FADE_OUT_DURATION},initial:R.mj.START};function ge(e){const t=(0,o.useSelector)(u._p),n=(0,v.useRef)(null),a=(A=null==n?void 0:n.current,x=e.text,!!A&&(!!x.match(/\n{2,}/g)||(A.scrollWidth!==A.clientWidth||A.scrollHeight!==A.clientHeight)&&(A.scrollWidth>A.clientWidth||A.scrollHeight>A.clientHeight))),i=(0,v.useMemo)((()=>({inHeader:ce(ce(ce({},ue),he),{},{channelNamesMap:e.channelMentionsNameMap}),inPopover:ce(ce(ce({},pe),he),{},{channelNamesMap:e.channelMentionsNameMap})})),[e.channelMentionsNameMap]),[s,r]=(0,v.useState)(!1),{refs:{setReference:l,setFloating:c},floatingStyles:d,context:p}=(0,ae.we)({open:!!a&&s,onOpenChange:r,whileElementsMounted:ie.ll,middleware:[(0,se.cY)(-28)]}),{isMounted:h,styles:m}=(0,ae.DL)(p,fe),f=(0,ae.Mk)(p,{enabled:a,handleClose:(0,ae.iB)({requireIntent:!1,blockPointerEvents:!0})}),g=(0,ae.iQ)(p),b=(0,ae.s9)(p),_=(0,ae.kp)(p),E=(0,ae.It)(p,{role:"tooltip"}),{getReferenceProps:w,getFloatingProps:y}=(0,ae.bv)([f,g,_,b,E]),M=(0,ae.SV)([n,l]),N=function(e){return e?e.clientWidth+18:"inherit"}(null==n?void 0:n.current);var A,x;function T(e){(0,$.oO)(e,t)}return C().createElement(C().Fragment,null,C().createElement("div",Object.assign({ref:M,className:"header-description__text"},w(),{onClick:T}),C().createElement(re.A,{message:e.text,options:i.inHeader,imageProps:me})),h&&C().createElement(ae.XF,{id:R.Bj},C().createElement(ae.zR,{className:"channel-header-text-popover-floating-overlay",lockScroll:!0},C().createElement("div",Object.assign({ref:c,className:"channel-header-text-popover",style:ce(ce({maxWidth:N},d),m),onClick:T},y()),C().createElement(re.A,{message:e.text,options:i.inPopover,imageProps:me})))))}function be(e){var t,n,o,a,i,s;const r=0!==e.channel.delete_at,c=e.channel.type===R.YM.DM_CHANNEL,d=e.channel.type===R.YM.GM_CHANNEL,u=c&&null!==(t=null===(n=e.dmUser)||void 0===n?void 0:n.is_bot)&&void 0!==t&&t,p=e.channel.type===R.YM.PRIVATE_CHANNEL,h=u?null!==(o=null===(a=e.dmUser)||void 0===a?void 0:a.bot_description)&&void 0!==o?o:"":null!==(i=null===(s=e.channel)||void 0===s?void 0:s.header)&&void 0!==i?i:"";var m,f;return h.trim().length>0?C().createElement(ge,{text:h,channelMentionsNameMap:(0,oe.QE)(null===(m=e.channel)||void 0===m||null===(f=m.props)||void 0===f?void 0:f.channel_mentions)?e.channel.props.channel_mentions:void 0}):r||u?null:c||d?C().createElement(_e,{channel:e.channel}):C().createElement(ne.A,{channelId:e.channel.id,teamId:e.teamId,permissions:[p?l.xB.MANAGE_PRIVATE_CHANNEL_PROPERTIES:l.xB.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},C().createElement(_e,{channel:e.channel}))}function _e(e){let{channel:t}=e;const n=(0,o.useDispatch)();return C().createElement("button",{className:"header-placeholder style--none",onClick:function(){n((0,ee.q)({modalId:R.IQ.EDIT_CHANNEL_HEADER,dialogType:te.A,dialogProps:{channel:t}}))}},C().createElement(w.FormattedMessage,{id:"channel_header.headerText.addNewButton",defaultMessage:"Add a channel header"}),C().createElement("i",{className:"icon icon-pencil-outline edit-icon","aria-hidden":!0}))}var Ee=n(40693),ve=n(61767),Ce=n(59050),we=n(17862),ye=n(19542),Me=n(42945);const Ne=()=>{var e;const t=(0,w.useIntl)(),n=(0,o.useDispatch)(),a=(0,o.useSelector)(c.TJ),i=(0,o.useSelector)(c.Lw),r=(null!==(e=null==i?void 0:i.delete_at)&&void 0!==e?e:0)>0,l=(0,v.useRef)(null),d=(0,v.useCallback)((e=>{e.stopPropagation(),i&&(n(a?(0,s.XJ)(i.id):(0,s.yc)(i.id)),requestAnimationFrame((()=>{l.current&&document.dispatchEvent(new CustomEvent(R.pn.FOCUS,{detail:{target:l.current,keyboardOnly:!1}}))})))}),[a,i,n]);if(!i||r)return null;let u=t.formatMessage({id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"});a&&(u=t.formatMessage({id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"})),u=u.toLowerCase();const p=C().createElement(C().Fragment,null,!a&&C().createElement(w.FormattedMessage,{id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"}),a&&C().createElement(w.FormattedMessage,{id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"}));return C().createElement(A.A,{title:p},C().createElement("button",{id:"toggleFavorite",onClick:d,className:E()("channel-header__favorites btn btn-icon btn-xs",{active:a,inactive:!a}),"aria-label":u,ref:l},C().createElement("i",{className:E()("icon",{"icon-star":a,"icon-star-outline":!a})})))},Ae=(0,v.memo)(Ne);var xe=n(6281),Te=n(70285);const Se=e=>{let{dmUser:t,gmMembers:n}=e;const a=(0,o.useSelector)(c.Lw);if(!a)return null;const i=a.type===R.YM.DM_CHANNEL,s=a.type===R.YM.GM_CHANNEL;let r,l;0!==a.delete_at&&(r=C().createElement(we.A,{className:"icon icon__archive icon channel-header-archived-icon svg-text-color"})),a.shared&&(l=C().createElement(Ce.A,{className:"shared-channel-icon",withTooltip:!0}));let d=a.display_name;return i?d=C().createElement(Me.A,{dmUser:t}):s&&(d=C().createElement(xe.A,{gmMembers:n})),i&&null!=t&&t.is_bot?C().createElement("div",{id:"channelHeaderDropdownButton",className:"channel-header__bot"},C().createElement(Ae,null),C().createElement(ve.A,{src:Ee.mT.getProfilePictureUrl(t.id,t.last_picture_update),size:"sm"}),C().createElement("strong",{id:"channelHeaderTitle",className:"heading"},C().createElement("span",null,r,d)),C().createElement(ye.A,null)):C().createElement("div",{className:"channel-header__top"},C().createElement(Ae,null),i&&t&&C().createElement(ve.A,{src:Ee.mT.getProfilePictureUrl(t.id,t.last_picture_update),size:"sm",status:a.status}),C().createElement(Te.A,{dmUser:t,gmMembers:n,sharedIcon:l,archivedIcon:r}))};Se.propTypes={gmMembers:F().array};const Oe=(0,v.memo)(Se);var Pe=n(92387);const He=n.n(Pe)().i.withConfig({displayName:"Icon"})(["font-size:18px;line-height:18px;display:inline-flex;align-items:center;justify-content:center;"]),Re=e=>{let{channel:t}=e;const n=(0,o.useDispatch)(),a=(0,w.useIntl)(),i=(0,o.useSelector)(f.bM),s=(0,o.useSelector)(f.A),r=i===R._n.CHANNEL_INFO||i===R._n.CHANNEL_MEMBERS||i===R._n.CHANNEL_FILES||i===R._n.PIN,l=s&&r,c=(0,v.useCallback)((()=>{if(l){const e=r?(0,m.bP)():(0,m.Vl)(t.id);n(e)}else n((0,m.Vl)(t.id))}),[l,t.id,r,n]);let d;d=l?a.formatMessage({id:"channel_header.closeChannelInfo",defaultMessage:"Close info"}):a.formatMessage({id:"channel_header.openChannelInfo",defaultMessage:"View Info"});let u="channel-header__icon";return l&&(u+=" channel-header__icon--active-inverted"),C().createElement(z.A,{buttonClass:u,buttonId:"channel-info-btn",onClick:c,tooltip:d},C().createElement(He,{className:"icon-information-outline"}))};function Le(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ke extends C().PureComponent{constructor(e){super(e),Le(this,"unmute",(()=>{const{actions:e,channel:t,channelMember:n,currentUser:o}=this.props;if(!n||!o||!t)return;const a={mark_unread:R.DB.ALL};e.updateChannelNotifyProps(o.id,t.id,a)})),Le(this,"showPinnedPosts",(e=>{e.preventDefault(),this.props.rhsState===R._n.PIN?this.props.actions.closeRightHandSide():this.props.actions.showPinnedPosts()})),Le(this,"showChannelFiles",(()=>{this.props.rhsState===R._n.CHANNEL_FILES?this.props.actions.closeRightHandSide():this.props.channel&&this.props.actions.showChannelFiles(this.props.channel.id)})),Le(this,"toggleChannelMembersRHS",(()=>{this.props.rhsState===R._n.CHANNEL_MEMBERS?this.props.actions.closeRightHandSide():this.props.channel&&this.props.actions.showChannelMembers(this.props.channel.id)})),Le(this,"renderCustomStatus",(()=>{var e;const{customStatus:t,isCustomStatusEnabled:n,isCustomStatusExpired:o}=this.props,a=!o&&((null==t?void 0:t.text)||(null==t?void 0:t.emoji));return n&&a?C().createElement("div",{className:"custom-emoji__wrapper"},C().createElement(y.A,{userID:null===(e=this.props.dmUser)||void 0===e?void 0:e.id,showTooltip:!0,emojiStyle:{verticalAlign:"top",margin:"0 4px 1px"}}),C().createElement(M.A,{text:null==t?void 0:t.text,className:"custom-emoji__text"})):null})),this.toggleFavoriteRef=C().createRef()}componentDidMount(){this.props.actions.getCustomEmojisInText(this.props.channel?this.props.channel.header:"")}componentDidUpdate(e){const t=this.props.channel?this.props.channel.header:"";t!==(e.channel?e.channel.header:"")&&this.props.actions.getCustomEmojisInText(t)}render(){const{teamId:e,currentUser:t,gmMembers:n,channel:o,channelMember:a,isChannelMuted:i,dmUser:s,rhsState:r,hasGuests:l,hideGuestTags:c}=this.props;if(!o)return null;const d=this.props.intl.formatMessage({id:"accessibility.sections.channelHeader",defaultMessage:"channel header region"});let u="";if(l&&!c&&(u=C().createElement("span",{className:"has-guest-header"},C().createElement("span",{tabIndex:0},C().createElement(w.FormattedMessage,{id:"channel_header.channelHasGuests",defaultMessage:"Channel has guests"})))),(0,$.RI)(o)||(0,$.RI)(a)||(0,$.RI)(t)||!s&&o.type===R.YM.DM_CHANNEL)return C().createElement("div",{className:"channel-header"});const p=o.type===R.YM.DM_CHANNEL;let h;o.type===R.YM.GM_CHANNEL&&l&&!c&&(u=C().createElement("span",{className:"has-guest-header"},C().createElement(w.FormattedMessage,{id:"channel_header.groupMessageHasGuests",defaultMessage:"This group message has guests"}))),!p||null!=s&&s.delete_at||null!=s&&s.is_bot||(h=C().createElement("span",{className:"header-status__text"},this.renderCustomStatus()),this.props.isLastActiveEnabled&&this.props.lastActivityTimestamp&&this.props.timestampUnits&&(h=C().createElement("span",{className:"header-status__text"},C().createElement("span",{className:"last-active__text"},C().createElement(w.FormattedMessage,{id:"channel_header.lastActive",defaultMessage:"Active {timestamp}",values:{timestamp:C().createElement(N.Ay,{value:this.props.lastActivityTimestamp,units:this.props.timestampUnits,useTime:!1,style:"short"})}})),this.renderCustomStatus())));const m=E()("channel-header__icon channel-header__icon--left btn btn-icon btn-xs ",{"channel-header__icon--active":r===R._n.CHANNEL_FILES}),f=C().createElement("i",{className:"icon icon-file-text-outline"}),g=E()("channel-header__icon channel-header__icon--wide channel-header__icon--left btn btn-icon btn-xs",{"channel-header__icon--active":r===R._n.PIN}),b=this.props.pinnedPostsCount?C().createElement(C().Fragment,null,C().createElement("i",{"aria-hidden":"true",className:"icon icon-pin-outline channel-header__pin"}),C().createElement("span",{id:"channelPinnedPostCountText",className:"icon__text"},this.props.pinnedPostsCount)):C().createElement("i",{"aria-hidden":"true",className:"icon icon-pin-outline channel-header__pin"}),_=this.props.pinnedPostsCount?C().createElement(z.A,{buttonClass:g,buttonId:"channelHeaderPinButton",onClick:this.showPinnedPosts,tooltip:this.props.intl.formatMessage({id:"channel_header.pinnedPosts",defaultMessage:"Pinned messages"})},b):null;let v,y=null;if(!p){const e=E()("member-rhs__trigger channel-header__icon channel-header__icon--wide channel-header__icon--left btn btn-icon btn-xs",{"channel-header__icon--active":r===R._n.CHANNEL_MEMBERS}),t=this.props.memberCount?C().createElement(C().Fragment,null,C().createElement("i",{"aria-hidden":"true",className:"icon icon-account-outline channel-header__members"}),C().createElement("span",{id:"channelMemberCountText",className:"icon__text"},this.props.memberCount)):C().createElement(C().Fragment,null,C().createElement("i",{"aria-hidden":"true",className:"icon icon-account-outline channel-header__members"}),C().createElement("span",{id:"channelMemberCountText",className:"icon__text"},"-"));y=C().createElement(z.A,{tooltip:this.props.intl.formatMessage({id:"channel_header.channelMembers",defaultMessage:"Members"}),buttonClass:e,buttonId:"member_rhs",onClick:this.toggleChannelMembersRHS},t)}return i&&(v=C().createElement(A.A,{title:C().createElement(w.FormattedMessage,{id:"channelHeader.unmute",defaultMessage:"Unmute"})},C().createElement("button",{id:"toggleMute",onClick:this.unmute,className:"channel-header__mute inactive btn btn-icon btn-xs","aria-label":this.props.intl.formatMessage({id:"channelHeader.unmute",defaultMessage:"Unmute"})},C().createElement("i",{className:"icon icon-bell-off-outline","aria-hidden":!0})))),C().createElement("div",{id:"channel-header","aria-label":d,role:"banner",tabIndex:-1,"data-channelid":"".concat(o.id),className:"channel-header alt a11y__region","data-a11y-sort-order":"8"},C().createElement("div",{className:"flex-parent"},C().createElement("div",{className:"flex-child"},C().createElement("div",{id:"channelHeaderInfo",className:"channel-header__info"},C().createElement("div",{className:"channel-header__title dropdown"},C().createElement(Oe,{dmUser:s,gmMembers:n}),C().createElement("div",{className:"channel-header__icons"},v,y,_,this.props.isFileAttachmentsEnabled&&C().createElement(z.A,{buttonClass:m,buttonId:"channelHeaderFilesButton",onClick:this.showChannelFiles,tooltip:this.props.intl.formatMessage({id:"channel_header.channelFiles",defaultMessage:"Channel files"})},f)),C().createElement("div",{id:"channelHeaderDescription",className:"channel-header__description"},h,u,C().createElement(be,{teamId:e,channel:o,dmUser:s}))))),C().createElement(Z,{channel:o,channelMember:a}),C().createElement(L,null),C().createElement(Re,{channel:o})))}}const Ie=(0,w.injectIntl)(ke),Be=(0,o.connect)((function(){const e=(0,p.dH)(),t=(0,g.Oc)();let n=[];return function(o){const a=(0,c.Lw)(o),i=(0,p.HW)(o),s=(0,d.zj)(o);let r,m,_,E;if(a&&a.type===l.Bz.DM_CHANNEL){const e=(0,h.r4)(i.id,a.name);r=(0,p.wz)(o,e),_=r&&t(o,r.id),E=r&&(0,p.v4)(o,r.id)}else a&&a.type===l.Bz.GM_CHANNEL&&(m=e(o,a.id));const v=(0,c.Wh)(o);let C=!1;return r&&(C=(0,p.FF)(o,r.id),n=(0,p.tP)(o,r.id)),{teamId:(0,u.Sy)(o),channel:a,channelMember:(0,c.tW)(o),memberCount:(null==v?void 0:v.member_count)||0,currentUser:i,dmUser:r,gmMembers:m,rhsState:(0,f.bM)(o),isChannelMuted:(0,c.cP)(o),hasGuests:!!v&&v.guest_count>0,pinnedPostsCount:(null==v?void 0:v.pinnedpost_count)||0,customStatus:_,isCustomStatusEnabled:(0,g.xI)(o),isCustomStatusExpired:(0,g.TX)(o,_),lastActivityTimestamp:E,isFileAttachmentsEnabled:(0,b._G)(s),isLastActiveEnabled:C,timestampUnits:n,hideGuestTags:"true"===s.HideGuestTags}}}),(e=>({actions:(0,i.bindActionCreators)({showPinnedPosts:m.H3,showChannelFiles:m.QK,closeRightHandSide:m.bP,getCustomEmojisInText:r.rg,updateChannelNotifyProps:s.cz,showChannelMembers:m.sQ},e)}))),De=(0,a.withRouter)(Be(Ie))},86664:(e,t,n)=>{var o=n(96784);t.__esModule=!0,t.default=function(e){var t=(0,a.default)(e);return t&&t.defaultView||t.parentWindow};var a=o(n(46329));e.exports=t.default},48933:(e,t,n)=>{var o=n(96784);t.__esModule=!0,t.default=function(e,t){var n=(0,i.default)(e);return n?n.innerHeight:t?e.clientHeight:(0,a.default)(e).height};var a=o(n(3037)),i=o(n(20014));e.exports=t.default},23110:(e,t,n)=>{var o=n(96784);t.__esModule=!0,t.default=void 0;var a,i=o(n(51493)),s="clearTimeout",r=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-c)),o=setTimeout(e,n);return c=t,o},l=function(e,t){return e+(e?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};i.default&&["","webkit","moz","o","ms"].some((function(e){var t=l(e,"request");if(t in window)return s=l(e,"cancel"),r=function(e){return window[t](e)}}));var c=(new Date).getTime();(a=function(e){return r(e)}).cancel=function(e){window[s]&&"function"==typeof window[s]&&window[s](e)};var d=a;t.default=d,e.exports=t.default},19800:(e,t,n)=>{t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=b(n(71633)),i=b(n(48933)),s=b(n(3037)),r=b(n(69533)),l=b(n(54356)),c=b(n(23110)),d=b(n(62688)),u=b(n(97023)),p=b(n(51565)),h=b(n(6607)),m=b(n(20086)),f=b(n(15570)),g=b(n(851));function b(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n,o));return a.onWindowScroll=function(){a.onUpdate()},a.onDocumentClick=function(){(0,c.default)((function(){return a.onUpdate()}))},a.onUpdate=function(){if(a._isMounted){var e=a.props,t=e.offsetTop,n=e.viewportOffsetTop,o=(0,l.default)((0,g.default)(a))+(n||0);o<=t?a.updateState("top",null,null):o>a.getPositionTopMax()?"bottom"===a.state.affixed?a.updateStateAtBottom():a.setState({affixed:"bottom",position:"absolute",top:null},(function(){a._isMounted&&a.updateStateAtBottom()})):a.updateState("affix","fixed",n)}},a.getPositionTopMax=function(){return(0,m.default)((0,f.default)(a))-(0,i.default)(p.default.findDOMNode(a))-a.props.offsetBottom},a.updateState=function(e,t,n){if(e!==a.state.affixed||t!==a.state.position||n!==a.state.top){var o="affix"===e?"":e.charAt(0).toUpperCase()+e.substr(1);a.props["onAffix"+o]&&a.props["onAffix"+o](),a.setState({affixed:e,position:t,top:n},(function(){a.props["onAffixed"+o]&&a.props["onAffixed"+o]()}))}},a.updateStateAtBottom=function(){var e=a.getPositionTopMax(),t=(0,r.default)(p.default.findDOMNode(a)),n=(0,s.default)(t).top;a.updateState("bottom","absolute",e-n)},a.state={affixed:"top",position:null,top:null},a._needPositionUpdate=!1,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){var e=this;this._isMounted=!0,this._windowScrollListener=(0,h.default)((0,g.default)(this),"scroll",(function(){return e.onWindowScroll()})),this._documentClickListener=(0,h.default)((0,f.default)(this),"click",(function(){return e.onDocumentClick()})),this.onUpdate()},t.prototype.UNSAFE_componentWillReceiveProps=function(){this._needPositionUpdate=!0},t.prototype.componentDidUpdate=function(){this._needPositionUpdate&&(this._needPositionUpdate=!1,this.onUpdate())},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this._windowScrollListener&&this._windowScrollListener.remove(),this._documentClickListener&&this._documentClickListener.remove()},t.prototype.render=function(){var e=u.default.Children.only(this.props.children),t=e.props,n=t.className,i=t.style,s=this.state,r=s.affixed,l={position:s.position,top:s.top},c=void 0,d=void 0;return"top"===r?(c=this.props.topClassName,d=this.props.topStyle):"bottom"===r?(c=this.props.bottomClassName,d=this.props.bottomStyle):(c=this.props.affixClassName,d=this.props.affixStyle),u.default.cloneElement(e,{className:(0,a.default)(c,n),style:o({},l,d,i)})},t}(u.default.Component);_.propTypes={offsetTop:d.default.number,viewportOffsetTop:d.default.number,offsetBottom:d.default.number,topClassName:d.default.string,topStyle:d.default.object,affixClassName:d.default.string,affixStyle:d.default.object,bottomClassName:d.default.string,bottomStyle:d.default.object,onAffix:d.default.func,onAffixed:d.default.func,onAffixTop:d.default.func,onAffixedTop:d.default.func,onAffixBottom:d.default.func,onAffixedBottom:d.default.func},_.defaultProps={offsetTop:0,viewportOffsetTop:null,offsetBottom:0},t.default=_,e.exports=t.default},89541:(e,t,n)=>{t.__esModule=!0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=f(n(3037)),i=f(n(23110)),s=f(n(62688)),r=f(n(66285)),l=f(n(97023)),c=f(n(19800)),d=f(n(6607)),u=f(n(24065)),p=f(n(20086)),h=f(n(15570)),m=f(n(851));function f(e){return e&&e.__esModule?e:{default:e}}var g=o({},c.default.propTypes,{container:s.default.oneOfType([r.default,s.default.func]),autoWidth:s.default.bool}),b=function(e){function t(n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,n,o));return s.onWindowScroll=function(){s.onUpdate()},s.onWindowResize=function(){s.props.autoWidth&&(0,i.default)((function(){return s.onUpdate()}))},s.onDocumentClick=function(){(0,i.default)((function(){return s.onUpdate()}))},s.onUpdate=function(){if(s._isMounted){var e=(0,a.default)(s.positioner),t=e.top,n=e.width,o=(0,u.default)(s.props.container),i=void 0;if(o){var r=(0,p.default)((0,h.default)(s)),l=(0,a.default)(o);i=r-l.top-l.height}else i=null;s.updateState(t,i,n)}},s.updateState=function(e,t,n){e===s.state.offsetTop&&t===s.state.offsetBottom&&n===s.state.width||s.setState({offsetTop:e,offsetBottom:t,width:n})},s.state={offsetTop:null,offsetBottom:null,width:null},s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){var e=this;this._isMounted=!0,this._windowScrollListener=(0,d.default)((0,m.default)(this),"scroll",(function(){return e.onWindowScroll()})),this._windowResizeListener=(0,d.default)((0,m.default)(this),"resize",(function(){return e.onWindowResize()})),this._documentClickListener=(0,d.default)((0,h.default)(this),"click",(function(){return e.onDocumentClick()})),this.onUpdate()},t.prototype.UNSAFE_componentWillReceiveProps=function(){this._needPositionUpdate=!0},t.prototype.componentDidUpdate=function(){this._needPositionUpdate&&(this._needPositionUpdate=!1,this.onUpdate())},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this._windowScrollListener&&this._windowScrollListener.remove(),this._documentClickListener&&this._documentClickListener.remove(),this._windowResizeListener&&this._windowResizeListener.remove()},t.prototype.render=function(){var e=this,t=this.props,n=t.autoWidth,a=t.viewportOffsetTop,i=t.children,s=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["autoWidth","viewportOffsetTop","children"]),r=this.state,d=r.offsetTop,u=r.offsetBottom,p=r.width;delete s.container;var h=Math.max(d,a||0),m=this.props,f=m.affixStyle,g=m.bottomStyle;return n&&(f=o({width:p},f),g=o({width:p},g)),l.default.createElement("div",null,l.default.createElement("div",{ref:function(t){e.positioner=t}}),l.default.createElement(c.default,o({},s,{offsetTop:h,viewportOffsetTop:a,offsetBottom:u,affixStyle:f,bottomStyle:g}),i))},t}(l.default.Component);b.displayName="AutoAffix",b.propTypes=g,b.defaultProps={viewportOffsetTop:0,autoWidth:!0},t.default=b,e.exports=t.default},6098:(e,t,n)=>{t.YE=void 0;var o=d(n(19800)),a=d(n(89541)),i=d(n(61011)),s=d(n(87314)),r=d(n(88242)),l=d(n(5103)),c=d(n(15003));function d(e){return e&&e.__esModule?e:{default:e}}o.default,a.default,i.default,s.default,r.default,l.default,t.YE=c.default},20086:(e,t)=>{t.__esModule=!0,t.default=function(e){return Math.max(e.documentElement.offsetHeight||0,e.height||0,e.body.scrollHeight||0,e.body.offsetHeight||0)},e.exports=t.default},851:(e,t,n)=>{t.__esModule=!0,t.default=function(e){return(0,a.default)(o.default.findDOMNode(e))};var o=i(n(51565)),a=i(n(86664));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}}]);
//# sourceMappingURL=5073.14ae435c1fa31336e4f4.js.map