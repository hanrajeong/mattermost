(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[2586],{92014:(e,t,n)=>{"use strict";n.d(t,{u:()=>h});var a=n(27405),s=n(94300),i=n(81515),r=n(97023),l=n(64174),o=n(30904),u=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],p=function(){var e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,n=String(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase(),a=String(t.getOptionValue(e)).toLowerCase(),s=String(t.getOptionLabel(e)).toLowerCase();return a===n||s===n},c={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,n,a){return!(!e||t.some((function(t){return p(e,t,a)}))||n.some((function(t){return p(e,t,a)})))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}};function h(e){var t=e.allowCreateWhileLoading,n=void 0!==t&&t,p=e.createOptionPosition,h=void 0===p?"last":p,m=e.formatCreateLabel,d=void 0===m?c.formatCreateLabel:m,v=e.isValidNewOption,g=void 0===v?c.isValidNewOption:v,f=e.getNewOptionData,b=void 0===f?c.getNewOptionData:f,V=e.onCreateOption,E=e.options,C=void 0===E?[]:E,O=e.onChange,y=(0,i.A)(e,u),w=y.getOptionValue,M=void 0===w?o.g:w,I=y.getOptionLabel,x=void 0===I?o.b:I,L=y.inputValue,P=y.isLoading,A=y.isMulti,_=y.value,N=y.name,D=(0,r.useMemo)((function(){return g(L,(0,l.H)(_),C,{getOptionValue:M,getOptionLabel:x})?b(L,d(L)):void 0}),[d,b,x,M,L,g,C,_]),j=(0,r.useMemo)((function(){return!n&&P||!D?C:"first"===h?[D].concat((0,s.A)(C)):[].concat((0,s.A)(C),[D])}),[n,h,P,D,C]),k=(0,r.useCallback)((function(e,t){if("select-option"!==t.action)return O(e,t);var n=Array.isArray(e)?e:[e];if(n[n.length-1]!==D)O(e,t);else if(V)V(L);else{var a=b(L,L),i={action:"create-option",name:N,option:a};O((0,l.D)(A,[].concat((0,s.A)((0,l.H)(_)),[a]),a),i)}}),[b,L,A,N,D,V,O,_]);return(0,a.A)((0,a.A)({},y),{},{options:j,onChange:k})}},61293:(e,t,n)=>{"use strict";n.d(t,{A:()=>r,D:()=>l}),n(17046);var a=n(97023),s=n(14778);const i=4e3;function r(e){let{text:t,successCopyTimeout:n,trackCallback:s}=e;const[r,l]=(0,a.useState)(!1),[o,u]=(0,a.useState)(!1),p=(0,a.useRef)(null);let c=i;return(n||0===n)&&(c=n),{copiedRecently:r,copyError:o,onClick:(0,a.useCallback)((()=>{null==s||s(),p.current&&(clearTimeout(p.current),p.current=null);const e=navigator.clipboard;if(e)e.writeText(t).then((()=>{l(!0),u(!1)})).catch((()=>{l(!1),u(!0)}));else{const e=document.createElement("textarea");e.innerText=t,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();try{const e=document.execCommand("copy");l(e),u(!e)}catch(e){l(!1),u(!0)}e.remove()}p.current=setTimeout((()=>{l(!1),u(!1)}),c)}),[c,t,s])}}const l=(0,s.defineMessages)({copy:{id:"copy_text.copy",defaultMessage:"Copy"},copied:{id:"copy_text.copied",defaultMessage:"Copied"}})},98689:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(97023),s=n.n(a),i=n(14778);function r(e){const{formatMessage:t}=(0,i.useIntl)();return s().createElement("span",e,s().createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.mail",defaultMessage:"Mail Icon"})},s().createElement("path",{d:"M4,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4M12,11L20,6H4L12,11M4,18H20V8.37L12,13.36L4,8.37V18Z"})))}},28790:(e,t,n)=>{"use strict";n.d(t,{A:()=>N}),n(29206),n(43813),n(17046),n(3188),n(6552),n(32773),n(76409),n(27105),n(4290);var a=n(71633),s=n.n(a),i=n(97023),r=n.n(i),l=n(14778),o=n(64174),u=n(68102),p=n(30904),c=n(60405),h=n(52836),m=n(92014),d=(n(51565),n(26489),(0,i.forwardRef)((function(e,t){var n=(0,c.u)(e),a=(0,h.u)(n),s=(0,m.u)(a);return i.createElement(p.S,(0,u.A)({ref:t},s))}))),v=n(40693),g=n(78546),f=n(79342),b=n(71127),V=n(94231),E=n(98689);function C(e){const{formatMessage:t}=(0,l.useIntl)();return r().createElement("span",e,r().createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.add-mail",defaultMessage:"Add Mail Icon"})},r().createElement("path",{d:"M3,4C1.89,4 1,4.89 1,6V18A2,2 0 0,0 3,20H14V18H3V8.37L11,13.36L19,8.37V13H21V6A2,2 0 0,0 19,4H3M3,6H19L11,11L3,6M19,15V18H16V20H19V23H21V20H24V18H21V15H19Z"})))}var O=n(53654),y=n(19542),w=n(72429),M=n(41468),I=n(85873);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const A=/[\s,;]+/,_=(0,l.defineMessages)({loadingDefault:{id:"widgets.users_emails_input.loading",defaultMessage:"Loading"},noMatchDefault:{id:"widgets.users_emails_input.no_user_found_matching",defaultMessage:"No one found matching **{text}**. Enter their email to invite them."},validAddressDefault:{id:"widgets.users_emails_input.valid_email",defaultMessage:"Add **{email}**"}});class N extends r().PureComponent{constructor(e){super(e),P(this,"renderUserName",(e=>{const t=(0,I.Cg)(e);let n=null;t.fullName&&(n=r().createElement("span",{className:"fullname"},t.fullName));let a=null;return t.nickname&&(a=r().createElement("span",{className:"nickname"},t.nickname)),r().createElement(r().Fragment,null,t.displayName,n,a)})),P(this,"loadingMessage",(()=>{const e=r().createElement(l.FormattedMessage,this.props.loadingMessage);return r().createElement(O.A,{text:e})})),P(this,"getOptionValue",(e=>this.isUserProfile(e)?e.id:e.value)),P(this,"formatOptionLabel",((e,t)=>{const n=(0,I.RG)(e.id,e.last_picture_update);let a=null,s=null;return e.is_bot&&(s=r().createElement(y.A,null)),!(0,g.xf)(e.value)&&(0,f.P)(e.roles)&&(a=r().createElement(w.A,null)),"menu"===t.context?e.value&&(0,g.xf)(e.value)?this.getCreateLabel(e.value):r().createElement(r().Fragment,null,r().createElement(M.A,{size:"lg",username:e.username,url:n}),this.renderUserName(e),s,a):e.value&&(0,g.xf)(e.value)?r().createElement(r().Fragment,null,r().createElement(E.A,{className:"mail-icon"}),r().createElement("span",null,e.value)):r().createElement(r().Fragment,null,r().createElement(M.A,{size:"sm",username:e.username,url:n}),(0,I.Mn)(e),s,a)})),P(this,"onChange",(e=>{this.props.onChange&&(e?this.props.onChange(e.map((e=>this.isUserProfile(e)?e:e.value))):this.props.onChange([]))})),P(this,"getCreateLabel",(e=>r().createElement(r().Fragment,null,r().createElement(C,{className:"mail-plus-icon"}),r().createElement(b.A,Object.assign({key:"widgets.users_emails_input.valid_email"},this.props.validAddressMessage,{values:{email:e},disableLinks:!0}))))),P(this,"Input",(e=>r().createElement(o.c.Input,Object.assign({},e,{onPaste:e=>{var t;e.preventDefault();const n=(null===(t=e.clipboardData)||void 0===t?void 0:t.getData("Text"))||"";this.appendDelimitedValues(n),this.props.onPaste&&this.props.onPaste(e)}})))),P(this,"NoOptionsMessage",(e=>{const t=e.selectProps.inputValue;if(!t)return null;const n=o.c.NoOptionsMessage;return r().createElement("div",{className:"users-emails-input__option users-emails-input__option--no-matches"},r().createElement(n,e,r().createElement(b.A,Object.assign({},this.props.noMatchMessage,{values:{text:t},disableLinks:!0}))))})),P(this,"MultiValueRemove",(e=>{const{children:t,innerProps:n}=e;return r().createElement("div",Object.assign({},n,{role:"button",tabIndex:0,onKeyDown:e=>{var t;"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),null===(t=n.onClick)||void 0===t||t.call(n,e))}}),t||r().createElement(V.A,null))})),P(this,"components",{NoOptionsMessage:this.props.suppressNoOptionsMessage?()=>null:this.NoOptionsMessage,MultiValueRemove:this.MultiValueRemove,IndicatorsContainer:()=>null,Input:this.Input}),P(this,"handleInputChange",(async(e,t)=>{var n;if("input-blur"===t.action&&""!==t.prevInputValue){const e=this.formatValuesForCreatable(),n=this.state.options.find((e=>t.prevInputValue===e.username||t.prevInputValue==="@"+e.username||t.prevInputValue===e.email));if(n)return this.onChange([...e,n]),this.props.onInputChange(""),void this.setState((e=>L(L({},e),{},{prevValue:t.prevInputValue})));if(this.props.emailInvitationsEnabled&&(0,g.xf)(t.prevInputValue)){const n=t.prevInputValue;this.onChange([...e,{value:n,label:n}]),this.props.onInputChange(""),this.setState((e=>L(L({},e),{},{prevValue:t.prevInputValue})))}}else if("input-change"===t.action&&""!==t.prevInputValue&&null!==(n=t.prevInputValue)&&void 0!==n&&n[t.prevInputValue.length-1].match(A)&&0===await this.appendDelimitedValues(t.prevInputValue))return;"input-blur"!==t.action&&"menu-close"!==t.action&&(this.props.onInputChange(e),this.setState((e=>L(L({},e),{},{prevValue:t.prevInputValue}))))})),P(this,"formatValuesForCreatable",(()=>this.props.value.map((e=>e.id?e:{label:e,value:e})))),P(this,"optionsLoader",((e,t)=>{const n=e=>{this.setState({options:e});const n=e.map((e=>L(L({},e),{},{label:e.username})));t(n),this.props.onUsersLoad&&this.props.onUsersLoad(e)},a=this.props.usersLoader(this.props.inputValue,n);a&&a.then&&a.then(n)})),P(this,"showAddEmail",((e,t,n)=>this.props.emailInvitationsEnabled&&0===n.length&&(0,g.xf)(e))),P(this,"onFocus",(()=>{var e;null===(e=this.selectRef.current)||void 0===e||e.onInputChange(this.props.inputValue,{action:"set-value",prevInputValue:this.props.inputValue})})),P(this,"onBlur",(()=>{var e;null===(e=this.selectRef.current)||void 0===e||e.onInputChange(this.props.inputValue,{action:"input-blur",prevInputValue:this.state.prevValue}),this.props.onBlur&&this.props.onBlur()})),P(this,"appendDelimitedValues",(async e=>{const t=this.formatValuesForCreatable(),n=[...new Set(e.split(A))];if(0===n.length)return 0;const a=(e,t)=>-1===e.findIndex((e=>this.isEmailInvite(e)&&e.value===t||this.isUserProfile(e)&&e.email===t)),s=async e=>a(t,e)?await this.searchByEmail(e)||e:null,i=(e,t)=>-1===e.findIndex((e=>this.isUserProfile(e)&&e.username===t)),r=async e=>i(t,e)?this.searchByUsername(e):null,l=n.map((async e=>{if(""===e)return Promise.resolve(null);let t;return t=this.props.emailInvitationsEnabled&&(0,g.xf)(e)?await s(e):await r(e),"string"==typeof t?Promise.resolve({value:t,label:t}):this.isUserProfile(t)?Promise.resolve(t):Promise.resolve(null)})),o=[];return(await Promise.allSettled(l)).reduce(((e,t)=>("fulfilled"===t.status&&e.push(t.value),e)),[]).forEach((e=>{e&&(!this.isEmailInvite(e)||a(t,e.value)&&a(o,e.value))&&(!this.isUserProfile(e)||i(t,e.username)&&a(t,e.email)&&i(o,e.username)&&a(o,e.email))&&o.push(e)})),this.onChange([...t,...o]),this.props.onInputChange(""),o.length})),P(this,"isUserProfile",(e=>void 0!==e.id)),P(this,"isEmailInvite",(e=>void 0!==e.value)),P(this,"searchByEmail",(async e=>{var t;let n;try{n=await v.mT.getUserByEmail(e)}catch(e){return null}return 0===(null===(t=n)||void 0===t?void 0:t.delete_at)?n:null})),P(this,"searchByUsername",(async e=>{var t;let n;try{n=await v.mT.getUserByUsername(e)}catch(e){return null}return 0===(null===(t=n)||void 0===t?void 0:t.delete_at)?n:null})),this.selectRef=r().createRef(),this.state={options:[],prevValue:this.props.inputValue}}render(){const e=this.formatValuesForCreatable(),t=o.c.NoOptionsMessage,n={placeholder:e=>L(L({},e),{},{pointerEvents:"none",userSelect:"none"}),input:e=>L(L({},e),{},{display:"flex",flex:"1 1 auto","> div":{width:"100%"},input:{width:"100% !important",textAlign:"left"}})};return r().createElement(r().Fragment,null,r().createElement(d,{ref:this.selectRef,onChange:this.onChange,loadOptions:this.optionsLoader,isValidNewOption:this.showAddEmail,isMulti:!0,isClearable:!1,className:s()("UsersEmailsInput",this.props.showError?"error":"",{empty:""===this.props.inputValue},{"no-selections":0===e.length}),classNamePrefix:"users-emails-input",placeholder:this.props.placeholder,components:this.components,getOptionValue:this.getOptionValue,formatOptionLabel:this.formatOptionLabel,defaultOptions:!1,defaultMenuIsOpen:!1,openMenuOnClick:!1,loadingMessage:this.loadingMessage,onInputChange:this.handleInputChange,inputValue:this.props.inputValue,openMenuOnFocus:!0,onFocus:()=>this.onFocus,onBlur:()=>this.onBlur,tabSelectsValue:!0,value:e,"aria-label":this.props.ariaLabel,autoFocus:this.props.autoFocus,styles:n}),this.props.showError&&r().createElement("div",{className:"InputErrorBox"},r().createElement(t,null,r().createElement(b.A,Object.assign({},this.props.errorMessage,{values:this.props.errorMessageValues,disableLinks:!0}))),this.props.extraErrorText||null))}}P(N,"defaultProps",{noMatchMessage:_.noMatchDefault,validAddress:_.validAddressDefault,loadingMessage:_.loadingDefault,showError:!1})},71236:(e,t,n)=>{"use strict";var a=n(65689),s=n(25244),i=n(27853),r=n(48920),l=n(1542),o=n(6357);a({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=r.f(t),a=n.resolve,u=n.reject,p=l((function(){var n=i(t.resolve),r=[],l=0,u=1;o(e,(function(e){var i=l++,o=!1;u++,s(n,t,e).then((function(e){o||(o=!0,r[i]={status:"fulfilled",value:e},--u||a(r))}),(function(e){o||(o=!0,r[i]={status:"rejected",reason:e},--u||a(r))}))})),--u||a(r)}));return p.error&&u(p.value),n.promise}})},27105:(e,t,n)=>{n(71236)}}]);
//# sourceMappingURL=2586.71faaef4069b766893c9.js.map