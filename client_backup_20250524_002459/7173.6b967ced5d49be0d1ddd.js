"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[7173],{77173:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ht}),a(17046),a(43813);var l=a(71633),r=a.n(l),n=a(95685),s=a.n(n),i=a(97023),d=a.n(i),o=a(14778),c=a(23453),u=a(81911),m=a(71892),h=a(52729),p=a(62563),g=a(91767),f=a(65357),E=a(62844),_=a(2386),C=a(94592),b=a(10189),v=a(17463),y=a(30388),T=a(51521),M=a(1396),I=a(60853),w=a(78451),k=a(3295),A=a(93725),N=(a(29206),a(85406)),R=a(77440),S=a(59671),O=a(79751),L=a(7380),P=a(14696),x=a(95025),D=a(91502);const U={x:-6,y:62},F=()=>{const{formatMessage:e}=(0,o.useIntl)();return d().createElement(x.e,{variant:x.l.TutorialTip},e({id:"tutorial_threads.list.Up",defaultMessage:"UP"}))},j=()=>{const{formatMessage:e}=(0,o.useIntl)();return d().createElement(x.e,{variant:x.l.TutorialTip},e({id:"tutorial_threads.list.Down",defaultMessage:"Down"}))},B=()=>{const{formatMessage:e}=(0,o.useIntl)(),t=(0,c.useSelector)((e=>(0,L.w3)(e))),a=d().createElement(o.FormattedMessage,{id:"tutorial_threads.list.title",defaultMessage:"Threads List"}),l=d().createElement(d().Fragment,null,d().createElement("p",null,e({id:"tutorial_threads.list.description-p1",defaultMessage:"Here you’ll see a preview of all threads you’re following or participating in. Clicking on a thread in this list will open the full thread on the right."})),d().createElement("p",null,e({id:"tutorial_threads.list.description-p2",defaultMessage:"Use {upKey} / {downKey} to navigate the thread list."},{upKey:d().createElement(F,null),downKey:d().createElement(j,null)}))),r=t?["tutorial-threads-mobile-list","tutorial-threads-mobile-header"]:["threads-list-container"],n=(0,P.LX)(r,[]);return d().createElement(D.A,{title:a,screen:l,overlayPunchOut:n,placement:"right-start",pulsatingDotPlacement:"right-start",pulsatingDotTranslate:U})},G=()=>{const{formatMessage:e}=(0,o.useIntl)(),t=d().createElement(o.FormattedMessage,{id:"tutorial_threads.unread.title",defaultMessage:"Unread threads"}),a=d().createElement("p",null,e({id:"tutorial_threads.unread.description",defaultMessage:"You can switch to <b>Unreads</b> to show only threads that are unread."},{b:e=>d().createElement("b",null,e)})),l=(0,P.LX)(["threads-list-unread-button"],[]);return d().createElement(D.A,{title:t,screen:a,overlayPunchOut:l,placement:"bottom-start",pulsatingDotPlacement:"bottom"})};var K=a(41125),V=a(87131),H=a(19513),z=a(85873),Y=a(62688),q=a.n(Y),Z=a(70713),W=a(91793),X=a(10022),J=a(55722);a(4290),a(10844);const Q=e=>{let{width:t,height:a}=e;return d().createElement("svg",{width:(null==t?void 0:t.toString())||"72",height:(null==a?void 0:a.toString())||"48",viewBox:"0 0 72 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d().createElement("g",{clipPath:"url(#clip0_410_25534)"},d().createElement("path",{d:"M35.1353 12.5745H4.8754C4.32086 12.5726 3.77137 12.6798 3.25832 12.8898C2.74526 13.0998 2.27869 13.4087 1.88524 13.7986C1.49178 14.1886 1.17916 14.6521 0.965209 15.1627C0.751261 15.6732 0.640179 16.2208 0.638306 16.7742V35.9654C0.640179 36.5188 0.751261 37.0664 0.965209 37.577C1.17916 38.0875 1.49178 38.551 1.88524 38.941C2.27869 39.331 2.74526 39.6398 3.25832 39.8498C3.77137 40.0599 4.32086 40.167 4.8754 40.1651H9.34115V47.3489L16.0398 40.1651H35.1246C35.6791 40.167 36.2286 40.0599 36.7417 39.8498C37.2547 39.6398 37.7213 39.331 38.1147 38.941C38.5082 38.551 38.8208 38.0875 39.0348 37.577C39.2487 37.0664 39.3598 36.5188 39.3617 35.9654V16.7742C39.3579 15.6585 38.9108 14.5897 38.1185 13.8024C37.3262 13.0151 36.2534 12.5735 35.1353 12.5745Z",fill:"var(--away-indicator)"}),d().createElement("path",{d:"M16.0398 40.1651H35.1246C35.6791 40.167 36.2286 40.0598 36.7417 39.8498C37.2547 39.6397 37.7213 39.3309 38.1148 38.9409C38.5082 38.5509 38.8208 38.0874 39.0348 37.5769C39.2487 37.0663 39.3598 36.5187 39.3617 35.9653V24.3145C39.3617 24.3145 38.0291 35.0883 37.7897 36.0367C37.5504 36.985 37.0752 38.4039 34.8245 38.6392C32.5738 38.8745 16.0398 40.1651 16.0398 40.1651Z",fill:"#CC8F00"}),d().createElement("path",{d:"M9.66973 23.6263C10.2089 23.6263 10.7359 23.7859 11.1842 24.0848C11.6324 24.3837 11.9818 24.8085 12.1881 25.3056C12.3944 25.8026 12.4484 26.3496 12.3432 26.8772C12.2381 27.4049 11.9785 27.8896 11.5972 28.27C11.216 28.6504 10.7303 28.9095 10.2015 29.0145C9.67275 29.1194 9.12467 29.0656 8.62657 28.8597C8.12848 28.6538 7.70276 28.3051 7.40323 27.8578C7.10371 27.4105 6.94383 26.8845 6.94383 26.3465C6.94336 25.9892 7.01355 25.6353 7.15038 25.305C7.2872 24.9748 7.48797 24.6747 7.74118 24.422C7.9944 24.1693 8.29509 23.969 8.62602 23.8324C8.95695 23.6959 9.31163 23.6259 9.66973 23.6263Z",fill:"var(--center-channel-bg)"}),d().createElement("path",{d:"M20.0056 23.6263C20.5447 23.6263 21.0717 23.7859 21.52 24.0848C21.9683 24.3837 22.3177 24.8085 22.524 25.3056C22.7303 25.8026 22.7843 26.3496 22.6791 26.8772C22.5739 27.4049 22.3143 27.8896 21.9331 28.27C21.5518 28.6504 21.0661 28.9095 20.5374 29.0145C20.0086 29.1194 19.4605 29.0656 18.9624 28.8597C18.4643 28.6538 18.0386 28.3051 17.7391 27.8578C17.4396 27.4105 17.2797 26.8845 17.2797 26.3465C17.2792 25.9892 17.3494 25.6353 17.4862 25.305C17.6231 24.9748 17.8238 24.6747 18.077 24.422C18.3303 24.1693 18.6309 23.969 18.9619 23.8324C19.2928 23.6959 19.6475 23.6259 20.0056 23.6263Z",fill:"var(--center-channel-bg)"}),d().createElement("path",{d:"M30.33 23.6263C30.8693 23.6256 31.3967 23.7846 31.8454 24.083C32.2942 24.3815 32.6441 24.8061 32.851 25.3031C33.0579 25.8001 33.1123 26.3471 33.0076 26.875C32.9028 27.4029 32.6435 27.888 32.2624 28.2688C31.8813 28.6495 31.3956 28.909 30.8667 29.0142C30.3379 29.1195 29.7896 29.0658 29.2913 28.86C28.793 28.6542 28.3671 28.3056 28.0674 27.8582C27.7677 27.4108 27.6077 26.8847 27.6077 26.3465C27.6073 25.9895 27.6773 25.6358 27.8139 25.3058C27.9505 24.9758 28.151 24.6759 28.4038 24.4233C28.6566 24.1706 28.9569 23.9702 29.2874 23.8335C29.618 23.6967 29.9722 23.6263 30.33 23.6263Z",fill:"var(--center-channel-bg)"}),d().createElement("path",{d:"M3.7787 20.6104C4.08616 19.5244 4.60589 18.5098 5.30794 17.625C6.00999 16.7403 6.88049 16.0028 7.86932 15.4552C7.92789 15.4257 7.97498 15.3776 8.00322 15.3184C8.03145 15.2593 8.03923 15.1925 8.02534 15.1285C8.01145 15.0645 7.97668 15.0069 7.92646 14.9647C7.87625 14.9225 7.81343 14.8982 7.74785 14.8955C5.84009 14.7814 1.98883 15.1878 3.19637 20.5819C3.20911 20.6477 3.24362 20.7074 3.29437 20.7513C3.34513 20.7953 3.4092 20.821 3.47632 20.8242C3.54343 20.8275 3.60972 20.8082 3.66454 20.7695C3.71937 20.7307 3.75956 20.6747 3.7787 20.6104Z",fill:"#FFD470"}),d().createElement("path",{opacity:"0.4",d:"M32.3334 7.28991C34.7785 4.81371 37.8644 3.53829 41.5849 3.46985C45.237 3.53829 48.3042 4.80749 50.7866 7.28991C53.2628 9.77233 54.5383 12.8396 54.6067 16.4917C54.5383 20.2122 53.269 23.2919 50.7866 25.7432C48.3042 28.1883 45.237 29.4824 41.5849 29.6068C37.8644 29.4761 34.7847 28.1883 32.3334 25.7432C29.8883 23.2919 28.6004 20.206 28.4698 16.4854C28.6004 12.8334 29.8883 9.76611 32.3334 7.28991Z",fill:"var(--center-channel-bg)"}),d().createElement("path",{d:"M53.5706 14.1678C52.464 10.5721 50.3691 7.88057 47.2828 6.09868C44.1964 4.31679 40.8181 3.84832 37.1508 4.68784C35.1455 5.20001 33.3983 6.08537 31.8951 7.34293C33.576 5.5084 35.7082 4.23809 38.2863 3.52882C41.9535 2.68929 45.3485 3.16738 48.4626 4.9653C51.5767 6.76321 53.6882 9.46433 54.7948 13.06C55.4751 15.6505 55.4412 18.1323 54.6873 20.502C53.939 22.875 52.5957 24.8683 50.6551 26.4733C52.1121 24.8855 53.1147 23.0208 53.6603 20.8706C54.2005 18.7172 54.1703 16.4876 53.5706 14.1678Z",fill:"black",fillOpacity:"0.4"}),d().createElement("path",{d:"M57.6194 15.4776C57.3584 11.6178 55.7919 8.22807 52.9264 5.30846C49.663 2.19708 45.8961 0.638306 41.6257 0.638306C37.3554 0.638306 33.5947 2.19708 30.3313 5.30846C27.2047 8.55591 25.6383 12.2982 25.6383 16.5477C25.6383 20.7973 27.2047 24.5458 30.3313 27.787C33.3274 30.6448 36.7524 32.185 40.6001 32.4077C44.4478 32.6366 47.9971 31.5788 51.2605 29.2468L53.7034 31.6778L56.83 28.5664L54.3871 26.1355C56.7989 22.8942 57.8743 19.3375 57.6194 15.4776ZM50.8689 25.6963C48.3887 28.1272 45.3242 29.4139 41.6755 29.5376C37.9583 29.4077 34.8814 28.1272 32.4323 25.6963C29.9895 23.2653 28.7028 20.1973 28.5722 16.4983C28.7028 12.8673 29.9895 9.81778 32.4323 7.34971C34.8752 4.88783 37.9583 3.61978 41.6755 3.55174C45.3242 3.61978 48.3887 4.88165 50.8689 7.34971C53.3428 9.81778 54.6171 12.8673 54.6855 16.4983C54.6171 20.1973 53.3491 23.2653 50.8689 25.6963Z",fill:"#BABEC9"}),d().createElement("path",{d:"M67.6182 46.4679C66.8121 46.6983 66.2153 46.6174 65.8276 46.225L53.1453 32.3065C52.7577 31.9142 52.5977 31.4098 52.6592 30.787C52.7207 30.1643 53.1084 29.4668 53.8222 28.6821C54.5975 27.9659 55.2867 27.5549 55.9021 27.4553C56.5174 27.3556 57.0159 27.5362 57.4035 27.9971L71.2488 40.832C71.6364 41.2243 71.698 41.8097 71.4395 42.5944C71.1811 43.3791 70.695 44.1637 69.9873 44.9484C69.2181 45.7331 68.4243 46.2375 67.6182 46.4679Z",fill:"var(--away-indicator)"}),d().createElement("path",{d:"M68.5465 38.3191L63.3621 43.5465L57.1116 36.6856L61.6961 32.0027L68.5465 38.3191Z",fill:"#7A5600"})),d().createElement("defs",null,d().createElement("clipPath",{id:"clip0_410_25534"},d().createElement("rect",{width:"72",height:"48",fill:"var(--center-channel-bg)"}))))};Q.propTypes={width:q().number,height:q().number};const $=Q;var ee=a(92243),te=a(83642),ae=a(5908),le=a(65952),re=a(14776),ne=a(7430),se=(a(6889),a(54823),a(29012),a(68427)),ie=a(30413),de=a(17085),oe=a(40057),ce=a(39487),ue=a(18515),me=a(64276),he=a(92387);const pe=a.n(he)().span.withConfig({displayName:"Badge"})(["display:flex;align-items:center;justify-content:center;height:20px;width:20px;margin-left:8px;min-width:20px;border-radius:10px;color:#fff;background-color:",""],(e=>e.priority===se.X.URGENT?"rgb(var(--semantic-color-danger))":"rgb(var(--semantic-color-info))"));function ge(e){let{priority:t,className:a}=e;return t!==se.X.URGENT&&t!==se.X.IMPORTANT?null:d().createElement(pe,{className:a,priority:t},t===se.X.URGENT?d().createElement(N.AlertOutlineIcon,{size:14}):d().createElement(N.AlertCircleOutlineIcon,{size:14}))}ge.propTypes={className:q().string};var fe=a(81769),Ee=a(77828),_e=a(67416),Ce=a(87262),be=a(90486),ve=a(85866);function ye(e){let{fallback:t,title:a,text:l,author_name:r,pretext:n}=e;return d().createElement("div",null,d().createElement("div",{className:"attachment__truncated"},"".concat(r,": ").concat(a)),d().createElement("div",{className:"attachment__truncated"},(0,ve.eA)(l||n||t||"")))}ye.propTypes={fallback:q().string,pretext:q().string,title:q().string,text:q().string,author_name:q().string};const Te=ye;var Me=a(69813),Ie=a(26614),we=a(31655);function ke(e){let{id:t,has_preview_image:a,mini_preview:l,mime_type:n,extension:s,enableSVGs:o}=e;const c=(0,i.useMemo)((()=>{if(a)return l?"data:".concat(n,";base64,").concat(l):(0,we.cd)(t)}),[t,l,n,a]),u=(0,z.ti)(s);switch(u){case w.a0.SVG:return o?d().createElement("img",{alt:"file preview",className:"file_card__image post-image small",src:(0,we.w8)(t)}):d().createElement("div",{className:r()("icon","icon-20",(0,z.Rr)(u),"file_card__attachment")});case w.a0.IMAGE:return d().createElement("img",{alt:"file preview",className:"file_card__image post-image small",src:c});default:return d().createElement("i",{className:r()("icon","icon-20",(0,z.Rr)(u),"file_card__attachment")})}}function Ae(e){let{children:t,title:a,size:l}=e;return d().createElement("div",{className:"file_card",title:a},t,d().createElement("div",{className:"file_card__name"},a),null!=l&&d().createElement("div",{className:"file_card__size"},(0,z.O1)(l)))}function Ne(e){let{file:t,enableSVGs:a}=e;return t?d().createElement(Ae,{title:t.name,size:t.size},d().createElement(ke,Object.assign({enableSVGs:a},t))):null}ke.propTypes={enableSVGs:q().bool.isRequired},Ae.propTypes={children:q().element,title:q().string.isRequired,size:q().number},Ne.propTypes={enableSVGs:q().bool.isRequired};const Re=(0,i.memo)(Ne),Se=(0,c.connect)((function(e,t){return{file:(0,Me.ly)(e,t.id),enableSVGs:"true"===(0,Ie.zj)(e).EnableSVGs}}))(Re),Oe=function(e){var t;let{post:a}=e;return null!==(t=a.file_ids)&&void 0!==t&&t.length?d().createElement(Se,{id:a.file_ids[0]}):(0,be.Q)(a.props.attachments)&&a.props.attachments.length?d().createElement(Te,a.props.attachments[0]):null};var Le=a(94752),Pe=a(3490),xe=a(87778),De=a(17983),Ue=a(99068),Fe=a(63155);function je(e){let{threadId:t,isFollowing:a=!1,unreadTimestamp:l,hasUnreads:r,children:n}=e;const{formatMessage:s}=(0,o.useIntl)(),u=(0,c.useDispatch)(),{params:{team:p},currentTeamId:g,currentUserId:f,goToInChannel:E}=(0,Pe.K)(),_=(0,c.useSelector)((e=>(0,h.Lc)(e,t))),b=(0,i.useCallback)((()=>{const e=r?Date.now():l;u((0,C.ev)(t,e)),u(r?(0,m.Co)(f,g,t,Date.now()):(0,m.A0)(f,g,t))}),[f,g,t,r,m.Co,l]);return d().createElement(Ue.A,{stopPropagationOnToggle:!0},n,d().createElement(De.A,{ariaLabel:s({id:"threading.threadItem.menu",defaultMessage:"Actions"}),openLeft:!0},d().createElement(De.A.ItemAction,Object.assign({},a?{text:s({id:"threading.threadMenu.unfollow",defaultMessage:"Unfollow thread"}),extraText:s({id:"threading.threadMenu.unfollowExtra",defaultMessage:"You won’t be notified about replies"})}:{text:s({id:"threading.threadMenu.follow",defaultMessage:"Follow thread"}),extraText:s({id:"threading.threadMenu.followExtra",defaultMessage:"You will be notified about replies"})},{onClick:(0,i.useCallback)((()=>{u((0,m.ap)(f,g,t,!a))}),[f,g,t,a,m.ap])})),d().createElement(De.A.ItemAction,{text:s({id:"threading.threadMenu.openInChannel",defaultMessage:"Open in channel"}),onClick:(0,i.useCallback)((()=>{E(t)}),[t])}),d().createElement(De.A.ItemAction,{text:s(r?{id:"threading.threadMenu.markRead",defaultMessage:"Mark as read"}:{id:"threading.threadMenu.markUnread",defaultMessage:"Mark as unread"}),onClick:b}),d().createElement(De.A.ItemAction,{text:s(_?{id:"threading.threadMenu.unsave",defaultMessage:"Unsave"}:{id:"threading.threadMenu.save",defaultMessage:"Save"}),onClick:(0,i.useCallback)((()=>{u(_?(0,xe.OR)(t):(0,xe.z7)(t))}),[t,_])}),d().createElement(De.A.ItemAction,{text:s({id:"threading.threadMenu.copy",defaultMessage:"Copy link"}),onClick:(0,i.useCallback)((()=>{(0,z.lW)("".concat((0,Fe.vV)(),"/").concat(p,"/pl/").concat(t))}),[p,t])})))}function Be(e,t){return e.threadId===t.threadId&&e.isFollowing===t.isFollowing&&e.unreadTimestamp===t.unreadTimestamp&&e.hasUnreads===t.hasUnreads}const Ge=(0,i.memo)(je,Be),Ke={singleline:!0,mentionHighlight:!1,atMentions:!0};function Ve(e){var t,a;let{channel:l,currentRelativeTeamUrl:n,displayName:s,isSelected:u,post:h,postsInThread:p,style:g,thread:f,threadId:E,isFirstThreadInList:_,isPostPriorityEnabled:b}=e;const v=(0,c.useDispatch)(),{select:y,goToInChannel:T,currentTeamId:M}=(0,Pe.K)(),{formatMessage:I}=(0,o.useIntl)(),k=(0,c.useSelector)(L.w3),A=(0,c.useSelector)(ne.WR),S=(0,c.useSelector)((e=>(0,R.yW)(e,w.pm.CRT_TUTORIAL_STEP,A)))===w.JI.LIST_POPOVER,O=I({id:"post_body.deleted",defaultMessage:"(message deleted)"}),P=(0,ce.GX)(null===(t=h.props)||void 0===t?void 0:t.override_username)||s,x=(0,i.useMemo)((()=>(0,me._)()),[]),D=(0,c.useSelector)((e=>x(e,h,l))),U=(0,i.useRef)(null);(0,i.useEffect)((()=>{null!=l&&l.teammate_id&&v((0,de.WA)([l.teammate_id]))}),[null==l?void 0:l.teammate_id]),(0,i.useEffect)((()=>{!l&&null!=f&&f.post.channel_id&&v((0,ie.c)(f.post.channel_id))}),[l,null==f?void 0:f.post.channel_id]),(0,i.useEffect)((()=>{var e;u&&(null===(e=U.current)||void 0===e||e.focus())}),[u,E]);const F=(0,i.useMemo)((()=>{const e=((null==f?void 0:f.participants)||[]).flatMap((e=>{let{id:t}=e;return t===h.user_id?[]:t})).reverse();return[h.user_id,...e]}),[null==f?void 0:f.participants]);let j=h.edit_at||h.create_at;const G=(0,i.useCallback)((e=>{if(!("key"in e)||"Enter"===e.key||" "===e.key)if(e.altKey){const e=!!f&&Boolean(f.unread_replies),t=e?Date.now():j;v((0,C.ev)(E,t)),v(e?(0,m.Co)(A,M,E,Date.now()):(0,m.A0)(A,M,E))}else y(E)}),[A,M,E,f,m.Co,j]),K=(0,i.useMemo)((()=>({onImageHeightChanged:()=>{},onImageLoaded:()=>{}})),[]),H=(0,i.useCallback)((e=>{e.stopPropagation(),T(E)}),[E]),Y=(0,i.useCallback)((e=>{"key"in e&&"Enter"!==e.key&&" "!==e.key||z.oO(e,n)}),[n]);if(!f||!h)return null;const{unread_replies:q,unread_mentions:Z,last_reply_at:W,reply_count:X,is_following:J}=f;if(p.length>1){const e=p[0];j=e.edit_at||e.create_at}return d().createElement(d().Fragment,null,d().createElement("div",{style:g,className:r()("ThreadItem",{"has-unreads":q,"is-selected":u}),tabIndex:u?-1:0,role:"link","aria-label":I({id:"threading.threadItem.ariaLabel",defaultMessage:"Thread by {author}"},{author:P}),"aria-describedby":"ThreadItem__timestamp_".concat(E),id:_?"tutorial-threads-mobile-list":"",onClick:G,onKeyDown:G,ref:U},d().createElement("header",null,Boolean(Z||q)&&d().createElement("div",{className:"indicator"},Z?d().createElement("div",{className:r()("dot-mentions",{over:Z>99})},Math.min(Z,99),Z>99&&"+"):d().createElement("div",{className:"dot-unreads"})),d().createElement("div",{className:"ThreadItem__author"},P),d().createElement("div",{className:"ThreadItem__tags"},l&&P!==(null==l?void 0:l.display_name)&&d().createElement(_e.A,{onClick:H,text:null==l?void 0:l.display_name}),b&&f.is_urgent&&d().createElement(ge,{className:P===(null==l?void 0:l.display_name)?"ml-2":"",priority:se.X.URGENT})),d().createElement(Ee.Ay,Object.assign({},Le.R,{className:"alt-hidden",value:W}))),d().createElement("div",{className:"menu-anchor alt-visible"},d().createElement(Ge,{threadId:E,isFollowing:null!=J&&J,hasUnreads:Boolean(q),unreadTimestamp:j},d().createElement(V.A,{title:d().createElement(o.FormattedMessage,{id:"threading.threadItem.menu",defaultMessage:"Actions"})},d().createElement(fe.A,{marginTop:!0,className:"Button___icon","aria-label":I({id:"threading.threadItem.menu",defaultMessage:"Actions"})},d().createElement(N.DotsVerticalIcon,{size:18}))))),d().createElement("div",{className:"preview",dir:"auto",onClick:Y,onKeyDown:Y},h.message?d().createElement(ue.A,{message:h.state===oe.AF.POST_DELETED?O:h.message,options:Ke,imagesMetadata:(null==h?void 0:h.metadata)&&(null==h||null===(a=h.metadata)||void 0===a?void 0:a.images),mentionKeys:D,imageProps:K}):d().createElement(Oe,{post:h})),d().createElement("div",{className:"activity"},null!=F&&F.length?d().createElement(Ce.A,{userIds:F,size:"xs"}):null,Boolean(X)&&d().createElement(d().Fragment,null,q?d().createElement(o.FormattedMessage,{id:"threading.numNewReplies",defaultMessage:"{newReplies, plural, =1 {# new reply} other {# new replies}}",values:{newReplies:q}}):d().createElement(o.FormattedMessage,{id:"threading.numReplies",defaultMessage:"{totalReplies, plural, =0 {Reply} =1 {# reply} other {# replies}}",values:{totalReplies:X}}))),S&&_&&k&&d().createElement(B,null),d().createElement("span",{className:"sr-only",id:"ThreadItem__timestamp_".concat(E)},d().createElement(o.FormattedMessage,{id:"threading.threadItem.timestamp",defaultMessage:"Last reply "}),d().createElement(Ee.Ay,Object.assign({},Le.R,{className:"alt-hidden",value:W})))))}const He=(0,i.memo)(Ve),ze=(0,ae.compose)((0,c.connect)((function(){const e=(0,h.Jd)(),t=(0,le.s9)(),a=(0,ne.ml)();return(l,r)=>{const{threadId:n}=r,s=(0,h.f5)(l,n);return s?{post:s,channel:t(l,s.channel_id),currentRelativeTeamUrl:(0,re._p)(l),displayName:a(l,s.user_id,!0),postsInThread:e(l,s.id),thread:(0,p.fG)(l,n),isPostPriorityEnabled:(0,h.kl)(l)}:{}}})),i.memo)(He);function Ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(a),!0).forEach((function(t){Ze(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ye(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ze(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function We(e){let{index:t,style:a,data:l}=e;const r=l.ids[t],n=l.selectedThreadId===r;return r===w.YM.THREADS_LOADING_INDICATOR_ITEM_ID?d().createElement(M.A,{message:d().createElement(d().Fragment,null),style:a}):r===w.YM.THREADS_NO_RESULTS_ITEM_ID?d().createElement(I.A,{style:qe(qe({},a),{},{padding:"16px 16px 16px 24px",background:"rgba(var(--center-channel-color-rgb), 0.04)"}),iconGraphic:d().createElement($,null),title:d().createElement(o.FormattedMessage,{id:"globalThreads.searchGuidance.title",defaultMessage:"That’s the end of the list"}),subtitle:d().createElement(o.FormattedMessage,{id:"globalThreads.searchGuidance.subtitle",defaultMessage:"If you’re looking for older conversations, try searching with {searchShortcut}",values:{searchShortcut:d().createElement(te.t,{className:"thread-no-results-subtitle-shortcut",variant:x.l.TutorialTip})}}),titleClassName:"thread-no-results-title",subtitleClassName:"thread-no-results-subtitle",layout:ee.g.Horizontal}):d().createElement(ze,{isSelected:n,key:r,style:a,threadId:r,isFirstThreadInList:0===t})}We.propTypes={data:q().shape({}).isRequired,index:q().number.isRequired,style:q().any.isRequired};const Xe=(0,i.memo)(We,W.t7),Je={willChange:"auto"};function Qe(e){let{ids:t,selectedThreadId:a,loadMoreItems:l,total:r,isLoading:n,addNoMoreResultsItem:s}=e;const o=d().useRef(),c=d().useRef(0),u=d().useRef(0);(0,i.useEffect)((()=>{if(t.length>0&&a){const l=t.indexOf(a);var e;(c.current>=l||l>u.current)&&(null===(e=o.current)||void 0===e||e._listRef.scrollToItem(l))}}),[a]);const m=(0,i.useMemo)((()=>({ids:s&&t.length===r?[...t,w.YM.THREADS_NO_RESULTS_ITEM_ID]:n&&t.length!==r&&[...t,w.YM.THREADS_LOADING_INDICATOR_ITEM_ID]||t,selectedThreadId:a})),[t,a,n,s,r]),h=(0,i.useCallback)(((e,t)=>t.ids[e]),[]),p=(0,i.useCallback)((e=>t.length===r||e<t.length),[t,r]);return d().createElement(Z.Ay,null,(e=>{let{height:t,width:a}=e;return d().createElement(X.A,{ref:o,itemCount:r,loadMoreItems:l,isItemLoaded:p,minimumBatchSize:J.A.THREADS_PAGE_SIZE},(e=>{let{onItemsRendered:l,ref:r}=e;return d().createElement(W.Y1,{onItemsRendered:e=>{let{overscanStartIndex:t,overscanStopIndex:a,visibleStartIndex:r,visibleStopIndex:n}=e;l({overscanStartIndex:t,overscanStopIndex:a,visibleStartIndex:r,visibleStopIndex:n}),c.current=r,u.current=n},ref:r,height:t,itemCount:m.ids.length,itemData:m,itemKey:h,itemSize:133,style:Je,width:a,className:"virtualized-thread-list"},Xe)}))}))}function $e(e,t){return e.selectedThreadId===t.selectedThreadId&&e.ids.join()===t.ids.join()&&e.isLoading===t.isLoading&&e.addNoMoreResultsItem===t.addNoMoreResultsItem}Qe.propTypes={loadMoreItems:q().func.isRequired,total:q().number.isRequired,isLoading:q().bool,addNoMoreResultsItem:q().bool};const et=(0,i.memo)(Qe,$e);function tt(e){let{onConfirm:t,onCancel:a}=e;const{formatMessage:l}=(0,o.useIntl)();return d().createElement(P.zW,{className:"mark-all-threads-as-read",id:"mark-all-threads-as-read-modal",compassDesign:!0,modalHeaderText:l({id:"mark_all_threads_as_read_modal.title",defaultMessage:"Mark all your threads as read?"}),confirmButtonText:l({id:"mark_all_threads_as_read_modal.confirm",defaultMessage:"Mark all as read"}),cancelButtonText:l({id:"mark_all_threads_as_read_modal.cancel",defaultMessage:"Cancel"}),onExited:a,handleCancel:a,handleConfirm:t},d().createElement("div",{className:"mark_all_threads_as_read_modal__body"},d().createElement("span",null,l({id:"mark_all_threads_as_read_modal.description",defaultMessage:"This will clear the unread state and mention badges on all your threads. Are you sure?"}))))}tt.propTypes={onConfirm:q().func.isRequired,onCancel:q().func.isRequired};const at=tt;let lt=function(e){return e.none="",e.unread="unread",e}({});const rt=e=>{var t;let{currentFilter:a=lt.none,someUnread:l,setFilter:r,selectedThreadId:n,unreadIds:u,ids:h}=e;const g=(0,c.useSelector)(L.w3),f=lt.unread===a,E=f?u:h,_=d().useRef(null),{currentTeamId:C,currentUserId:b,clear:v,select:y}=(0,Pe.K)(),T=(0,c.useSelector)((e=>(0,R.yW)(e,w.pm.CRT_TUTORIAL_STEP,b))),M=T===w.JI.LIST_POPOVER,k=T===w.JI.UNREAD_POPOVER,{formatMessage:A}=(0,o.useIntl)(),P=(0,c.useDispatch)(),{total:x=0,total_unread_threads:D}=null!==(t=(0,c.useSelector)(p.kL))&&void 0!==t?t:{},[U,F]=d().useState(!1),[j,Y]=d().useState(!1),q=(0,i.useCallback)((e=>{var t;const a=e.target,l=null==a||null===(t=a.tagName)||void 0===t?void 0:t.toLowerCase();if("input"===l||"textarea"===l||"select"===l)return;if(e.altKey||e.metaKey||e.shiftKey||e.ctrlKey||!H.e(e,w.YM.KeyCodes.DOWN)&&!H.e(e,w.YM.KeyCodes.UP))return;const r=0===document.getElementsByClassName(w.V6.MODAL).length,s=0===document.getElementsByClassName(w.V6.POPUP).length;if(!r||!s)return;let i=0;if(n){const t=E.indexOf(n);if(H.e(e,w.YM.KeyCodes.DOWN)&&(t<E.length-1&&(i=t+1),t===E.length-1))return;if(H.e(e,w.YM.KeyCodes.UP)){if(!(t>0))return;i=t-1}}y(E[i]),e.preventDefault()}),[n,E]);(0,i.useEffect)((()=>(document.addEventListener("keydown",q),()=>{document.removeEventListener("keydown",q)})),[q]);const Z=(0,i.useCallback)((e=>{e===lt.unread&&(0,S.sx)("crt","filter_threads_by_unread"),r(e)}),[r]),W=(0,i.useCallback)((async e=>{F(!0);let t=E[e-1];return t===n&&(t=E[e-2]),await P((0,m.rj)({unread:f,before:t})),F(!1),Y(!0),{data:!0}}),[C,E,f,n]),X=(0,i.useCallback)((()=>{(0,S.sx)("crt","mark_all_threads_read"),P((0,m.kW)(b,C)),a===lt.unread&&v()}),[C,b,a]),J=(0,i.useCallback)((()=>{const e=()=>{P((0,O.O)(w.IQ.MARK_ALL_THREADS_AS_READ))},t={onConfirm:()=>{X(),e()},onCancel:e};P((0,O.q)({modalId:w.IQ.MARK_ALL_THREADS_AS_READ,dialogType:at,dialogProps:t}))}),[X]),{tabListProps:Q,tabProps:$}=function(e){let{activeTab:t,setActiveTab:a,tabs:l}=e;const r=(0,i.useCallback)((e=>{let r=0;if(H.e(e,w.YM.KeyCodes.RIGHT)?r=1:H.e(e,w.YM.KeyCodes.LEFT)&&(r=-1),0===r)return;let n=l.findIndex((e=>e.name===t));n+=r,n=(0,z.zi)(n,l.length),a(l[n].name),(0,z.b6)(document.getElementById(l[n].id))}),[t,a,l]);return{tabListProps:{role:"tablist","aria-orientation":"horizontal"},tabProps:l.map((e=>({id:e.id,role:"tab",onClick:()=>a(e.name),onKeyDown:r,tabIndex:e.name===t?0:-1,"aria-controls":e.panelId,"aria-selected":t===e.name})))}}({activeTab:a,setActiveTab:Z,tabs:[{id:"threads-list-filter-none",name:lt.none,panelId:"threads-list"},{id:"threads-list-filter-unread",name:lt.unread,panelId:"threads-list"}]});return d().createElement("div",{tabIndex:0,ref:_,className:"ThreadList",id:"threads-list-container"},d().createElement(K.A,{id:"tutorial-threads-mobile-header",heading:d().createElement("div",Object.assign({className:"tab-buttons-list","aria-label":A({id:"threading.threadList.tabsLabel",defaultMessage:"Filter visible threads"})},Q),d().createElement("div",{className:"tab-button-wrapper"},d().createElement(fe.A,Object.assign({className:"Button___large Margined",isActive:a===lt.none},$[0]),d().createElement(o.FormattedMessage,{id:"globalThreads.heading",defaultMessage:"Followed threads"}))),d().createElement("div",{id:"threads-list-unread-button",className:"tab-button-wrapper"},d().createElement(fe.A,Object.assign({className:"Button___large Margined",isActive:a===lt.unread,hasDot:l},$[1]),d().createElement(o.FormattedMessage,{id:"threading.filters.unreads",defaultMessage:"Unreads"})),k&&d().createElement(G,null))),right:d().createElement("div",{className:"right-anchor"},d().createElement(V.A,{title:A({id:"threading.threadList.markRead",defaultMessage:"Mark all threads as read"})},d().createElement(fe.A,{id:"threads-list__mark-all-as-read","aria-label":A({id:"threading.threadList.markRead",defaultMessage:"Mark all threads as read"}),className:"Button___large Button___icon",onClick:J,marginTop:!0},d().createElement("span",{className:"icon"},d().createElement(N.PlaylistCheckIcon,{size:18})))))}),d().createElement("div",{id:"threads-list",role:"tabpanel",className:"threads","data-testid":"threads_list"},d().createElement(et,{key:"threads_list_".concat(a),loadMoreItems:W,ids:E,selectedThreadId:n,total:f?D:x,isLoading:U,addNoMoreResultsItem:j&&!f}),M&&!g&&d().createElement(B,null),f&&!l&&s()(u)?d().createElement(I.A,{expanded:!0,title:A({id:"globalThreads.threadList.noUnreadThreads",defaultMessage:"No unread threads"}),subtitle:A({id:"globalThreads.threadList.noUnreadThreads.subtitle",defaultMessage:"You're all caught up"})}):null))},nt=(0,i.memo)(rt);var st=a(28704);const it=(0,le.s9)(),dt=(0,h.Jd)(),ot=e=>{let{thread:t,children:a}=e;const{formatMessage:l}=(0,o.useIntl)(),r=(0,c.useDispatch)(),{currentTeamId:n,currentUserId:s,goToInChannel:u,select:p}=(0,Pe.K)(),{id:g,is_following:f,post:{channel_id:E}}=t,_=(0,c.useSelector)((e=>it(e,E))),C=(0,c.useSelector)((e=>(0,h.f5)(e,t.id))),b=(0,c.useSelector)((e=>dt(e,C.id))),v=(0,i.useCallback)((()=>p()),[]);let y=C.edit_at||C.create_at;if(b.length>1){const e=b[0];y=e.edit_at||e.create_at}const T=(0,i.useCallback)((()=>{u(g)}),[u,g]),M=(0,i.useCallback)((()=>{r((0,m.ap)(s,n,g,!f))}),[r,s,n,g,f]);return d().createElement("div",{id:"thread-pane-container",className:"ThreadPane"},d().createElement(K.A,{className:"ThreadPane___header",heading:d().createElement(d().Fragment,null,d().createElement(fe.A,{className:"Button___icon Button___large back",onClick:v},d().createElement("i",{className:"icon icon-arrow-back-ios"})),d().createElement("h3",null,d().createElement("span",{className:"separated"},l({id:"threading.header.heading",defaultMessage:"Thread"})),d().createElement(fe.A,{className:"separated",allowTextOverflow:!0,onClick:T},null==_?void 0:_.display_name))),right:d().createElement(d().Fragment,null,d().createElement(st.A,{isFollowing:f,disabled:null==f,onClick:M}),d().createElement(Ge,{threadId:g,isFollowing:f,hasUnreads:Boolean(t.unread_replies||t.unread_mentions),unreadTimestamp:y},d().createElement(V.A,{title:l({id:"threading.threadHeader.menu",defaultMessage:"More Actions"})},d().createElement(fe.A,{className:"Button___icon Button___large"},d().createElement(N.DotsVerticalIcon,{size:18})))))}),a)},ct=(0,i.memo)(ot);var ut=a(4562);const mt=()=>{const{formatMessage:e}=(0,o.useIntl)(),t=(0,c.useDispatch)(),{url:a,params:{threadIdentifier:l}}=(0,u.useRouteMatch)(),[n,N]=(0,v.Q)(lt.none,"globalThreads_filter"),{currentTeamId:R,currentUserId:S,clear:O}=(0,Pe.K)(),L=(0,c.useSelector)(p.kL),P=(0,c.useSelector)((e=>(0,p.fG)(e,l))),x=(0,c.useSelector)(b.EB),D=(0,c.useSelector)((e=>(0,h.f5)(e,l))),U=(0,c.useSelector)((e=>(0,p.wG)(e)),c.shallowEqual),F=(0,c.useSelector)((e=>(0,p.BA)(e)),c.shallowEqual),j=(null==L?void 0:L.total_unread_threads)||0;(0,i.useEffect)((()=>{t(_.tU),t((0,E.bT)(A.L.Page,A.j.Threads)),t(g.ac),(0,f.mp)();const e=y.A.getPreviousViewedType(S,R);return e!==w.po.THREADS&&(y.A.setPenultimateViewedType(S,R,e),y.A.setPreviousViewedType(S,R,w.po.THREADS)),()=>{t(_.ED)}}),[]),(0,i.useEffect)((()=>{t((0,m.H_)(S,R))}),[R,S]),(0,i.useEffect)((()=>{x&&x===l||t((0,C.Br)(R,null==P?void 0:P.id))}),[R,x,l]);const B=s()(U)&&s()(F),[G,K]=(0,i.useState)(B),V=s()(U),H=s()(F);(0,i.useEffect)((()=>{const e=[];V&&e.push(t((0,m.rj)({unread:!1}))),n===lt.unread&&H&&e.push(t((0,m.rj)({unread:!0}))),Promise.all(e).then((()=>{K(!1)}))}),[n,U,F]),(0,i.useEffect)((()=>{G||((0,k.uB)({name:k.t$.GlobalThreadsLoad,startMark:k.CU.GlobalThreadsLinkClicked,canFail:!0}),performance.clearMarks(k.CU.GlobalThreadsLinkClicked))}),[G]),(0,i.useEffect)((()=>{P||D||G||O()}),[R,P,D,G,L,n]),(0,i.useEffect)((()=>()=>{t((0,C.Br)(R,""))}),[]);const z=(0,i.useCallback)((()=>{N(lt.unread)}),[]);return d().createElement("div",{id:"app-content",className:r()("GlobalThreads app__content",{"thread-selected":Boolean(P)})},G||B?d().createElement("div",{className:"no-results__holder"},G?d().createElement(M.A,null):d().createElement(I.A,{expanded:!0,iconGraphic:T.A,title:e({id:"globalThreads.noThreads.title",defaultMessage:"No followed threads yet"}),subtitle:e({id:"globalThreads.noThreads.subtitle",defaultMessage:"Any threads you are mentioned in or have participated in will show here along with any threads you have followed."})})):d().createElement(d().Fragment,null,d().createElement(nt,{currentFilter:n,setFilter:N,someUnread:Boolean(j),selectedThreadId:l,ids:U,unreadIds:F}),P&&D?d().createElement(ct,{thread:P},d().createElement(ut.A,{rootPostId:P.id,useRelativeTimestamp:!0,isThreadView:!0})):d().createElement(I.A,{expanded:!0,iconGraphic:T.A,title:e({id:"globalThreads.threadPane.unselectedTitle",defaultMessage:"{numUnread, plural, =0 {Looks like you’re all caught up} other {Catch up on your threads}}"},{numUnread:j}),subtitle:e({id:"globalThreads.threadPane.unreadMessageLink",defaultMessage:"You have {numUnread, plural, =0 {no unread threads} =1 {<link>{numUnread} thread</link>} other {<link>{numUnread} threads</link>}} {numUnread, plural, =0 {} other {with unread messages}}"},{numUnread:j,link:e=>d().createElement(u.Link,{key:"single",to:"".concat(a,"/").concat(F[0]),onClick:z},e)})})))},ht=(0,i.memo)(mt)},3490:(e,t,a)=>{a.d(t,{K:()=>d}),a(3188),a(59297);var l=a(97023),r=a(23453),n=a(81911),s=a(14776),i=a(7430);function d(){const e=(0,n.useParams)(),t=(0,l.useMemo)((()=>e),[e.threadIdentifier,e.team]),a=(0,n.useHistory)(),d=(0,r.useSelector)(s.Sy,r.shallowEqual),o=(0,r.useSelector)(i.WR,r.shallowEqual),c=(0,l.useCallback)((e=>a.push("/".concat(t.team,"/threads").concat(e?"/"+e:""))),[t.team]),u=(0,l.useCallback)((()=>a.replace("/".concat(t.team,"/threads"))),[t.team]),m=(0,l.useCallback)((function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.team;return a.push("/".concat(l,"/pl/").concat(null!=e?e:t.threadIdentifier))}),[t.threadIdentifier,t.team]);return{params:t,history:a,currentTeamId:d,currentUserId:o,clear:u,select:c,goToInChannel:m}}},91502:(e,t,a)=>{a.d(t,{A:()=>s}),a(29206);var l=a(97023),r=a.n(l),n=a(99243);const s=e=>r().createElement(n.QN,Object.assign({},e,{tourCategory:n.AG.CRT_TUTORIAL_STEP}))},41125:(e,t,a)=>{a.d(t,{A:()=>o}),a(29206),a(57406),a(55448);var l=a(71633),r=a.n(l),n=a(97023),s=a.n(n);const i=["level","heading","subtitle","right"],d=[n.Fragment,"h1","h2","h3","h4","h5","h6"],o=e=>{let{level:t=0,heading:a,subtitle:l,right:n}=e,o=function(e,t){if(null==e)return{};var a,l,r=function(e,t){if(null==e)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(t.includes(l))continue;a[l]=e[l]}return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(l=0;l<n.length;l++)a=n[l],t.includes(a)||{}.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}(e,i);const c=d[t];return s().createElement("header",Object.assign({},o,{className:r()("Header",o.className)}),s().createElement("div",{className:"left"},s().createElement(c,null,a),l?s().createElement("p",null,l):null),s().createElement("div",{className:"spacer"}),n)}}}]);
//# sourceMappingURL=7173.6b967ced5d49be0d1ddd.js.map