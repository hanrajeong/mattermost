"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[285],{45495:(e,n,t)=>{t.d(n,{A:()=>u});var a=t(62688),r=t.n(a),l=(t(29206),t(97023)),s=t.n(l),i=t(14778),o=t(17461);const c=e=>{let n,t,a,r,{show:l,onConfirm:c,onCancel:u,displayName:m,toPublic:h}=e;h?(n=d.toPublicTitle,t=d.toPublicMessage,a=d.toPublicConfirm,r=d.toPublicMessageConfirmation):(n=d.toPrivateTitle,t=d.toPrivateMessage,a=d.toPrivateConfirm,r=d.toPrivateMessageConfirmation);const g=s().createElement(i.FormattedMessage,Object.assign({},n,{values:{displayName:m}})),p=s().createElement(s().Fragment,null,s().createElement("p",null,s().createElement(i.FormattedMessage,Object.assign({},t,{values:{displayName:s().createElement("strong",null,m)}}))),s().createElement("p",null,s().createElement(i.FormattedMessage,Object.assign({},r,{values:{displayName:s().createElement("strong",null,m)}})))),E=s().createElement(i.FormattedMessage,a),b=s().createElement(i.FormattedMessage,{id:"admin.team_channel_settings.convertConfirmModal.cancel",defaultMessage:"No, cancel"});return s().createElement(o.A,{show:l,title:g,message:p,modalClass:"discard-changes-modal",confirmButtonClass:"btn btn-primary",confirmButtonText:E,cancelButtonText:b,onConfirm:c,onCancel:u})};c.propTypes={show:r().bool.isRequired,onConfirm:r().func.isRequired,onCancel:r().func.isRequired,displayName:r().string.isRequired,toPublic:r().bool.isRequired};const d=(0,i.defineMessages)({toPrivateConfirm:{id:"admin.team_channel_settings.convertConfirmModal.toPrivateConfirm",defaultMessage:"Yes, convert to private channel"},toPrivateMessage:{id:"admin.team_channel_settings.convertConfirmModal.toPrivateMessageFirstLine",defaultMessage:"When you convert {displayName} to a private channel, history and membership are preserved. Publicly shared files remain accessible to anyone with the link. Membership in a private channel is by invitation only."},toPrivateMessageConfirmation:{id:"admin.team_channel_settings.convertConfirmModal.toPrivateMessageSecondLine",defaultMessage:"Are you sure you want to convert {displayName} to a private channel?"},toPrivateTitle:{id:"admin.team_channel_settings.convertConfirmModal.toPrivateTitle",defaultMessage:"Convert {displayName} to a private channel?"},toPublicConfirm:{id:"admin.team_channel_settings.convertConfirmModal.toPublicConfirm",defaultMessage:"Yes, convert to public channel"},toPublicMessage:{id:"admin.team_channel_settings.convertConfirmModal.toPublicMessageFirstLine",defaultMessage:"When you convert {displayName} to a public channel, history and membership are preserved. Public channels are discoverable and can be joined by users on the system without invitation."},toPublicMessageConfirmation:{id:"admin.team_channel_settings.convertConfirmModal.toPublicMessageSecondLine",defaultMessage:"Are you sure you want to convert {displayName} to a public channel?"},toPublicTitle:{id:"admin.team_channel_settings.convertConfirmModal.toPublicTitle",defaultMessage:"Convert {displayName} to a public channel?"}}),u=c},42945:(e,n,t)=>{t.d(n,{A:()=>m});var a=t(97023),r=t.n(a),l=t(14778),s=t(23453),i=t(77440),o=t(7430),c=t(79342),d=t(72429);const u=e=>{var n;let{dmUser:t}=e;const a=(0,s.useSelector)(o.HW),u=(0,s.useSelector)(i.K3),m=(0,c.R4)(t,u);return r().createElement(r().Fragment,null,a.id!==(null==t?void 0:t.id)&&m+" ",a.id===(null==t?void 0:t.id)&&r().createElement(l.FormattedMessage,{id:"channel_header.directchannel.you",defaultMessage:"{displayName} (you) ",values:{displayName:m}}),(0,c.P)(null!==(n=null==t?void 0:t.roles)&&void 0!==n?n:"")&&r().createElement(d.A,null))},m=(0,a.memo)(u)},6281:(e,n,t)=>{t.d(n,{A:()=>g});var a=t(62688),r=t.n(a),l=(t(17046),t(97023)),s=t.n(l),i=t(23453),o=t(65952),c=t(77440),d=t(7430),u=t(79342),m=t(72429);const h=e=>{let{gmMembers:n}=e;const t=(0,i.useSelector)(d.HW),a=(0,i.useSelector)(c.K3),r=(0,i.useSelector)(o.Lw);if(!r)return null;const l={};if(n)for(const e of n){if(e.id===t.id)continue;const n=(0,u.R4)(e,a);l[n]||(l[n]=[]),l[n].push(e)}const h=r.display_name.split(", ");return s().createElement(s().Fragment,null,h.map(((e,n)=>{var t;if(!l[e])return e;const a=l[e].shift();return s().createElement(s().Fragment,{key:null==a?void 0:a.id},n>0&&", ",e,(0,u.P)(null!==(t=null==a?void 0:a.roles)&&void 0!==t?t:"")&&s().createElement(m.A,null))})))};h.propTypes={gmMembers:r().array};const g=(0,l.memo)(h)},70285:(e,n,t)=>{t.d(n,{A:()=>Zn});var a=t(62688),r=t.n(a),l=t(71633),s=t.n(l),i=t(97023),o=t.n(i),c=t(14778),d=t(23453),u=t(35134),m=t.n(u),h=t(65952),g=t(26614),p=t(7430),E=t(21650),b=t(97026),f=t(70669),v=t(78451),_=(t(29206),t(57406),t(55448),t(85406)),C=t(79342),M=t(34086),y=t(92159),A=t(44446);const N=e=>{const{formatMessage:n}=(0,c.useIntl)(),{handleCreateLink:t,handleCreateFile:a}=(0,A.m)(e.channel.id),r=(0,b._4)(e.channel.id,"add"),l=(0,b.GX)();return(0,d.useSelector)((n=>{const t=(0,y.H)(n,e.channel.id);return t&&Object.keys(t).length>=b.PM})),r?o().createElement(f.g8,{id:"channel-menu-".concat(e.channel.id,"-bookmarks"),leadingElement:o().createElement(_.BookmarkOutlineIcon,{size:18}),labels:o().createElement(c.FormattedMessage,{id:"channel_menu.bookmarks",defaultMessage:"Bookmarks Bar"}),trailingElements:o().createElement(_.ChevronRightIcon,{size:16}),menuId:"channel-menu-".concat(e.channel.id,"-menu"),menuAriaLabel:n({id:"channel_menu.bookmarks",defaultMessage:"Bookmarks Bar"})},o().createElement(f.q7,{id:"channel-menu-".concat(e.channel.id,"-bookmarks-link"),leadingElement:o().createElement(_.LinkVariantIcon,{size:18}),labels:o().createElement(c.FormattedMessage,{id:"channel_menu.bookmarks.addLink",defaultMessage:"Add a link"}),onClick:()=>t()}),l&&o().createElement(f.q7,{id:"channel-menu-".concat(e.channel.id,"-bookmarks-file"),leadingElement:o().createElement(_.PaperclipIcon,{size:18}),labels:o().createElement(c.FormattedMessage,{id:"channel_menu.bookmarks.addFile",defaultMessage:"Attach a file"}),onClick:()=>a()})):null},I=(0,i.memo)(N);var w=t(35631),P=t(14776),T=t(25778),S=t(83007);function O(e){const n=(0,d.useDispatch)(),t=(0,d.useSelector)(P.H7),a=(0,d.useSelector)(h.UX),{id:r,channel:l}=e;let s=o().createElement(c.FormattedMessage,{id:"center_panel.direct.closeDirectMessage",defaultMessage:"Close Direct Message"});return l.type===v.YM.GM_CHANNEL&&(s=o().createElement(c.FormattedMessage,{id:"center_panel.direct.closeGroupMessage",defaultMessage:"Close Group Message"})),o().createElement(f.q7,{id:r,leadingElement:o().createElement(_.CloseIcon,{size:"18px"}),onClick:()=>{const{channel:r,currentUserID:l}=e;let s,i;r.type===v.YM.DM_CHANNEL?(i=v.YM.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,s=r.teammate_id):(i=v.YM.Preferences.CATEGORY_GROUP_CHANNEL_SHOW,s=r.id),n((0,T.iq)(r.name)),n((0,w.SF)(l,[{user_id:l,category:i,name:s,value:"false"}])),t&&(0,S.J)().push("/".concat(t.name,"/channels/").concat(a))},labels:s})}O.propTypes={currentUserID:r().string.isRequired,id:r().string};var k=t(79751),x=t(64182);const L=e=>{let{channel:n,leadingElement:t}=e;const a=(0,d.useDispatch)();return o().createElement(f.q7,{id:"channelEditHeader",leadingElement:t,onClick:()=>{a((0,k.q)({modalId:v.IQ.EDIT_CHANNEL_HEADER,dialogType:x.A,dialogProps:{channel:n}}))},labels:o().createElement(c.FormattedMessage,{id:"channel_header.setConversationHeader",defaultMessage:"Edit Header"})})};L.propTypes={leadingElement:r().node};const R=o().memo(L),F=e=>{const{formatMessage:n}=(0,c.useIntl)();return e.pluginItems&&e.pluginItems.length?o().createElement(f.g8,{id:"moreActions",labels:o().createElement(c.FormattedMessage,{id:"pluginsMenu.more_actions",defaultMessage:"More actions"}),leadingElement:o().createElement(_.AppsIcon,{size:"18px"}),trailingElements:o().createElement(_.ChevronRightIcon,{size:16}),menuId:"moreActions-menu",menuAriaLabel:n({id:"pluginsMenu.more_actions",defaultMessage:"More actions"})},e.pluginItems):o().createElement(o().Fragment,null)};F.propTypes={pluginItems:r().arrayOf(r().node).isRequired};const H=(0,i.memo)(F);var D=t(30413);const q=e=>{let{isFavorite:n,channelID:t}=e;const a=(0,d.useDispatch)();let r=o().createElement(c.FormattedMessage,{id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"});return n&&(r=o().createElement(c.FormattedMessage,{id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"})),o().createElement(f.q7,{onClick:()=>{a(n?(0,D.XJ)(t):(0,D.yc)(t))},labels:r})};q.propTypes={channelID:r().string.isRequired,isFavorite:r().bool.isRequired};const B=(0,i.memo)(q);var j=t(2386),G=t(75270);const V=["channel"],U=e=>{let{channel:n}=e,t=function(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(n.includes(a))continue;t[a]=e[a]}return t}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}(e,V);const a=(0,d.useDispatch)();let r,l=(0,d.useSelector)(G.A);return(0,d.useSelector)(G.bM)!==v._n.CHANNEL_INFO&&(l=!1),r=l?o().createElement(c.FormattedMessage,{id:"channelHeader.hideInfo",defaultMessage:"Close Info"}):o().createElement(c.FormattedMessage,{id:"channelHeader.viewInfo",defaultMessage:"View Info"}),o().createElement(o().Fragment,null,o().createElement(f.q7,Object.assign({leadingElement:o().createElement(_.InformationOutlineIcon,{size:"18px"}),onClick:()=>{a(l?(0,j.bP)():(0,j.Vl)(n.id))},labels:r},t)))};function z(e){let{isMuted:n,channel:t,userID:a}=e;const r=(0,d.useDispatch)();let l;return l=t.type===v.YM.DM_CHANNEL||t.type===v.YM.GM_CHANNEL?n?o().createElement(c.FormattedMessage,{id:"channel_header.unmuteConversation",defaultMessage:"Unmute"}):o().createElement(c.FormattedMessage,{id:"channel_header.muteConversation",defaultMessage:"Mute"}):n?o().createElement(c.FormattedMessage,{id:"channel_header.unmute",defaultMessage:"Unmute Channel"}):o().createElement(c.FormattedMessage,{id:"channel_header.mute",defaultMessage:"Mute Channel"}),o().createElement(f.q7,{leadingElement:o().createElement(_.BellOffOutlineIcon,{size:"18px"}),id:"channelToggleMuteChannel",onClick:()=>{r((0,D.cz)(a,t.id,{mark_unread:n?v.DB.ALL:v.DB.MENTION}))},labels:l})}z.propTypes={userID:r().string.isRequired,isMuted:r().bool.isRequired};const W=e=>{let{channelID:n}=e;const t=(0,d.useDispatch)(),a=(0,d.useSelector)(G.bM)===v._n.PIN;return o().createElement(f.q7,{onClick:()=>{t(a?(0,j.bP)():(0,j.H3)(n))},labels:o().createElement(c.FormattedMessage,{id:"navbar.viewPinnedPosts",defaultMessage:"View Pinned Posts"})})};W.propTypes={channelID:r().string.isRequired};const Y=(0,i.memo)(W),K=["channel","user","isMuted","isMobile","isFavorite","pluginItems","isChannelBookmarksEnabled"],X=e=>{let{channel:n,user:t,isMuted:a,isMobile:r,isFavorite:l,pluginItems:s,isChannelBookmarksEnabled:i}=e,c=function(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(n.includes(a))continue;t[a]=e[a]}return t}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}(e,K);return o().createElement(o().Fragment,null,o().createElement(U,Object.assign({channel:n},c)),o().createElement(z,{userID:t.id,channel:n,isMuted:a}),r&&o().createElement(o().Fragment,null,o().createElement(B,{channelID:n.id,isFavorite:l}),o().createElement(Y,{channelID:n.id})),o().createElement(R,{leadingElement:o().createElement(_.CogOutlineIcon,{size:"18px"}),channel:n}),o().createElement(f.wv,null),!(0,C.P)(t.roles)&&i&&o().createElement(I,{channel:n}),o().createElement(M.A,{channel:n}),!r&&o().createElement(H,{pluginItems:s}),o().createElement(f.wv,null),o().createElement(O,{currentUserID:t.id,channel:n}))};X.propTypes={isMuted:r().bool.isRequired,isMobile:r().bool.isRequired,isFavorite:r().bool.isRequired,pluginItems:r().arrayOf(r().node).isRequired,isChannelBookmarksEnabled:r().bool.isRequired};const Q=X;var J=t(40057),$=t(57486),Z=t(5908),ee=t(77440),ne=t(52073),te=(t(17046),t(43813),t(76685),t(14696)),ae=t(46859),re=t(59671),le=t(11284),se=t(53654),ie=t(24867);const oe=()=>{const e=(0,c.useIntl)();return o().createElement(ie.A,{title:e.formatMessage({id:"sidebar_left.sidebar_channel_modal.no_common_teams_error.heading",defaultMessage:"Unable to convert to a channel because group members are part of different teams"}),text:e.formatMessage({id:"sidebar_left.sidebar_channel_modal.no_common_teams_error.body",defaultMessage:"Group Message cannot be converted to a channel because members are not a part of the same team. Add all members to a single team to convert this group message to a channel in that team."}),type:"danger"})};t(74883);var ce=t(69657),de=t(43233);const ue=e=>{const[n,t]=(0,i.useState)(),a=(0,c.useIntl)(),{formatMessage:r}=a,l=(0,i.useCallback)((n=>{const a=n.value;t(e.teamsById[a]),e.onChange(a)}),[]),s=(0,d.useSelector)(ce.k),u=Object.values(e.teamsById).map((e=>({value:e.id,label:e.display_name}))).sort(((e,n)=>e.label.localeCompare(n.label,s)));return o().createElement(de.A,{className:"team_selector",required:!0,onChange:l,value:n?{label:n.display_name,value:n.id}:void 0,options:u,legend:r({id:"sidebar_left.sidebar_channel_modal.select_team_placeholder",defaultMessage:"Select Team"}),placeholder:r({id:"sidebar_left.sidebar_channel_modal.select_team_placeholder",defaultMessage:"Select Team"}),name:"team_selector"})};ue.propTypes={onChange:r().func.isRequired};const me=ue,he=e=>{const n=(0,c.useIntl)();let t;return t=e.channelMemberNames.length>0?n.formatList(e.channelMemberNames):n.formatMessage({id:"sidebar_left.sidebar_channel_modal.warning_body_yourself",defaultMessage:"yourself"}),o().createElement(ie.A,{title:n.formatMessage({id:"sidebar_left.sidebar_channel_modal.warning_header",defaultMessage:"Conversation history will be visible to any channel members"}),text:n.formatMessage({id:"sidebar_left.sidebar_channel_modal.warning_body",defaultMessage:"You are about to convert the Group Message with {memberNames} to a Channel. This cannot be undone."},{memberNames:t})})};he.propTypes={channelMemberNames:r().arrayOf(r().string).isRequired};const ge=he;var pe=function(e){return e.CHANNEL_NAME_EXISTS="store.sql_channel.save_channel.exists.app_error",e}(pe||{});const Ee=e=>{const n=(0,c.useIntl)(),{formatMessage:t}=n,[a,r]=(0,i.useState)(""),l=(0,i.useRef)(""),[u,m]=(0,i.useState)(""),h=(0,i.useCallback)((e=>{l.current=e,m("")}),[]),[g,p]=(0,i.useState)([]);(0,i.useEffect)((()=>{const n=e.profilesInChannel.filter((n=>n.id!==e.currentUserId&&0===n.delete_at)).map((n=>(0,C.R4)(n,e.teammateNameDisplaySetting)));p(n)}),[e.profilesInChannel,e.currentUserId,e.teammateNameDisplaySetting]);const[E,b]=(0,i.useState)({}),[f,v]=(0,i.useState)(!1),[_,M]=(0,i.useState)(!1),[y,A]=(0,i.useState)(),[N,I]=(0,i.useState)(!1),[w,P]=(0,i.useState)(),T=(0,d.useDispatch)(),S=(0,i.useRef)(!1);(0,i.useEffect)((()=>(S.current=!0,()=>{S.current=!1})),[]),(0,i.useEffect)((()=>{(async()=>{const n=await T((0,ae.fr)(e.channel.id));if(!S.current)return;if(n.error||!n.data)return;const t=n.data,a={};t.forEach((e=>{a[e.id]=e})),b(a),v(!0),1===t.length&&A(t[0].id)})(),setTimeout((()=>M(!0)),1200)}),[T,e.channel.id]);const O=(0,i.useCallback)((async()=>{if(!y)return;const{error:n}=await e.actions.convertGroupMessageToPrivateChannel(e.channel.id,y,a.trim(),l.current.trim());n?n.server_error_id===pe.CHANNEL_NAME_EXISTS?m(t({id:"channel_modal.alreadyExist",defaultMessage:"A channel with that URL already exists"})):P(n.message):(P(void 0),(0,re.sx)("actions","convert_group_message_to_private_channel",{channel_id:e.channel.id}),e.onExited())}),[y,e,a,t]),k=!f||!_,x=void 0!==y&&""!==a&&!N&&!u,L={};let R;if(k||0!==Object.keys(E).length){let n;L.handleCancel=k?void 0:e.onExited,L.isDeleteModal=!0,L.cancelButtonText=t({id:"channel_modal.cancel",defaultMessage:"Cancel"}),L.confirmButtonText=t({id:"sidebar_left.sidebar_channel_modal.confirmation_text",defaultMessage:"Convert to private channel"}),L.isConfirmDisabled=!x,n=k?o().createElement("div",{className:"loadingIndicator"},o().createElement(se.A,null)):o().createElement(o().Fragment,null,o().createElement(ge,{channelMemberNames:g}),Object.keys(E).length>1&&o().createElement(me,{teamsById:E,onChange:A}),o().createElement(le.A,{value:a,name:"convert-gm-to-channel-modal-channel-name",placeholder:t({id:"sidebar_left.sidebar_channel_modal.channel_name_placeholder",defaultMessage:"Enter a name for the channel"}),autoFocus:!1,onDisplayNameChange:r,onURLChange:h,onErrorStateChange:I,team:y?E[y]:void 0,urlError:u}),w&&o().createElement("div",{className:"conversion-error"},o().createElement("i",{className:"icon icon-alert-outline"}),o().createElement("span",null,w))),R=o().createElement("div",{className:s()({"convert-gm-to-channel-modal-body":!0,loading:k,"single-team":1===Object.keys(E).length,"multi-team":Object.keys(E).length>1})},n)}else L.confirmButtonText=t({id:"generic.okay",defaultMessage:"Okay"}),L.handleConfirm=e.onExited,R=o().createElement("div",{className:"convert-gm-to-channel-modal-body error"},o().createElement(oe,null));return o().createElement(te.zW,Object.assign({id:"convert-gm-to-channel-modal",className:"convert-gm-to-channel-modal",modalHeaderText:t({id:"sidebar_left.sidebar_channel_modal.header",defaultMessage:"Convert to Private Channel"}),compassDesign:!0,handleConfirm:k?void 0:O,onExited:e.onExited,autoCloseOnConfirmButton:!1},L),R)};Ee.propTypes={onExited:r().func.isRequired,profilesInChannel:r().array.isRequired,teammateNameDisplaySetting:r().string.isRequired,currentUserId:r().string.isRequired};const be=Ee,fe=(0,d.connect)((function(){const e=(0,p.dH)();return(n,t)=>{const a=e(n,t.channel.id),r=(0,p.WR)(n);return{profilesInChannel:a,teammateNameDisplaySetting:(0,ee.K3)(n),currentUserId:r}}}),(function(e){return{actions:(0,Z.bindActionCreators)({closeModal:k.O,convertGroupMessageToPrivateChannel:D.jr,moveChannelsInSidebar:ne.nh},e)}}))(be),ve=e=>{let{channel:n}=e;const t=(0,d.useDispatch)();return o().createElement(f.q7,{id:"convertGMPrivateChannel",onClick:()=>{t((0,k.q)({modalId:v.IQ.CONVERT_GM_TO_CHANNEL,dialogType:fe,dialogProps:{channel:n}}))},labels:o().createElement(c.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu_convert_to_channel",defaultMessage:"Convert to Private Channel"})})},_e=o().memo(ve);var Ce=t(64109);const Me=["channel","user"],ye=e=>{let{channel:n,user:t}=e,a=function(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(n.includes(a))continue;t[a]=e[a]}return t}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}(e,Me);const r=(0,d.useDispatch)();return o().createElement(f.q7,Object.assign({leadingElement:o().createElement(_.BellOutlineIcon,{size:"18px"}),id:"channelNotificationPreferences",onClick:()=>{r((0,k.q)({modalId:v.IQ.CHANNEL_NOTIFICATIONS,dialogType:Ce.A,dialogProps:{channel:n,currentUser:t}}))},labels:o().createElement(c.FormattedMessage,{id:"navbar.preferences",defaultMessage:"Notification Preferences"})},a))},Ae=o().memo(ye),Ne=e=>{let{id:n,channel:t,text:a,editMembers:r=!1}=e;const l=(0,d.useDispatch)();let s=(0,d.useSelector)(G.A);return(0,d.useSelector)(G.bM)!==v._n.CHANNEL_MEMBERS&&(s=!1),o().createElement(f.q7,{leadingElement:o().createElement(_.AccountOutlineIcon,{size:16}),id:n,onClick:()=>{s||l((0,j.sQ)(t.id,r))},labels:a})};Ne.propTypes={id:r().string.isRequired,editMembers:r().bool,text:r().element.isRequired};const Ie=Ne,we=["channel","user","isMuted","isMobile","isFavorite","pluginItems","isChannelBookmarksEnabled"],Pe=e=>{let{channel:n,user:t,isMuted:a,isMobile:r,isFavorite:l,pluginItems:s,isChannelBookmarksEnabled:i}=e,d=function(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(n.includes(a))continue;t[a]=e[a]}return t}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}(e,we);const u=!0===(null==n?void 0:n.group_constrained),m=0!==n.delete_at,{formatMessage:h}=(0,c.useIntl)();return o().createElement(o().Fragment,null,o().createElement(U,Object.assign({channel:n},d)),o().createElement(z,{userID:t.id,channel:n,isMuted:a}),r&&o().createElement(o().Fragment,null,o().createElement(B,{channelID:n.id,isFavorite:l}),o().createElement(Y,{channelID:n.id})),!m&&o().createElement(Ae,{user:t,channel:n}),!m&&(0,C.P)(t.roles)&&o().createElement(R,{leadingElement:o().createElement(_.CogOutlineIcon,{size:"18px"}),channel:n}),!m&&!u&&!(0,C.P)(t.roles)&&o().createElement(f.g8,{id:"channelSettings",labels:o().createElement(c.FormattedMessage,{id:"channel_header.settings",defaultMessage:"Settings"}),leadingElement:o().createElement(_.CogOutlineIcon,{size:18}),trailingElements:o().createElement(_.ChevronRightIcon,{size:16}),menuId:"channelSettings-menu",menuAriaLabel:h({id:"channel_header.settings",defaultMessage:"Settings"})},o().createElement(R,{channel:n}),o().createElement(_e,{channel:n})),!m&&!(0,C.P)(t.roles)&&i&&o().createElement(I,{channel:n}),o().createElement(f.wv,null),!m&&!u&&o().createElement($.A,{channelId:n.id,teamId:n.team_id,permissions:[J.xB.MANAGE_PUBLIC_CHANNEL_MEMBERS]},o().createElement(Ie,{id:"channelMembers",channel:n,text:o().createElement(c.FormattedMessage,{id:"channel_header.members",defaultMessage:"Members"})}),o().createElement(f.wv,null)),o().createElement(M.A,{channel:n}),!r&&o().createElement(H,{pluginItems:s}),o().createElement(f.wv,null),o().createElement(O,{currentUserID:t.id,channel:n}))};Pe.propTypes={isMuted:r().bool.isRequired,isMobile:r().bool.isRequired,isFavorite:r().bool.isRequired,pluginItems:r().arrayOf(r().node).isRequired,isChannelBookmarksEnabled:r().bool.isRequired};const Te=Pe;var Se=t(27039);const Oe=e=>e.isMobile?o().createElement(o().Fragment,null,o().createElement(Se.A,{channel:e.channel,isDropdown:!0}),o().createElement(f.wv,null),e.pluginItems):o().createElement(o().Fragment,null);Oe.propTypes={isMobile:r().bool.isRequired,pluginItems:r().arrayOf(r().node).isRequired};const ke=(0,i.memo)(Oe);var xe=t(35664),Le=(t(4290),t(34529));function Re(e,n,t){return(n=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}class Fe extends o().PureComponent{constructor(e){super(e),Re(this,"handleDelete",(()=>{if(this.props.channel.id.length===v.Ay.CHANNEL_ID_LENGTH){if(!this.props.canViewArchivedChannels){const{penultimateViewedChannelName:e}=this.props;this.props.currentTeamDetails&&(0,S.J)().push("/"+this.props.currentTeamDetails.name+"/channels/"+e)}this.props.actions.deleteChannel(this.props.channel.id),this.onHide()}})),Re(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!0}}render(){const{canViewArchivedChannels:e}=this.props;return o().createElement(Le.Modal,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onExited,role:"none","aria-labelledby":"deleteChannelModalLabel",id:"deleteChannelModal"},o().createElement(Le.Modal.Header,{closeButton:!0},o().createElement(Le.Modal.Title,{componentClass:"h1",id:"deleteChannelModalLabel"},o().createElement(c.FormattedMessage,{id:"delete_channel.confirm",defaultMessage:"Confirm ARCHIVE Channel"}))),o().createElement(Le.Modal.Body,null,o().createElement("div",{className:"alert alert-danger"},!e&&o().createElement(o().Fragment,null,o().createElement("p",null,o().createElement(c.FormattedMessage,{id:"deleteChannelModal.cannotViewArchivedChannelsWarning",defaultMessage:"This will archive the channel from the team and remove it from the user interface. Archived channels can be unarchived if needed again."})),o().createElement("p",null,o().createElement(c.FormattedMessage,{id:"deleteChannelModal.confirmArchive",defaultMessage:"Are you sure you wish to archive the <strong>{display_name}</strong> channel?",values:{display_name:this.props.channel.display_name,strong:e=>o().createElement("strong",null,e)}}))),e&&o().createElement(o().Fragment,null,o().createElement("p",null,o().createElement(c.FormattedMessage,{id:"deleteChannelModal.canViewArchivedChannelsWarning",defaultMessage:"This will archive the channel from the team. Channel contents will still be accessible by channel members."})),o().createElement("p",null,o().createElement(c.FormattedMessage,{id:"deleteChannelModal.confirmArchive",defaultMessage:"Are you sure you wish to archive the <strong>{display_name}</strong> channel?",values:{display_name:this.props.channel.display_name,strong:e=>o().createElement("strong",null,e)}}))))),o().createElement(Le.Modal.Footer,null,o().createElement("button",{type:"button",className:"btn btn-tertiary",onClick:this.onHide},o().createElement(c.FormattedMessage,{id:"delete_channel.cancel",defaultMessage:"Cancel"})),o().createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",onClick:this.handleDelete,autoFocus:!0,id:"deleteChannelModalDeleteButton"},o().createElement(c.FormattedMessage,{id:"delete_channel.del",defaultMessage:"Archive"}))))}}Re(Fe,"propTypes",{onExited:r().func.isRequired,currentTeamDetails:r().shape({name:r().string.isRequired}),canViewArchivedChannels:r().bool,penultimateViewedChannelName:r().string.isRequired,actions:r().shape({deleteChannel:r().func.isRequired}).isRequired});const He=(0,d.connect)((function(e){return{canViewArchivedChannels:"true"===(0,g.zj)(e).ExperimentalViewArchivedChannels,currentTeamDetails:(0,P.H7)(e)}}),(function(e){return{actions:(0,Z.bindActionCreators)({deleteChannel:T.D3},e)}}))(Fe),De=e=>{let{channel:n}=e;const t=(0,d.useDispatch)(),a=(0,d.useSelector)(h.UX),r=(0,d.useSelector)(xe.XU)||a;return o().createElement(f.q7,{id:"channelArchiveChannel",leadingElement:o().createElement(_.ArchiveOutlineIcon,{size:18}),onClick:()=>{t((0,k.q)({modalId:v.IQ.DELETE_CHANNEL,dialogType:He,dialogProps:{channel:n,penultimateViewedChannelName:r}}))},labels:o().createElement(c.FormattedMessage,{id:"channel_header.delete",defaultMessage:"Archive Channel"}),isDestructive:!0})},qe=(0,i.memo)(De);var Be=t(16983),je=t(78625),Ge=t(80635),Ve=t(67347),Ue=t(30138),ze=t(17461);function We(e){let{channel:n,onHide:t}=e;const{formatMessage:a}=(0,c.useIntl)(),r=(0,d.useDispatch)(),l=(0,d.useSelector)((e=>"true"===(0,g.zj)(e).ExperimentalViewArchivedChannels)),[s,u]=(0,i.useState)(!1),m=(0,i.useCallback)((()=>{u(!0)}),[]);return o().createElement("div",{className:"ChannelSettingsModal__archiveTab"},o().createElement(c.FormattedMessage,{id:"channel_settings.archive.warning",defaultMessage:"Archiving a channel removes it from the user interface, but doesn't permanently delete the channel. New messages can't be posted to archived channels."}),o().createElement("button",{type:"button",className:"btn btn-danger",onClick:m,id:"channelSettingsArchiveChannelButton","aria-label":"Archive channel ".concat(n.display_name)},o().createElement(c.FormattedMessage,{id:"channel_settings.archive.button",defaultMessage:"Archive this channel"})),s&&o().createElement(ze.A,{id:"archiveChannelConfirmModal",show:!0,title:a({id:"channel_settings.modal.archiveTitle",defaultMessage:"Archive channel?"}),message:o().createElement("div",null,o().createElement("p",null,o().createElement(c.FormattedMessage,{id:l?"deleteChannelModal.canViewArchivedChannelsWarning":"deleteChannelModal.cannotViewArchivedChannelsWarning",defaultMessage:"Archiving a channel removes it from the user interface, but doesn't permanently delete the channel. New messages can't be posted to archived channels."})),o().createElement("p",null,o().createElement(c.FormattedMessage,{id:"deleteChannelModal.confirmArchive",defaultMessage:"Are you sure you wish to archive the <strong>{display_name}</strong> channel?",values:{display_name:n.display_name,strong:e=>o().createElement("strong",null,e)}}))),confirmButtonText:a({id:"channel_settings.modal.confirmArchive",defaultMessage:"Confirm"}),onConfirm:async()=>{await r((0,T.D3)(n.id)),t()},onCancel:()=>u(!1),confirmButtonClass:"btn btn-danger",modalClass:"archiveChannelConfirmModal",focusOriginElement:"channelSettingsArchiveChannelButton"}))}We.propTypes={onHide:r().func.isRequired};const Ye=We;var Ke=t(61295),Xe=t(79407),Qe=t(70087),Je=t(88100);const $e=e=>{let{id:n,value:t,channelId:a,onChange:r,onKeyPress:l,createMessage:d,maxLength:u,minLength:m,minLengthErrorMessage:h,preview:g,togglePreview:p,useChannelMentions:E=!1,descriptionMessage:b,hasError:f,errorMessage:v,onValidate:_,showCharacterCount:C=!1,readOnly:M=!1,name:y}=e;const{formatMessage:A}=(0,c.useIntl)(),[N,I]=(0,i.useState)(v),[w,P]=(0,i.useState)(!1),T=t.length>u,S=void 0!==m&&t.length>0&&t.length<m;(0,i.useEffect)((()=>{I(v||(T?A({id:"advanced_textbox.max_length_error",defaultMessage:"Text exceeds the maximum character limit of {maxLength} characters."},{maxLength:u}):S?h||A({id:"advanced_textbox.min_length_error",defaultMessage:"Text must be at least {minLength} characters."},{minLength:m}):void 0))}),[v,T,S,u,m,h,A]);let O=g;return M&&(O=!0),o().createElement("div",{className:"AdvancedTextbox"},o().createElement("div",{className:"AdvancedTextbox__wrapper"},y&&o().createElement("div",{className:"AdvancedTextbox__label ".concat(t||w?"AdvancedTextbox__label--active":""," ").concat(w?"AdvancedTextbox__label--focused":""," ").concat(f||N?"AdvancedTextbox__label--error":"")},y),o().createElement(Je.Ay,{value:t,onChange:e=>{const n=e.target.value;if(_){const e=_(n);!1===e.isValid?I(e.errorMessage):I(void 0)}r(e)},onKeyPress:l,supportsCommands:!1,suggestionListPosition:"bottom",createMessage:d,channelId:a,id:n,characterLimit:u,preview:O,useChannelMentions:E,hasError:f,onFocus:()=>{P(!0)},onBlur:()=>{P(!1)},disabled:M})),!M&&t.trim().length>0&&o().createElement(Qe.A,{onClick:p,active:g}),o().createElement("div",{className:"AdvancedTextbox__error-wrapper"},N&&o().createElement("div",{className:"AdvancedTextbox__error-message"},o().createElement("i",{className:"icon icon-alert-circle-outline"}),o().createElement("span",null,N)),C&&(T||S||N)&&o().createElement("div",{className:s()("AdvancedTextbox__character-count",{"exceeds-limit":T,"below-minimum":S})},t.length,"/",S?m:u)),b&&!N&&o().createElement("p",{"data-testid":"AdvancedTextbox__description",className:"AdvancedTextbox__description"},b))};$e.propTypes={id:r().string.isRequired,value:r().string.isRequired,channelId:r().string.isRequired,onChange:r().func.isRequired,onKeyPress:r().func.isRequired,createMessage:r().string.isRequired,maxLength:r().number.isRequired,minLength:r().number,minLengthErrorMessage:r().string,preview:r().bool.isRequired,togglePreview:r().func.isRequired,useChannelMentions:r().bool,descriptionMessage:r().oneOfType([r().element,r().string]),hasError:r().bool,errorMessage:r().oneOfType([r().string,r().element]),onValidate:r().func,showCharacterCount:r().bool,readOnly:r().bool,name:r().string};const Ze=$e;var en=t(66215);function nn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function tn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?nn(Object(t),!0).forEach((function(n){an(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function an(e,n,t){return(n=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}const rn={enabled:!1,background_color:"#DDDDDD",text:""};function ln(e){let{channel:n,setAreThereUnsavedChanges:t,showTabSwitchError:a}=e;const{formatMessage:r}=(0,c.useIntl)(),l=(0,d.useDispatch)(),s=r({id:"channel_banner.label.name",defaultMessage:"Channel Banner"}),u=r({id:"channel_banner.label.subtext",defaultMessage:"When enabled, a customized banner will display at the top of the channel."}),m=r({id:"channel_banner.banner_text.label",defaultMessage:"Banner text"}),h=r({id:"channel_banner.banner_color.label",defaultMessage:"Banner color"}),g=r({id:"channel_banner.banner_text.placeholder",defaultMessage:"Channel banner text"}),p=n.banner_info||rn,[E,b]=(0,i.useState)(""),[f,v]=(0,i.useState)(!1),[_,C]=(0,i.useState)(p),[M,y]=(0,i.useState)(!1),[A,N]=(0,i.useState)(!1),[I,w]=(0,i.useState)(),P=(0,i.useCallback)((()=>{const e=!_.enabled,n=tn(tn({},_),{},{enabled:e});e||(n.text=p.text,n.background_color=p.background_color),C(n)}),[p,_]),T=(0,i.useCallback)((()=>{b(""),w(void 0)}),[]),S=(0,i.useCallback)((e=>{const n=e.target.value;C((e=>tn(tn({},e),{},{text:n}))),n.trim().length>1024?(b(r({id:"channel_settings.save_changes_panel.standard_error",defaultMessage:"There are errors in the form above"})),N(!0)):n.trim().length<=0?(b(r({id:"channel_settings.save_changes_panel.banner_text.required_error",defaultMessage:"Channel banner text cannot be empty when enabled"})),N(!0)):(T(),N(!1))}),[r,T]),O=(0,i.useCallback)((e=>{C((n=>tn(tn({},n),{},{background_color:e}))),e.trim()&&T()}),[T]),k=(0,i.useCallback)((()=>v((e=>!e))),[]),x=(0,i.useCallback)((()=>{var e,n,t,a;return((null===(e=_.text)||void 0===e?void 0:e.trim())||"")!==((null==p||null===(n=p.text)||void 0===n?void 0:n.trim())||"")||((null===(t=_.background_color)||void 0===t?void 0:t.trim())||"")!==((null==p||null===(a=p.background_color)||void 0===a?void 0:a.trim())||"")||_.enabled!==(null==p?void 0:p.enabled)}),[p,_]);(0,i.useEffect)((()=>{const e=x();y(e),null==t||t(e)}),[x,t]);const L=(0,i.useCallback)((e=>{const n=e.message||r({id:"channel_settings.unknown_error",defaultMessage:"Something went wrong."});b(n)}),[r]),R=(0,i.useCallback)((async()=>{var e,t,a,s;if(!n)return!1;if(_.enabled&&(null===(e=_.text)||void 0===e||!e.trim()))return b(r({id:"channel_settings.error_banner_text_required",defaultMessage:"Banner text is required"})),!1;if(_.enabled&&(null===(t=_.background_color)||void 0===t||!t.trim()))return b(r({id:"channel_settings.error_banner_color_required",defaultMessage:"Banner color is required"})),!1;const i=tn({},n);i.banner_info={text:(null===(a=_.text)||void 0===a?void 0:a.trim())||"",background_color:(null===(s=_.background_color)||void 0===s?void 0:s.trim())||"",enabled:_.enabled};const{error:o}=await l((0,D.ER)(n.id,i));return!o||(L(o),!1)}),[n,l,r,L,_]),F=(0,i.useCallback)((async()=>{await R()?(C((e=>{var n,t;return tn(tn({},e),{},{text:(null===(n=e.text)||void 0===n?void 0:n.trim())||"",background_color:(null===(t=e.background_color)||void 0===t?void 0:t.trim())||""})})),T(),w("saved")):w("error")}),[R,T]),H=(0,i.useCallback)((()=>{y(!1),w(void 0),v(!1),C(p),b(""),w(void 0),N(!1)}),[p]),q=(0,i.useCallback)((()=>{w(void 0),y(!1)}),[]),B=Boolean(E)||A||a,j=M||"saved"===I;return o().createElement("div",{className:"ChannelSettingsModal__configurationTab"},o().createElement("div",{className:"channel_banner_header"},o().createElement("div",{className:"channel_banner_header__text"},o().createElement("label",{className:"Input_legend","aria-label":s},s),o().createElement("label",{className:"Input_subheading","aria-label":s},u)),o().createElement("div",{className:"channel_banner_header__toggle"},o().createElement(Xe.A,{id:"channelBannerToggle",ariaLabel:s,size:"btn-md",disabled:!1,onToggle:P,toggled:_.enabled,tabIndex:0,toggleClassName:"btn-toggle-primary"}))),_.enabled&&o().createElement("div",{className:"channel_banner_section_body"},o().createElement("div",{className:"setting_section"},o().createElement("span",{className:"setting_title","aria-label":m},m),o().createElement("div",{className:"setting_body"},o().createElement(Ze,{id:"channel_banner_banner_text_textbox",value:_.text,channelId:n.id,onKeyPress:()=>{},showCharacterCount:!0,useChannelMentions:!1,onChange:S,preview:f,togglePreview:k,hasError:A,createMessage:g,maxLength:1024,minLength:0}))),o().createElement("div",{className:"setting_section"},o().createElement("span",{className:"setting_title","aria-label":h},h),o().createElement("div",{className:"setting_body"},o().createElement(Ke.A,{id:"channel_banner_banner_background_color_picker",onChange:O,value:_.background_color||""})))),j&&o().createElement(en.A,{handleSubmit:F,handleCancel:H,handleClose:q,tabChangeError:B,state:B?"error":I,customErrorMessage:E,cancelButtonText:r({id:"channel_settings.save_changes_panel.reset",defaultMessage:"Reset"})}))}ln.propTypes={setAreThereUnsavedChanges:r().func,showTabSwitchError:r().bool};const sn=ln;var on=t(50880),cn=t(45495),dn=t(46911);function un(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function mn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?un(Object(t),!0).forEach((function(n){hn(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):un(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function hn(e,n,t){return(n=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function gn(e){var n,t,a,r,l;let{channel:s,onCancel:u,setAreThereUnsavedChanges:m,showTabSwitchError:h}=e;const{formatMessage:g}=(0,c.useIntl)(),p=(0,d.useDispatch)(),E=(0,d.useSelector)(on.My),b=(0,d.useSelector)(on.dm),f=(0,d.useSelector)((e=>(0,Ge.Ec)(e,s.team_id,s.id,Be.A.CONVERT_PUBLIC_CHANNEL_TO_PRIVATE))),_=(0,d.useSelector)((e=>(0,Ge.Ec)(e,s.team_id,s.id,Be.A.CONVERT_PRIVATE_CHANNEL_TO_PUBLIC))),C=s.type===v.Ay.PRIVATE_CHANNEL?Be.A.MANAGE_PRIVATE_CHANNEL_PROPERTIES:Be.A.MANAGE_PUBLIC_CHANNEL_PROPERTIES,M=(0,d.useSelector)((e=>(0,Ge.Ec)(e,s.team_id,s.id,C))),y=1024,[A,N]=(0,i.useState)(""),[I,w]=(0,i.useState)(""),[P,T]=(0,i.useState)(!1),[S,O]=(0,i.useState)(!1),[k,x]=(0,i.useState)(null!==(n=null==s?void 0:s.display_name)&&void 0!==n?n:""),[L,R]=(0,i.useState)(null!==(t=null==s?void 0:s.name)&&void 0!==t?t:""),[F,H]=(0,i.useState)(null!==(a=s.purpose)&&void 0!==a?a:""),[q,B]=(0,i.useState)(null!==(r=null==s?void 0:s.header)&&void 0!==r?r:""),[j,G]=(0,i.useState)(null!==(l=null==s?void 0:s.type)&&void 0!==l?l:v.Ay.OPEN_CHANNEL),[V,U]=(0,i.useState)(""),[z,W]=(0,i.useState)(),Y=(0,i.useCallback)(((e,n)=>{w(n||""),e&&n?U(n):V===I&&U("")}),[I,V,U]);(0,i.useEffect)((()=>{const e=!!s&&(k.trim()!==s.display_name||L.trim()!==s.name||F.trim()!==s.purpose||q.trim()!==s.header||j!==s.type);null==m||m(e)}),[s,k,L,F,q,j,m]);const K=(0,i.useCallback)((e=>{A&&(U(""),W(void 0),N("")),R(e.trim())}),[A]),X=(0,i.useCallback)((()=>{p((0,Ve.oL)(!E))}),[p,E]),Q=(0,i.useCallback)((()=>{p((0,Ve.tR)(!b))}),[p,b]),$=(0,i.useCallback)((e=>{const n=e.target.value;B(n),n.trim().length>y?U(g({id:"edit_channel_header_modal.error",defaultMessage:"The text entered exceeds the character limit. The channel header is limited to {maxLength} characters."},{maxLength:y})):V&&!I&&U("")}),[y,V,I,U,g]),Z=(0,i.useCallback)((e=>{const n=e.target.value;H(n),n.trim().length>v.Ay.MAX_CHANNELPURPOSE_LENGTH?U(g({id:"channel_settings.error_purpose_length",defaultMessage:"The text entered exceeds the character limit. The channel purpose is limited to {maxLength} characters."},{maxLength:v.Ay.MAX_CHANNELPURPOSE_LENGTH})):V&&!I&&U("")}),[V,I,U,g]),ee=e=>{const n=e.message||g({id:"channel_settings.unknown_error",defaultMessage:"Something went wrong."});U(n),W("error"),e.message&&(e.message.toLowerCase().includes("url")||e.message.toLowerCase().includes("name")||e.message.toLowerCase().includes("already exists"))&&N(n)},ne=(0,i.useCallback)((async()=>{if(!s)return!1;if(!k.trim())return U(g({id:"channel_settings.error_display_name_required",defaultMessage:"Channel name is required"})),!1;if(s.type===v.Ay.OPEN_CHANNEL&&j===v.Ay.PRIVATE_CHANNEL){const{error:e}=await p((0,D.nr)(s.id,J.Bz.PRIVATE_CHANNEL));if(e)return ee(e),!1}const e=mn(mn({},s),{},{display_name:k.trim(),name:L.trim(),purpose:F.trim(),header:q.trim()}),{error:n}=await p((0,D.ER)(s.id,e));return n?(ee(n),!1):(x(e.display_name),R(e.name),H(e.purpose),B(e.header),!0)}),[s,k,L,F,q,j,U,ee]),te=(0,i.useCallback)((async()=>{s.type!==v.Ay.OPEN_CHANNEL||j!==v.Ay.PRIVATE_CHANNEL?await ne()?W("saved"):W("error"):O(!0)}),[s,j,ne]),ae=(0,i.useCallback)((()=>{W(void 0)}),[]),re=(0,i.useCallback)((()=>{O(!1)}),[]),se=(0,i.useCallback)((()=>{var e,n,t,a,r;W(void 0),x(null!==(e=null==s?void 0:s.display_name)&&void 0!==e?e:""),R(null!==(n=null==s?void 0:s.name)&&void 0!==n?n:""),H(null!==(t=null==s?void 0:s.purpose)&&void 0!==t?t:""),B(null!==(a=null==s?void 0:s.header)&&void 0!==a?a:""),G(null!==(r=null==s?void 0:s.type)&&void 0!==r?r:v.Ay.OPEN_CHANNEL),N(""),U(""),T(!1),w(""),u&&u()}),[s,u,U]),ie=Boolean(V)||P||Boolean(I)||Boolean(h)||Boolean(A),oe=(0,i.useMemo)((()=>!!s&&(k.trim()!==s.display_name||L.trim()!==s.name||F.trim()!==s.purpose||q.trim()!==s.header||j!==s.type)||"saved"===z),[s,k,L,F,q,j,z]);return o().createElement("div",{className:"ChannelSettingsModal__infoTab"},o().createElement(cn.A,{show:S,onCancel:re,onConfirm:async()=>{re(),await ne()?W("saved"):W("error")},displayName:(null==s?void 0:s.display_name)||"",toPublic:!1}),o().createElement("label",{htmlFor:"input_channel-settings-name",className:"Input_legend"},g({id:"channel_settings.label.name",defaultMessage:"Channel Name"})),o().createElement(le.A,{value:k,name:"channel-settings-name",placeholder:g({id:"channel_settings_modal.name.placeholder",defaultMessage:"Enter a name for your channel"}),onDisplayNameChange:e=>{x(e)},onURLChange:K,onErrorStateChange:Y,urlError:A,currentUrl:L,readOnly:!M}),o().createElement(dn.A,{className:"ChannelSettingsModal__typeSelector",selected:j,publicButtonProps:{title:g({id:"channel_modal.type.public.title",defaultMessage:"Public Channel"}),description:g({id:"channel_modal.type.public.description",defaultMessage:"Anyone can join"}),disabled:s.type===v.Ay.PRIVATE_CHANNEL||!_},privateButtonProps:{title:g({id:"channel_modal.type.private.title",defaultMessage:"Private Channel"}),description:g({id:"channel_modal.type.private.description",defaultMessage:"Only invited members"}),disabled:!f},onChange:e=>{s.type===v.Ay.PRIVATE_CHANNEL&&e===v.Ay.OPEN_CHANNEL||(s.type!==v.Ay.OPEN_CHANNEL||e!==v.Ay.PRIVATE_CHANNEL||f)&&(G(e),U(""))}}),o().createElement(Ze,{id:"channel_settings_purpose_textbox",value:F,channelId:s.id,onChange:Z,createMessage:g({id:"channel_settings_modal.purpose.placeholder",defaultMessage:"Enter a purpose for this channel"}),maxLength:v.Ay.MAX_CHANNELPURPOSE_LENGTH,preview:E,togglePreview:X,useChannelMentions:!1,onKeyPress:()=>{},descriptionMessage:g({id:"channel_settings.purpose.description",defaultMessage:"Describe how this channel should be used."}),hasError:F.length>v.Ay.MAX_CHANNELPURPOSE_LENGTH,errorMessage:F.length>v.Ay.MAX_CHANNELPURPOSE_LENGTH?g({id:"channel_settings.error_purpose_length",defaultMessage:"The channel purpose exceeds the maximum character limit of {maxLength} characters."},{maxLength:v.Ay.MAX_CHANNELPURPOSE_LENGTH}):void 0,showCharacterCount:F.length>v.Ay.MAX_CHANNELPURPOSE_LENGTH,readOnly:!M,name:g({id:"channel_settings.purpose.label",defaultMessage:"Channel Purpose"})}),o().createElement(Ze,{id:"channel_settings_header_textbox",value:q,channelId:s.id,onChange:$,createMessage:g({id:"channel_settings_modal.header.placeholder",defaultMessage:"Enter a header description or important links"}),maxLength:y,preview:b,togglePreview:Q,useChannelMentions:!1,onKeyPress:()=>{},descriptionMessage:g({id:"channel_settings.purpose.header",defaultMessage:"This is the text that will appear in the header of the channel beside the channel name. You can use markdown to include links by typing [Link Title](http://example.com)."}),hasError:q.length>y,errorMessage:q.length>y?g({id:"edit_channel_header_modal.error",defaultMessage:"The channel header exceeds the maximum character limit of {maxLength} characters."},{maxLength:y}):void 0,showCharacterCount:q.length>y,readOnly:!M,name:g({id:"channel_settings.header.label",defaultMessage:"Channel Header"})}),M&&oe&&o().createElement(en.A,Object.assign({handleSubmit:te,handleCancel:se,handleClose:ae,tabChangeError:ie,state:ie?"error":z},!h&&{customErrorMessage:g({id:"channel_settings.save_changes_panel.standard_error",defaultMessage:"There are errors in the form above"})},{cancelButtonText:g({id:"channel_settings.save_changes_panel.reset",defaultMessage:"Reset"})})))}gn.propTypes={onCancel:r().func,setAreThereUnsavedChanges:r().func,showTabSwitchError:r().bool};const pn=gn,En=o().lazy((()=>t.e(9163).then(t.bind(t,61544))));var bn=function(e){return e.INFO="info",e.CONFIGURATION="configuration",e.ARCHIVE="archive",e}(bn||{});function fn(e){let{channelId:n,isOpen:t,onExited:a,focusOriginElement:r}=e;const{formatMessage:l}=(0,c.useIntl)(),s=(0,d.useDispatch)(),u=(0,d.useSelector)((e=>(0,h.c)(e,n))),m=(0,d.useSelector)(je.l),g=(0,d.useSelector)((e=>(0,Ge.Ec)(e,u.team_id,u.id,Be.A.MANAGE_PUBLIC_CHANNEL_BANNER))),p=(0,d.useSelector)((e=>(0,Ge.Ec)(e,u.team_id,u.id,Be.A.MANAGE_PRIVATE_CHANNEL_BANNER))),E="O"===u.type&&g||"P"===u.type&&p,b=m&&E,f=(0,d.useSelector)((e=>(0,Ge.Ec)(e,u.team_id,u.id,Be.A.DELETE_PRIVATE_CHANNEL))),_=(0,d.useSelector)((e=>(0,Ge.Ec)(e,u.team_id,u.id,Be.A.DELETE_PUBLIC_CHANNEL))),[C,M]=(0,i.useState)(t),[y,A]=(0,i.useState)(bn.INFO),[N,I]=(0,i.useState)(!1),[w,P]=(0,i.useState)(!1),T=(0,i.useRef)(null),S=()=>{s((0,Ve.tR)(!1)),s((0,Ve.oL)(!1)),M(!1)},O=()=>o().createElement(pn,{channel:u,setAreThereUnsavedChanges:P,showTabSwitchError:N}),k=[{name:bn.INFO,uiName:l({id:"channel_settings.tab.info",defaultMessage:"Info"}),icon:"icon icon-information-outline",iconTitle:l({id:"generic_icons.info",defaultMessage:"Info Icon"})},{name:bn.CONFIGURATION,uiName:l({id:"channel_settings.tab.configuration",defaultMessage:"Configuration"}),icon:"icon icon-cog-outline",iconTitle:l({id:"generic_icons.settings",defaultMessage:"Settings Icon"}),display:b},{name:bn.ARCHIVE,uiName:l({id:"channel_settings.tab.archive",defaultMessage:"Archive Channel"}),icon:"icon icon-archive-outline",iconTitle:l({id:"generic_icons.archive",defaultMessage:"Archive Icon"}),newGroup:!0,display:u.name!==v.Ay.DEFAULT_CHANNEL&&(u.type===v.Ay.PRIVATE_CHANNEL&&f||u.type===v.Ay.OPEN_CHANNEL&&_)}],x=l({id:"channel_settings.modal.title",defaultMessage:"Channel Settings"});return o().createElement(te.zW,{id:"channelSettingsModal",ariaLabel:x,className:"ChannelSettingsModal settings-modal",show:C,onHide:()=>{S()},onExited:()=>{A(bn.INFO),r&&(0,Ue.p)(r,!0),a()},compassDesign:!0,modalHeaderText:x,bodyPadding:!1,modalLocation:"top"},o().createElement("div",{className:"ChannelSettingsModal__bodyWrapper"},o().createElement("div",{ref:T,className:"settings-table"},o().createElement("div",{className:"settings-links"},o().createElement(o().Suspense,{fallback:null},o().createElement(En,{tabs:k,activeTab:y,updateTab:e=>{if(w)return I(!0),void setTimeout((()=>{I(!1)}),3e3);A(e),T.current&&(T.current.scrollTop=0)}}))),o().createElement("div",{className:"settings-content minimize-settings"},(()=>{switch(y){case bn.INFO:return O();case bn.CONFIGURATION:return o().createElement(sn,{channel:u,setAreThereUnsavedChanges:P,showTabSwitchError:N});case bn.ARCHIVE:return o().createElement(Ye,{channel:u,onHide:S});default:return O()}})()))))}fn.propTypes={channelId:r().string.isRequired,onExited:r().func.isRequired,isOpen:r().bool.isRequired,focusOriginElement:r().string};const vn=fn,_n=e=>{let{channel:n}=e;const t=(0,d.useDispatch)();return o().createElement(f.q7,{id:"channelSettings",labels:o().createElement(c.FormattedMessage,{id:"channel_header.channel_settings",defaultMessage:"Channel Settings"}),onClick:()=>{t((0,k.q)({modalId:v.IQ.CHANNEL_SETTINGS,dialogType:vn,dialogProps:{channelId:n.id,focusOriginElement:"channelHeaderDropdownButton",isOpen:!0}}))},leadingElement:o().createElement(_.CogOutlineIcon,{size:18})})},Cn=(0,i.memo)(_n),Mn=e=>{let n=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return o().createElement(f.q7,Object.assign({onClick:T.TJ,labels:o().createElement(c.FormattedMessage,{id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"})},n))},yn=o().memo(Mn);var An=t(40142),Nn=t(87373),In=t(48774),wn=t(1277),Pn=t(24163),Tn=t(17983),Sn=t(99068),On=t(83873),kn=t(85873);function xn(e,n,t){return(n=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}class Ln extends o().PureComponent{constructor(){super(...arguments),xn(this,"loadItems",(async(e,n)=>{const{data:t}=await this.props.actions.getGroupsAssociatedToChannel(this.props.channel.id,n,e,wn.$);return{items:t.groups,totalCount:t.totalGroupCount}})),xn(this,"onClickRemoveGroup",((e,n)=>this.props.actions.unlinkGroupSyncable(e.id,this.props.channel.id,In.CL.Channel).then((async()=>{n.setState({loading:!0});const{items:e,totalCount:t}=await n.props.loadItems(n.setState.page,n.state.searchTerm);n.setState({loading:!1,items:e,totalCount:t})})))),xn(this,"onHide",(()=>{this.props.actions.closeModal(v.IQ.MANAGE_CHANNEL_GROUPS)})),xn(this,"titleButtonOnClick",(()=>{this.onHide(),this.props.actions.openModal({modalId:v.IQ.ADD_GROUPS_TO_TEAM,dialogType:An.A})})),xn(this,"setChannelMemberStatus",(async(e,n,t)=>{this.props.actions.patchGroupSyncable(e.id,this.props.channel.id,In.CL.Channel,{scheme_admin:t}).then((async()=>{n.setState({loading:!0});const{items:e,totalCount:t}=await n.props.loadItems(n.setState.page,n.state.searchTerm);await this.props.actions.getMyChannelMember(this.props.channel.id),n.setState({loading:!1,items:e,totalCount:t})}))})),xn(this,"renderRow",((e,n)=>{let t;return t=e.scheme_admin?o().createElement(c.FormattedMessage,{id:"channel_members_dropdown.channel_admins",defaultMessage:"Channel Admins"}):o().createElement(c.FormattedMessage,{id:"channel_members_dropdown.channel_members",defaultMessage:"Channel Members"}),o().createElement("div",{key:e.id,className:"more-modal__row"},o().createElement("img",{className:"more-modal__image",src:On,alt:"group picture",width:"32",height:"32"}),o().createElement("div",{className:"more-modal__details"},o().createElement("div",{className:"more-modal__name"},e.display_name," ","-"," ",o().createElement("span",{className:"more-modal__name_count"},o().createElement(c.FormattedMessage,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),o().createElement("div",{className:"more-modal__actions"},o().createElement(Sn.A,null,o().createElement("button",{id:"teamGroupsDropdown_".concat(e.display_name),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true"},o().createElement("span",null,t," "),o().createElement(Pn.A,null)),o().createElement(Tn.A,{openLeft:!0,ariaLabel:kn.Vw({id:"channel_members_dropdown.menuAriaLabel",defaultMessage:"Change the role of channel member"})},o().createElement(Tn.A.ItemAction,{show:!e.scheme_admin,onClick:()=>this.setChannelMemberStatus(e,n,!0),text:kn.Vw({id:"channel_members_dropdown.make_channel_admins",defaultMessage:"Make Channel Admins"})}),o().createElement(Tn.A.ItemAction,{show:Boolean(e.scheme_admin),onClick:()=>this.setChannelMemberStatus(e,n,!1),text:kn.Vw({id:"channel_members_dropdown.make_channel_members",defaultMessage:"Make Channel Members"})}),o().createElement(Tn.A.ItemAction,{onClick:()=>this.onClickRemoveGroup(e,n),text:kn.Vw({id:"group_list_modal.removeGroupButton",defaultMessage:"Remove Group"})})))))}))}render(){const{formatMessage:e}=this.props.intl;return o().createElement(wn.A,{titleText:e({id:"channel_groups",defaultMessage:"{channel} Groups"},{channel:this.props.channel.display_name}),searchPlaceholderText:e({id:"manage_channel_groups_modal.search_placeholder",defaultMessage:"Search groups"}),renderRow:this.renderRow,loadItems:this.loadItems,onHide:this.onHide,titleBarButtonText:e({id:"group_list_modal.addGroupButton",defaultMessage:"Add Groups"}),titleBarButtonOnClick:this.titleButtonOnClick})}}xn(Ln,"propTypes",{actions:r().shape({getGroupsAssociatedToChannel:r().func.isRequired,unlinkGroupSyncable:r().func.isRequired,patchGroupSyncable:r().func.isRequired,getMyChannelMember:r().func.isRequired,closeModal:r().func.isRequired,openModal:r().func.isRequired}).isRequired});const Rn=(0,c.injectIntl)(Ln),Fn=(0,d.connect)(((e,n)=>({channel:e.entities.channels.channels[n.channelID]})),(e=>({actions:(0,Z.bindActionCreators)({getGroupsAssociatedToChannel:Nn.dJ,closeModal:k.O,openModal:k.q,unlinkGroupSyncable:Nn.IC,patchGroupSyncable:Nn.r2,getMyChannelMember:D.MQ},e)})))(Rn),Hn=["channel"],Dn=e=>{let{channel:n}=e,t=function(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(n.includes(a))continue;t[a]=e[a]}return t}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}(e,Hn);const a=(0,d.useDispatch)();return o().createElement(o().Fragment,null,o().createElement(f.q7,Object.assign({id:"channelAddGroups",leadingElement:o().createElement(_.AccountMultiplePlusOutlineIcon,{size:"18px"}),onClick:()=>{a((0,k.q)({modalId:v.IQ.ADD_GROUPS_TO_CHANNEL,dialogType:An.A}))},labels:o().createElement(c.FormattedMessage,{id:"navbar.addGroups",defaultMessage:"Add Groups"})},t)),o().createElement(f.q7,Object.assign({id:"channelManageGroups",leadingElement:o().createElement(_.AccountMultipleOutlineIcon,{size:"18px"}),onClick:()=>{a((0,k.q)({modalId:v.IQ.MANAGE_CHANNEL_GROUPS,dialogType:Fn,dialogProps:{channelID:n.id}}))},labels:o().createElement(c.FormattedMessage,{id:"navbar_dropdown.manageGroups",defaultMessage:"Manage Groups"})},t)))},qn=o().memo(Dn);var Bn=t(69238);const jn=e=>{let{channel:n,id:t}=e;const a=(0,d.useDispatch)();return o().createElement(f.q7,{id:t,leadingElement:o().createElement(_.LogoutVariantIcon,{size:"18px"}),onClick:()=>{n.type===v.YM.PRIVATE_CHANNEL?a((0,k.q)({modalId:v.IQ.LEAVE_PRIVATE_CHANNEL_MODAL,dialogType:Bn.A,dialogProps:{channel:n}})):a((0,T.nE)(n.id))},labels:o().createElement(c.FormattedMessage,{id:"channel_header.leave",defaultMessage:"Leave Channel"}),isDestructive:!0})};jn.propTypes={id:r().string};const Gn=(0,i.memo)(jn);function Vn(e,n,t){return(n=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}class Un extends o().PureComponent{constructor(e){super(e),Vn(this,"handleUnarchive",(()=>{this.props.channel.id.length===v.Ay.CHANNEL_ID_LENGTH&&(this.props.actions.unarchiveChannel(this.props.channel.id),this.onHide())})),Vn(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!0}}render(){return o().createElement(Le.Modal,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onExited,role:"none","aria-labelledby":"unarchiveChannelModalLabel",id:"unarchiveChannelModal"},o().createElement(Le.Modal.Header,{closeButton:!0},o().createElement(Le.Modal.Title,{componentClass:"h1",id:"unarchiveChannelModalLabel"},o().createElement(c.FormattedMessage,{id:"unarchive_channel.confirm",defaultMessage:"Confirm UNARCHIVE Channel"}))),o().createElement(Le.Modal.Body,null,o().createElement("div",{className:"alert alert-danger"},o().createElement(c.FormattedMessage,{id:"unarchiveChannelModal.viewArchived.question",defaultMessage:"Are you sure you wish to unarchive the <b>{display_name}</b> channel?",values:{display_name:this.props.channel.display_name,b:e=>o().createElement("b",null,e)}}))),o().createElement(Le.Modal.Footer,null,o().createElement("button",{type:"button",className:"btn btn-tertiary",onClick:this.onHide},o().createElement(c.FormattedMessage,{id:"unarchive_channel.cancel",defaultMessage:"Cancel"})),o().createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",onClick:this.handleUnarchive,autoFocus:!0,id:"unarchiveChannelModalDeleteButton"},o().createElement(c.FormattedMessage,{id:"unarchive_channel.del",defaultMessage:"Unarchive"}))))}}Vn(Un,"propTypes",{onExited:r().func.isRequired,actions:r().shape({unarchiveChannel:r().func.isRequired}).isRequired});const zn=(0,d.connect)(null,(function(e){return{actions:(0,Z.bindActionCreators)({unarchiveChannel:D.fk},e)}}))(Un),Wn=e=>{let{channel:n}=e;const t=(0,d.useDispatch)();return o().createElement(o().Fragment,null,o().createElement(f.wv,null),o().createElement(f.q7,{id:"channelUnarchiveChannel",onClick:()=>{t((0,k.q)({modalId:v.IQ.UNARCHIVE_CHANNEL,dialogType:zn,dialogProps:{channel:n}}))},labels:o().createElement(c.FormattedMessage,{id:"channel_header.unarchive",defaultMessage:"Unarchive Channel"})}))},Yn=(0,i.memo)(Wn),Kn=["channel","user","isMuted","isDefault","isMobile","isFavorite","isLicensedForLDAPGroups","pluginItems","isChannelBookmarksEnabled"],Xn=e=>{let{channel:n,user:t,isMuted:a,isDefault:r,isMobile:l,isFavorite:s,isLicensedForLDAPGroups:i,pluginItems:d,isChannelBookmarksEnabled:u}=e,m=function(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(n.includes(a))continue;t[a]=e[a]}return t}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}(e,Kn);const h=!0===(null==n?void 0:n.group_constrained),g=0!==n.delete_at,p=(null==n?void 0:n.type)===v.YM.PRIVATE_CHANNEL,E=p?J.xB.MANAGE_PRIVATE_CHANNEL_MEMBERS:J.xB.MANAGE_PUBLIC_CHANNEL_MEMBERS,b=p?J.xB.DELETE_PRIVATE_CHANNEL:J.xB.DELETE_PUBLIC_CHANNEL,_=J.xB.MANAGE_TEAM;return o().createElement(o().Fragment,null,o().createElement(U,Object.assign({channel:n},m)),o().createElement(z,{userID:t.id,channel:n,isMuted:a}),!g&&o().createElement(o().Fragment,null,o().createElement(Ae,{user:t,channel:n}),o().createElement(Cn,{channel:n}),u&&o().createElement(I,{channel:n})),o().createElement(f.wv,null),l&&o().createElement(o().Fragment,null,o().createElement(B,{channelID:n.id,isFavorite:s}),o().createElement(Y,{channelID:n.id}),o().createElement(f.wv,null)),(g||r)&&o().createElement(Ie,{id:"channelMembers",channel:n,text:o().createElement(c.FormattedMessage,{id:"channel_header.members",defaultMessage:"Members"})}),!g&&!r&&o().createElement(o().Fragment,null,o().createElement($.A,{channelId:n.id,teamId:n.team_id,permissions:[E]},h&&i&&o().createElement(qn,{channel:n}),o().createElement(Ie,{id:"channelMembers",channel:n,text:o().createElement(c.FormattedMessage,{id:"channel_header.members",defaultMessage:"Members"})})),o().createElement($.A,{channelId:n.id,teamId:n.team_id,permissions:[E],invert:!0},o().createElement(Ie,{id:"channelMembers",channel:n,text:o().createElement(c.FormattedMessage,{id:"channel_header.members",defaultMessage:"Members"})}))),o().createElement(f.wv,null),o().createElement(M.A,{channel:n}),!l&&o().createElement(H,{pluginItems:d}),!r&&o().createElement(f.wv,null),!r&&!(0,C.P)(t.roles)&&o().createElement(Gn,{id:"channelLeaveChannel",channel:n}),g&&o().createElement(yn,null),!g&&!r&&o().createElement($.A,{channelId:n.id,teamId:n.team_id,permissions:[b]},o().createElement(qe,{channel:n})),g&&!r&&o().createElement($.A,{channelId:n.id,teamId:n.team_id,permissions:[_]},o().createElement(Yn,{channel:n})))};Xn.propTypes={isMuted:r().bool.isRequired,isReadonly:r().bool.isRequired,isDefault:r().bool.isRequired,isMobile:r().bool.isRequired,isFavorite:r().bool.isRequired,isLicensedForLDAPGroups:r().bool.isRequired,pluginItems:r().arrayOf(r().node).isRequired,isChannelBookmarksEnabled:r().bool.isRequired};const Qn=Xn;var Jn=t(42945),$n=t(6281);function Zn(e){let{dmUser:n,gmMembers:t,isMobile:a,archivedIcon:r,sharedIcon:l}=e;const i=(0,c.useIntl)(),u=(0,d.useSelector)(p.HW),_=(0,d.useSelector)(h.Lw),C=(0,d.useSelector)(h.o2),M=(0,d.useSelector)(h.TJ),y=(0,d.useSelector)(h.cP),A="true"===(0,d.useSelector)(g.Ay).LDAPGroups,N=(0,d.useSelector)(E.V1),I=(0,d.useSelector)(b.wR);if(!_)return null;const w=_.type===v.YM.DM_CHANNEL,P=_.type===v.YM.GM_CHANNEL;let T=_.display_name,S=i.formatMessage({id:"channel_header.otherchannel",defaultMessage:"{displayName} Channel Menu"},{displayName:_.display_name});w&&n?(T=o().createElement(Jn.A,{dmUser:n}),u.id===n.id&&(S=i.formatMessage({id:"channel_header.directchannel",defaultMessage:"{displayName} (you) Channel Menu"},{displayName:_.display_name}))):P&&(T=o().createElement($n.A,{gmMembers:t}));const O=N.map((e=>o().createElement(f.q7,{id:e.id+"_pluginmenuitem",key:e.id+"_pluginmenuitem",onClick:()=>{e.action&&e.action(_.id)},labels:o().createElement("span",null,e.text)})));return o().createElement(f.mc,{menuButtonTooltip:{text:T},menuButton:{id:"channelHeaderDropdownButton",class:s()("channel-header__trigger style--none"),children:o().createElement(o().Fragment,null,r,o().createElement("strong",{id:"channelHeaderTitle",className:"heading"},T),l,o().createElement(m(),{size:16})),"aria-label":S.toLowerCase()},menu:{id:"channelHeaderDropdownMenu"},transformOrigin:{horizontal:"left",vertical:"top"},anchorOrigin:{vertical:"bottom",horizontal:"left"}},w&&o().createElement(Q,{channel:_,user:u,isMuted:y,pluginItems:O,isFavorite:M,isMobile:a||!1,isChannelBookmarksEnabled:I}),P&&o().createElement(Te,{channel:_,user:u,isMuted:y,pluginItems:O,isFavorite:M,isMobile:a||!1,isChannelBookmarksEnabled:I}),!w&&!P&&o().createElement(Qn,{channel:_,user:u,isMuted:y,pluginItems:O,isFavorite:M,isMobile:a||!1,isDefault:C,isReadonly:!1,isLicensedForLDAPGroups:A,isChannelBookmarksEnabled:I}),o().createElement(ke,{isMobile:a||!1,pluginItems:O,channel:_}))}Zn.propTypes={gmMembers:r().array,archivedIcon:r().element,sharedIcon:r().element,isMobile:r().bool}},27039:(e,n,t)=>{t.d(n,{A:()=>b});var a=t(62688),r=t.n(a),l=(t(43813),t(97023)),s=t.n(l),i=t(14778),o=t(23453),c=t(17651),d=t(43595),u=t(65952),m=t(77656),h=t(21650),g=t(70669),p=t(27840);const E=e=>{const n=(0,o.useSelector)(h.t9),t=(0,o.useSelector)(u.tW),a=(0,o.useSelector)((0,d.HV)(c.x5.CHANNEL_HEADER_ICON)),r=(0,i.useIntl)(),l=(0,o.useDispatch)(),E=n=>{const t=()=>v(n);return e.isDropdown?s().createElement(g.q7,{key:"mobileChannelHeaderItem"+n.app_id+n.location,onClick:t,labels:s().createElement("span",null,n.label)}):s().createElement("li",{className:"flex-parent--center"},s().createElement("button",{id:"".concat(n.app_id,"_").concat(n.location),className:"navbar-toggle navbar-right__icon",onClick:t},s().createElement("span",{className:"icon navbar-plugin-button"},s().createElement("img",{alt:"",src:n.icon,width:"16",height:"16"}))))},b=n=>{const t=()=>f(n);return e.isDropdown?s().createElement(g.q7,{key:"mobileChannelHeaderItem"+n.id,id:"mobileChannelHeaderItem"+n.id,onClick:t,labels:s().createElement("span",null,n.dropdownText)}):s().createElement("li",{className:"flex-parent--center"},s().createElement("button",{className:"navbar-toggle navbar-right__icon",onClick:t},s().createElement("span",{className:"icon navbar-plugin-button"},n.icon)))},f=n=>{var a;return null===(a=n.action)||void 0===a?void 0:a.call(n,e.channel,t)},v=async n=>{const{channel:t}=e,a=(0,p.aC)(n.app_id,n.location,t.id,t.team_id),s=(e,n)=>{if(n){const e=n.text||r.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});l((0,m.hV)(n,e,t.id))}else switch(e.type){case c.G4.OK:e.text&&l((0,m.hV)(e,e.text,t.id));break;case c.G4.NAVIGATE:break;case c.G4.FORM:e.form&&l((0,m.el)(e.form,a));break;default:{const n=r.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:e.type});l((0,m.hV)(e,n,t.id))}}},i=await l((0,m.I$)(n,a,r));i.error?s(null,i.error):s(i.data)},_=n||[],C=a||[];if(0===_.length&&0===C.length)return s().createElement(s().Fragment,null);if(1===_.length&&0===C.length)return b(_[0]);if(0===_.length&&1===C.length)return E(C[0]);if(!e.isDropdown)return s().createElement(s().Fragment,null);const M=_.map(b),y=(e=>e.map(E))(C);return s().createElement(s().Fragment,null,s().createElement(g.wv,null),y,M)};E.propTypes={isDropdown:r().bool.isRequired};const b=(0,l.memo)(E)},61295:(e,n,t)=>{t.d(n,{A:()=>d});var a=t(62688),r=t.n(a),l=(t(4290),t(97023)),s=t.n(l),i=t(28105),o=t(11038);function c(e,n,t){return(n=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}class d extends s().PureComponent{constructor(e){super(e),c(this,"checkClick",(e=>{this.colorPicker.current&&this.colorPicker.current.contains(e.target)||this.setState({isOpened:!1})})),c(this,"togglePicker",(()=>{!this.state.isOpened&&this.colorInput.current&&this.colorInput.current.focus(),this.setState({isOpened:!this.state.isOpened})})),c(this,"handleColorChange",(e=>{this.setState({focused:!1}),this.props.onChange(e.hex)})),c(this,"onChange",(e=>{const n=e.target.value,t=(0,o.A)(n),a="#"+t.toHex();t.isValid()&&this.props.onChange(a),this.setState({value:n})})),c(this,"onFocus",(e=>{this.setState({focused:!0}),e.target&&e.target.setSelectionRange(1,e.target.value.length)})),c(this,"onBlur",(()=>{const e=this.state.value,n=(0,o.A)(e),t="#"+n.toHex();n.isValid()?(this.props.onChange(t),this.setState({value:t})):this.setState({value:this.props.value}),this.setState({focused:!1})})),c(this,"onKeyDown",(e=>{"Enter"!==e.key&&" "!==e.key||this.togglePicker()})),this.colorPicker=s().createRef(),this.colorInput=s().createRef(),this.state={focused:!1,isOpened:!1,value:e.value}}static getDerivedStateFromProps(e,n){return n.focused||e.value===n.value?null:{value:e.value}}componentDidUpdate(e,n){const{isOpened:t}=n,{isOpened:a}=this.state;a!==t&&(a?document.addEventListener("click",this.checkClick,{capture:!0}):document.removeEventListener("click",this.checkClick))}render(){const{id:e}=this.props,{isOpened:n,value:t}=this.state;return s().createElement("div",{className:"color-input input-group"},s().createElement("input",{id:"".concat(e,"-inputColorValue"),ref:this.colorInput,className:"form-control",type:"text",value:t,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeyDown,maxLength:7,disabled:this.props.isDisabled,"data-testid":"color-inputColorValue"}),!this.props.isDisabled&&s().createElement("span",{id:"".concat(e,"-squareColorIcon"),className:"input-group-addon color-pad",onClick:this.togglePicker},s().createElement("i",{id:"".concat(e,"-squareColorIconValue"),className:"color-icon",style:{backgroundColor:t}})),n&&s().createElement("div",{ref:this.colorPicker,className:"color-popover",id:"".concat(e,"-ChromePickerModal")},s().createElement(i.xk,{color:t,onChange:this.handleColorChange,disableAlpha:!0})))}}c(d,"propTypes",{id:r().string.isRequired,onChange:r().func.isRequired,value:r().string.isRequired,isDisabled:r().bool})},78625:(e,n,t)=>{t.d(n,{j:()=>o,l:()=>i});var a=t(47958),r=t(40057),l=t(65952),s=t(26614);const i=e=>{const n=(0,s.Ay)(e);return(null==n?void 0:n.SkuShortName)===r.Bz.SKUEnterpriseAdvanced},o=(e,n)=>{if(!i(e))return!1;const t=(0,l.c3)(e,n),s=(0,l.c)(e,n);return Boolean(s&&(s.type===r.Bz.OPEN_CHANNEL||s.type===r.Bz.PRIVATE_CHANNEL))&&(0,a.z)(t)}},47958:(e,n)=>{n.z=function(e){return!!e&&(Boolean(e.enabled)&&Boolean(e.text)&&Boolean(e.background_color))}}}]);
//# sourceMappingURL=285.ab328cf2f47966215c87.js.map